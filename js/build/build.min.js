[ '!function o(a,s,h){function c(e,t){if(!s[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(l)return l(e,!0);var r=new Error("Cannot find module \'"+e+"\'");throw r.code="MODULE_NOT_FOUND",r}var n=s[e]={exports:{}};a[e][0].call(n.exports,function(t){return c(a[e][1][t]||t)},n,n.exports,o,a,s,h)}return s[e].exports}for(var l="function"==typeof require&&require,t=0;t<h.length;t++)c(h[t]);return c}({1:[function(t,e,i){"use strict";var o=t("three"),a=t("./pointerlocker"),s=Math.PI/2;e.exports=function(t,e){e||(e={}),t.rotation.set(0,0,0);var r=new o.Object3D;r.add(t);var n=new o.Object3D;function i(t,e){return function(){e.apply(t,arguments)}}n.add(r),this.domElement=e.domElement||document,this.domElement.setAttribute&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=e.movementSpeed||9,this.rollSpeed=e.rollSpeed||.5,this.movementSpeedMultiplier=1,this.dragToLook=e.dragToLook||!1,this.autoForward=e.autoForward||!1,this.keysAsRotation=e.keysAsRotation||!1,this.allowYMovement=e.allowYMovement||!1,this.enabled=!1,this.locker=new a,this.getObject=function(){return n},this.pitchObject=function(){return r},this.setEnabled=function(t){this.enabled=t},this.requestPointerlock=function(){this.locker.requestPointerlock()},this.exitPointerlock=function(){this.locker.exitPointerlock()},this.reset=function(){[n,r,t].forEach(function(t){t.position.set(0,0,0),t.rotation.set(0,0,0)})},this.prevTime=window.performance?window.performance.now():new Date,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new o.Vector3(0,0,0),this.rotationVector=new o.Vector3(0,0,0),this.keydown=function(t){if(!t.altKey){switch(t.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.keysAsRotation?this.moveState.pitchUp=1:this.moveState.forward=1;break;case 40:this.keysAsRotation?this.moveState.pitchDown=1:this.moveState.back=1;break;case 37:this.keysAsRotation?this.moveState.yawLeft=1:this.moveState.left=1;break;case 39:this.keysAsRotation?this.moveState.yawRight=1:this.moveState.right=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(t){switch(t.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.forward=0,this.moveState.pitchUp=0;break;case 40:this.moveState.back=0,this.moveState.pitchDown=0;break;case 37:this.moveState.left=0,this.moveState.yawLeft=0;break;case 39:this.moveState.right=0,this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0;break;case 90:this.reset()}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(t){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock))if(this.domElement!==document&&this.domElement.focus(),t.preventDefault(),t.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(t.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(t){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock)&&(!this.dragToLook||0<this.mouseStatus)){var e=t.movementX||t.mozMovementX||t.webkitMovementX,i=t.movementY||t.mozMovementY||t.webkitMovementY;void 0!==e&&void 0!==i||(i=void 0!==this.lastClientX?(e=t.clientX-this.lastClientX,t.clientY-this.lastClientY):e=0,this.lastClientX=t.clientX,this.lastClientY=t.clientY),n.rotation.y-=.002*e,r.rotation.x-=.002*i,r.rotation.x=Math.max(-s,Math.min(s,r.rotation.x))}},this.mouseup=function(t){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock)){if(t.preventDefault(),t.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(t.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()}},this.update=function(){var t=window.performance?window.performance.now():new Date,e=(t-this.prevTime)/1e3;if(this.enabled){var i=e*this.movementSpeed*this.movementSpeedMultiplier,r=e*this.rollSpeed;n.translateX(this.moveVector.x*i),this.allowYMovement&&n.translateY(this.moveVector.y*i),n.translateZ(this.moveVector.z*i),this.keysAsRotation&&(n.rotateX(this.rotationVector.x*r),n.rotateY(this.rotationVector.y*r),n.rotateZ(this.rotationVector.z*r))}this.mostRecentDelta=e,this.prevTime=t},this.updateMovementVector=function(){var t=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-t+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!==document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousemove",i(this,this.mousemove),!1),this.domElement.addEventListener("mousedown",i(this,this.mousedown),!1),this.domElement.addEventListener("mouseup",i(this,this.mouseup),!1),window.addEventListener("keydown",i(this,this.keydown),!1),window.addEventListener("keyup",i(this,this.keyup),!1),this.updateMovementVector(),this.updateRotationVector()}},{"./pointerlocker":2,three:18}],2:[function(t,e,i){"use strict";e.exports=function(){var t=this,e="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,i=document.body;function r(){document.pointerLockElement===i||document.mozPointerLockElement===i||document.webkitPointerLockElement===i?t.currentlyHasPointerlock=!0:t.currentlyHasPointerlock=!1,t.pointerLockChangeCallback&&t.pointerLockChangeCallback(t.currentlyHasPointerlock)}function n(t){console.log("POINTER LOCK ERROR:"),console.log(t)}this.canRequestPointerlock=!1,this.currentlyHasPointerlock=!1,e&&(document.addEventListener("pointerlockchange",function(){r()},!1),document.addEventListener("mozpointerlockchange",function(){r()},!1),document.addEventListener("webkitpointerlockchange",function(){r()},!1),document.addEventListener("pointerlockerror",function(t){n(t)},!1),document.addEventListener("mozpointerlockerror",function(t){n(t)},!1),document.addEventListener("webkitpointerlockerror",function(t){n(t)},!1)),this.requestPointerlock=function(){t.canRequestPointerlock=!0,i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock,i.requestPointerLock&&i.requestPointerLock()},this.exitPointerlock=function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock&&document.exitPointerLock(),t.canRequestPointerlock=!1},this.canEverHavePointerLock=function(){return e}}},{}],3:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("three"),o=t("../image-util");i.GalleryLayout=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t.container,this.media=t.media,this.controlObject=t.controlObject,this.pitchObject=t.pitchObject,this.yLevel=t.yLevel||0}return r(e,{update:{value:function(){}},layoutMedia:{value:function(t,e){}},createTexture:{value:function(t){var e=t.imgSrc,i=o.loadTexture(e,!1);return i.wrapS=i.wrapT=n.ClampToEdgeWrapping,i.minFilter=n.NearestFilter,i}}}),e}()},{"../image-util":7,three:18}],4:[function(t,e,i){"use strict";var n=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}(),o=function t(e,i,r){var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,r)}if("value"in n&&n.writable)return n.value;var a=n.get;return void 0!==a?a.call(r):void 0};Object.defineProperty(i,"__esModule",{value:!0});var a=t("three"),s=t("jquery"),h=t("./gallery-layout.es6").GalleryLayout;i.Hole=function(t){function r(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),o(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,t),this.domMode=t.domMode||!1,this.xPosition=t.xPosition||0,this.zPosition=t.zPosition||0,this.imageWidth=t.imageWidth||20,this.imageDepth=t.imageDepth||20,this.fallThroughImages=t.fallThroughImages||!0,this.yLevel=t.yLevel||-11,this.distanceBetweenPhotos=t.distanceBetweenPhotos||25,this.downwardVelocity=t.initialDownwardVelocity||-.001,this.thresholdVelocity=t.thresholdVelocity||-.031,this.slowAcceleration=t.slowAcceleration||-3e-5,this.fastAcceleration=t.fastAcceleration||-5e-4,this.slowMotionVelocity=t.slowMotionVelocity||-.01,this.ascensionVelocity=t.ascensionVelocity||.048,this.crazyRotationVelocity=t.crazyRotationVelocity||5e-4,this.crazyRotationAcceleration=t.crazyRotationAcceleration||8e-6,this.bigCubeStyle=t.bigCubeStyle||"none",this.bigCubeCount=t.bigCubeCount||26,this.bigCubeLength=t.bigCubeLength||500,this.cycleMultiplier=t.cycleMultiplier||25,this.CubeToggleCount=t.CubeToggleCount||0,this.activeMeshCount=t.activeMeshCount||400,this.halfActiveMeshCount=this.activeMeshCount/2,this.nextMediaToPassIndex=0,this.hasReachedBottom=!1,this.nextMediaToPassPosition=this.yForMediaWithIndex(this.nextMediaToPassIndex),this.nextMediaToAddIndex=this.activeMeshCount,this.activeMeshes=[],this.hasStarted=!1,this.inSlowMotion=!1,this.goRotateOnce=!1,this.goCrazyRotate=!1,this.ascending=!1,this.domMode)this.fullScreenImage=s(\'<img style="display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: white; z-index: 1000"></img>\'),s("body").append(this.fullScreenImage);else{this.handleBigCubeState();for(var e=0;e<this.activeMeshCount;e++){var i=this.media[e];this.layoutMedia(e,i)}this.pitchObject.rotation.x=-Math.PI/2}}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}(r,h),n(r,{start:{value:function(){var e=this;this.hasStarted=!0,this.domMode&&setTimeout(function(){var t=e.media[0].imgSrc;e.fullScreenImage.attr("src",t)},3e3)}},update:{value:function(){if(o(Object.getPrototypeOf(r.prototype),"update",this).call(this),this.hasStarted)for(this.hasReachedBottom?this.ascending&&this.controlObject.translateY(this.ascensionVelocity):this.inSlowMotion?this.controlObject.translateY(Math.max(this.slowMotionVelocity,this.downwardVelocity)):(this.downwardVelocity>this.thresholdVelocity?this.downwardVelocity+=this.slowAcceleration:this.downwardVelocity+=this.fastAcceleration,this.controlObject.translateY(this.downwardVelocity),this.crazyRotationVelocity+=this.crazyRotationAcceleration),this.domMode||("singleStack"===this.bigCubeStyle&&(this.topStackingBigCube.position.y=this.controlObject.position.y+this.bigCubeLength*this.bigCubeCount/2),this.goCrazyRotate&&(this.controlObject.rotation.y+=this.crazyRotationVelocity,this.pitchObject.rotation.x+=this.crazyRotationVelocity));this.controlObject.position.y<this.nextMediaToPassPosition&&!this.hasReachedBottom;)this.didPassMesh()}},didPassMesh:{value:function(){var t=this;if(this.domMode){var e=this.media[this.nextMediaToPassIndex+1];if(e){var i=e.imgSrc;this.fullScreenImage.attr("src",i)}return this.nextMediaToPassIndex+=1,void(this.nextMediaToPassPosition=this.yForMediaWithIndex(this.nextMediaToPassIndex))}if(this.nextMediaToPassIndex>this.halfActiveMeshCount){var r=this.activeMeshes.shift();this.container.remove(r),this.layoutMedia(this.nextMediaToAddIndex,this.media[this.nextMediaToAddIndex]),this.nextMediaToAddIndex+=1}if(this.nextMediaToPassIndex+=1,this.nextMediaToPassPosition=this.yForMediaWithIndex(this.nextMediaToPassIndex),"singleStack"===this.bigCubeStyle)this.updateStackingBigCubeTextures(this.media[this.nextMediaToPassIndex]);else if("layer"===this.bigCubeStyle&&(this.nextMediaToPassIndex-1)%25==0){var n=this.nextMediaToPassIndex-1+this.bigCubeCount/2*25;if(n>=this.media.count)return;var o=this.createBigCube(this.media[n]);if(o.position.set(this.xPosition,this.controlObject.position.y+this.bigCubeCount/2*-500,this.zPosition),this.container.add(o),this.bigLayeredCubes.push(o),this.bigLayeredCubes.length>this.bigCubeCount){var a=this.bigLayeredCubes.unshift();this.container.remove(a)}}this.nextMediaToPassIndex>=this.media.length&&(this.hasReachedBottom=!0,setTimeout(function(){t.ascending=!0},3e3))}},layoutMedia:{value:function(t,e){if(e){var i=this.imageWidth,r=i,n=new a.Mesh(new a.BoxGeometry(i,r,this.imageDepth),new a.MeshBasicMaterial({map:this.createTexture(e),side:a.DoubleSide}));n.castShadow=!0,this.fallThroughImages&&(n.rotation.x=-Math.PI/2,n.rotation.y=Math.PI),n.position.set(this.xPosition,this.yForMediaWithIndex(t),this.zPosition),this.container.add(n),this.activeMeshes.push(n)}}},yForMediaWithIndex:{value:function(t){return this.yLevel-t*this.distanceBetweenPhotos}},toggleSlowMotion:{value:function(){this.inSlowMotion=!this.inSlowMotion}},toggleBigCube:{value:function(){this.hasReachedBottom||("singleStack"===this.bigCubeStyle?(this.bigCubeStyle="layer",this.CubeToggleCount=this.CubeToggleCount+1):"layer"===this.bigCubeStyle?this.bigCubeStyle="none":"none"===this.bigCubeStyle&&(this.bigCubeStyle="singleStack"),this.handleBigCubeState())}},handleBigCubeState:{value:function(){if("singleStack"===this.bigCubeStyle){this.topStackingBigCube=this.createBigCube(this.media[this.nextMediaToPassIndex]),this.container.add(this.topStackingBigCube),this.childStackingBigCubes=[];for(var t=1;t<this.bigCubeCount;t++){var e=1==t?this.createBigCube(this.media[this.nextMediaToPassIndex]):this.childStackingBigCubes[0].clone();e.position.y=-t*this.bigCubeLength,this.topStackingBigCube.add(e),this.childStackingBigCubes.push(e)}}else this.container.remove(this.topStackingBigCube),this.topStackingBigCube=null,this.childStackingBigCubes=null;if("layer"===this.bigCubeStyle){this.bigLayeredCubes=[];for(t=0;t<this.bigCubeCount/2;t++){var i=t+this.nextMediaToPassIndex+t*this.cycleMultiplier;if(i<this.media.length)(r=this.createBigCube(this.media[i])).position.set(this.xPosition,(this.controlObject.position.y||0)+-500*t,this.zPosition),this.container.add(r),this.bigLayeredCubes.push(r);if(0<t){var r,n=this.nextMediaToPassIndex-t+t*this.cycleMultiplier;if(0<=n)(r=this.createBigCube(this.media[n])).position.set(this.xPosition,(this.controlObject.position.y||0)+500*t,this.zPosition),this.container.add(r),this.bigLayeredCubes.push(r)}}}else{if(this.bigLayeredCubes)for(t=0;t<this.bigLayeredCubes.length;t++){var o=this.bigLayeredCubes[t];this.container.remove(o)}this.bigLayeredCubes=null}}},toggleRotateOnce:{value:function(){var t=this.pitchObject.rotation.x;this.pitchObject.rotation.x=t-Math.PI/2}},toggleCrazyRotate:{value:function(){this.goCrazyRotate=!this.goCrazyRotate}},updateStackingBigCubeTextures:{value:function(t){var e=this.bigCubeMaterial(t);if(e){this.topStackingBigCube.material=e,this.topStackingBigCube.needsUpdate=!0;for(var i=0;i<this.childStackingBigCubes.length;i++)this.childStackingBigCubes[i].material=e,this.childStackingBigCubes[i].needsUpdate=!0}}},createBigCube:{value:function(t){var e=t?this.bigCubeMaterial(t):new a.MeshFaceMaterial;return new a.Mesh(new a.BoxGeometry(this.bigCubeLength,this.bigCubeLength,this.bigCubeLength),e)}},bigCubeMaterial:{value:function(t){if(!t)return null;var e=this.createTexture(t),i=new a.MeshBasicMaterial({map:e,side:a.DoubleSide}),r=[i,i.clone(),new a.MeshBasicMaterial({transparent:!0,opacity:0}),new a.MeshBasicMaterial({transparent:!0,opacity:0}),i.clone(),i.clone()];return new a.MeshFaceMaterial(r)}}}),r}()},{"./gallery-layout.es6":3,jquery:16,three:18}],5:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("three"),o=(t("./lib/physi.js"),t("jquery")),a=(t("kutility"),t("./sheen-mesh"),t("./image-util"),t("./geometry-util"),t("./gallery-layouts/hole.es6").Hole);i.Gallery=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.scene=t,this.controlObject=e.controlObject,this.pitchObject=e.pitchObject,this.domMode=e.domMode,this.yLevel=e.yLevel||0,this.layoutCreator=function(t){return new a(t)},this.meshContainer=new n.Object3D,this.scene.add(this.meshContainer)}return r(i,{create:{value:function(e){var i=this;o.getJSON("/data/212943401_media.json",function(t){i.layout=i.layoutCreator({domMode:i.domMode,container:i.meshContainer,controlObject:i.controlObject,pitchObject:i.pitchObject,media:t,yLevel:i.yLevel}),e&&e()})}},update:{value:function(){this.layout&&this.layout.update()}},destroy:{value:function(){this.scene.remove(this.meshContainer)}}}),i}()},{"./gallery-layouts/hole.es6":4,"./geometry-util":6,"./image-util":7,"./lib/physi.js":9,"./sheen-mesh":12,jquery:16,kutility:17,three:18}],6:[function(t,e,i){"use strict";e.exports.computeShit=function(t){t.computeFaceNormals(),t.computeVertexNormals()}},{}],7:[function(t,e,i){"use strict";var r=t("three");e.exports.loadTexture=function(t,e){return t||(t=""),e&&(t=n(t)),r.ImageUtils.crossOrigin="",r.ImageUtils.loadTexture(t)},e.exports.loadDomImage=function(t,e){t||(t=""),t=n(t);var i=new Image;i.crossOrigin="",i.onload=function(){e(i)},i.src=t};var n=function(t){return"http://crossorigin.me/"+t}},{three:18}],8:[function(t,e,i){"use strict";var r,n;n=function(){var t=window.AudioContext||window.webkitAudioContext,d={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,webAudioApi:!1,document:window.document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),getAudioContext:function(){if(void 0===this.audioCtx)try{this.audioCtx=t?new t:null}catch(t){this.audioCtx=null}return this.audioCtx},sound:function(t,e){var s=(e=e||{}).document||d.defaults.document,r=0,h=[],n={},c=d.isSupported();function i(t){for(var e=[],i=t.length-1,r=0;r<=i;r++)e.push({start:t.start(r),end:t.end(r)});return e}function o(t){return t.split(".").pop()}if(this.load=function(){return c&&this.sound.load(),this},this.play=function(){return c&&this.sound.play(),this},this.togglePlay=function(){return c&&(this.sound.paused?this.sound.play():this.sound.pause()),this},this.pause=function(){return c&&this.sound.pause(),this},this.isPaused=function(){return c?this.sound.paused:null},this.stop=function(){return c&&(this.setTime(0),this.sound.pause()),this},this.isEnded=function(){return c?this.sound.ended:null},this.loop=function(){return c&&(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()})),this},this.unloop=function(){return c&&(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop")),this},this.mute=function(){return c&&(this.sound.muted=!0),this},this.unmute=function(){return c&&(this.sound.muted=!1),this},this.toggleMute=function(){return c&&(this.sound.muted=!this.sound.muted),this},this.isMuted=function(){return c?this.sound.muted:null},this.setVolume=function(t){return c&&(t<0&&(t=0),100<t&&(t=100),this.volume=t,this.sound.volume=t/100),this},this.getVolume=function(){return c?this.volume:this},this.increaseVolume=function(t){return this.setVolume(this.volume+(t||1))},this.decreaseVolume=function(t){return this.setVolume(this.volume-(t||1))},this.setTime=function(t){if(!c)return this;var e=!0;return this.whenReady(function(){!0===e&&(e=!1,this.sound.currentTime=t)}),this},this.getTime=function(){if(!c)return null;var t=Math.round(100*this.sound.currentTime)/100;return isNaN(t)?d.defaults.placeholder:t},this.setPercent=function(t){return c?this.setTime(d.fromPercent(t,this.sound.duration)):this},this.getPercent=function(){if(!c)return null;var t=Math.round(d.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(t)?d.defaults.placeholder:t},this.setSpeed=function(t){return c&&(this.sound.playbackRate=t),this},this.getSpeed=function(){return c?this.sound.playbackRate:null},this.getDuration=function(){if(!c)return null;var t=Math.round(100*this.sound.duration)/100;return isNaN(t)?d.defaults.placeholder:t},this.getPlayed=function(){return c?i(this.sound.played):null},this.getBuffered=function(){return c?i(this.sound.buffered):null},this.getSeekable=function(){return c?i(this.sound.seekable):null},this.getErrorCode=function(){return c&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!c)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return c?this.sound.readyState:null},this.getStateMessage=function(){if(!c)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return c?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!c)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(t,e){return c&&(this.sound[t]=e),this},this.get=function(t){return c?t?this.sound[t]:this.sound:null},this.bind=function(t,e){if(!c)return this;t=t.split(" ");for(var i=this,r=function(t){e.call(i,t)},n=0;n<t.length;n++){var o=t[n],a=o;o=a.split(".")[0],h.push({idx:a,func:r}),this.sound.addEventListener(o,r,!0)}return this},this.unbind=function(t){if(!c)return this;t=t.split(" ");for(var e=0;e<t.length;e++)for(var i=t[e],r=i.split(".")[0],n=0;n<h.length;n++){var o=h[n].idx.split(".");(h[n].idx===i||o[1]&&o[1]===i.replace(".",""))&&(this.sound.removeEventListener(r,h[n].func,!0),h.splice(n,1))}return this},this.bindOnce=function(t,e){if(!c)return this;var i=this;return n[r++]=!1,this.bind(t+"."+r,function(){n[r]||(n[r]=!0,e.call(i)),i.unbind(t+"."+r)}),this},this.trigger=function(t,e){if(!c)return this;t=t.split(" ");for(var i=0;i<t.length;i++)for(var r=t[i],n=0;n<h.length;n++){var o=h[n].idx.split(".");if(h[n].idx===r||o[0]&&o[0]===r.replace(".","")){var a=s.createEvent("HTMLEvents");a.initEvent(o[0],!1,!0),a.originalEvent=e,this.sound.dispatchEvent(a)}}return this},this.fadeTo=function(e,t,i){if(!c)return this;t=t instanceof Function?(i=t,d.defaults.duration):t||d.defaults.duration;var r=this.volume,n=t/Math.abs(r-e),o=this;return this.play(),this.whenReady(function(){!function t(){setTimeout(function(){r<e&&o.volume<e?(o.setVolume(o.volume+=1),t()):e<r&&o.volume>e?(o.setVolume(o.volume-=1),t()):i instanceof Function&&i.apply(o)},n)}()}),this},this.fadeIn=function(t,e){return c?this.setVolume(0).fadeTo(100,t,e):this},this.fadeOut=function(t,e){return c?this.fadeTo(0,t,e):this},this.fadeWith=function(t,e){return c&&(this.fadeOut(e,function(){this.stop()}),t.play().fadeIn(e)),this},this.whenReady=function(t){if(!c)return null;var e=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){t.call(e)}):t.call(e)},this.addSource=function(t){var e=this,i=s.createElement("source");return i.src=t,d.types[o(t)]&&(i.type=d.types[o(t)]),this.sound.appendChild(i),i.addEventListener("error",function(t){e.trigger("sourceerror",t)}),i},c&&t){for(var a in d.defaults)d.defaults.hasOwnProperty(a)&&void 0===e[a]&&(e[a]=d.defaults[a]);if(this.sound=s.createElement("audio"),e.webAudioApi){var l=d.getAudioContext();l&&(this.source=l.createMediaElementSource(this.sound),this.source.connect(l.destination))}if(t instanceof Array)for(var u in t)t.hasOwnProperty(u)&&this.addSource(t[u]);else if(e.formats.length)for(var p in e.formats)e.formats.hasOwnProperty(p)&&this.addSource(t+"."+e.formats[p]);else this.addSource(t);e.loop&&this.loop(),e.autoplay&&(this.sound.autoplay="autoplay"),!0===e.preload?this.sound.preload="auto":!1===e.preload?this.sound.preload="none":this.sound.preload=e.preload,this.setVolume(e.volume),d.sounds.push(this)}},group:function(r){function n(){for(var t=o(null,arguments),e=t.shift(),i=0;i<r.length;i++)r[i][e].apply(r[i],t)}function o(t,e){return t instanceof Array?t:Array.prototype.slice.call(e)}r=o(r,arguments),this.getSounds=function(){return r},this.add=function(t){t=o(t,arguments);for(var e=0;e<t.length;e++)r.push(t[e])},this.remove=function(t){t=o(t,arguments);for(var e=0;e<t.length;e++)for(var i=0;i<r.length;i++)if(r[i]===t[e]){r.splice(i,1);break}},this.load=function(){return n("load"),this},this.play=function(){return n("play"),this},this.togglePlay=function(){return n("togglePlay"),this},this.pause=function(t){return n("pause",t),this},this.stop=function(){return n("stop"),this},this.mute=function(){return n("mute"),this},this.unmute=function(){return n("unmute"),this},this.toggleMute=function(){return n("toggleMute"),this},this.setVolume=function(t){return n("setVolume",t),this},this.increaseVolume=function(t){return n("increaseVolume",t),this},this.decreaseVolume=function(t){return n("decreaseVolume",t),this},this.loop=function(){return n("loop"),this},this.unloop=function(){return n("unloop"),this},this.setSpeed=function(t){return n("setSpeed",t),this},this.setTime=function(t){return n("setTime",t),this},this.set=function(t,e){return n("set",t,e),this},this.bind=function(t,e){return n("bind",t,e),this},this.unbind=function(t){return n("unbind",t),this},this.bindOnce=function(t,e){return n("bindOnce",t,e),this},this.trigger=function(t){return n("trigger",t),this},this.fade=function(t,e,i,r){return n("fade",t,e,i,r),this},this.fadeIn=function(t,e){return n("fadeIn",t,e),this},this.fadeOut=function(t,e){return n("fadeOut",t,e),this}},all:function(){return new d.group(d.sounds)},isSupported:function(){return!!d.el.canPlayType},isOGGSupported:function(){return!!d.el.canPlayType&&d.el.canPlayType(\'audio/ogg; codecs="vorbis"\')},isWAVSupported:function(){return!!d.el.canPlayType&&d.el.canPlayType(\'audio/wav; codecs="1"\')},isMP3Supported:function(){return!!d.el.canPlayType&&d.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!d.el.canPlayType&&(d.el.canPlayType("audio/x-m4a;")||d.el.canPlayType("audio/aac;"))},toTimer:function(t,e){var i,r,n;return i=Math.floor(t/3600),i=isNaN(i)?"--":10<=i?i:"0"+i,r=e?Math.floor(t/60%60):Math.floor(t/60),r=isNaN(r)?"--":10<=r?r:"0"+r,n=Math.floor(t%60),n=isNaN(n)?"--":10<=n?n:"0"+n,e?i+":"+r+":"+n:r+":"+n},fromTimer:function(t){var e=t.toString().split(":");return e&&3===e.length&&(t=3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseInt(e[2],10)),e&&2===e.length&&(t=60*parseInt(e[0],10)+parseInt(e[1],10)),t},toPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(100*t/e*r)/r},fromPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(e/100*t*r)/r}};return d},(r=void 0)!==e&&e.exports?e.exports=n():"function"==typeof define&&define.amd?define([],n):r.buzz=n()},{}],9:[function(t,e,i){"use strict";var u,n,o,a,r,p,d,s,h,c,l,f,m,g,y,v,x,b,w,M=t("three");e.exports=(h=!1,c=l,l={},f=new M.Vector3,m=new M.Vector3,g=new M.Matrix4,y=new M.Quaternion,v=0,x=1,b=2,w=3,l.scripts={},(n=function(){this._eventListeners={}}).prototype.addEventListener=function(t,e){this._eventListeners.hasOwnProperty(t)||(this._eventListeners[t]=[]),this._eventListeners[t].push(e)},n.prototype.removeEventListener=function(t,e){var i;return!!this._eventListeners.hasOwnProperty(t)&&0<=(i=this._eventListeners[t].indexOf(e))&&(this._eventListeners[t].splice(i,1),!0)},n.prototype.dispatchEvent=function(t){var e,i=Array.prototype.splice.call(arguments,1);if(this._eventListeners.hasOwnProperty(t))for(e=0;e<this._eventListeners[t].length;e++)this._eventListeners[t][e].apply(this,i)},n.make=function(t){t.prototype.addEventListener=n.prototype.addEventListener,t.prototype.removeEventListener=n.prototype.removeEventListener,t.prototype.dispatchEvent=n.prototype.dispatchEvent},s=1,o=function(){return s++},a=function(t,e){return g.identity(),g.identity().makeRotationFromQuaternion(e.quaternion),g.getInverse(g),f.copy(t),m.copy(e.position),f.sub(m).applyMatrix4(g)},l.noConflict=function(){return window.Physijs=c,l},l.createMaterial=function(t,e,i){var r=function(){};return r.prototype=t,(r=new r)._physijs={id:t.id,friction:void 0===e?.8:e,restitution:void 0===i?.2:i},r},l.PointConstraint=function(t,e,i){void 0===i&&(i=e,e=void 0),this.type="point",this.appliedImpulse=0,this.id=o(),this.objecta=t._physijs.id,this.positiona=a(i,t).clone(),e&&(this.objectb=e._physijs.id,this.positionb=a(i,e).clone())},l.PointConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb}},l.HingeConstraint=function(t,e,i,r){void 0===r&&(r=i,i=e,e=void 0),this.type="hinge",this.appliedImpulse=0,this.id=o(),this.scene=t.parent,this.objecta=t._physijs.id,this.positiona=a(i,t).clone(),this.position=i.clone(),this.axis=r,e&&(this.objectb=e._physijs.id,this.positionb=a(i,e).clone())},l.HingeConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axis:this.axis}},l.HingeConstraint.prototype.setLimits=function(t,e,i,r){this.scene.execute("hinge_setLimits",{constraint:this.id,low:t,high:e,bias_factor:i,relaxation_factor:r})},l.HingeConstraint.prototype.enableAngularMotor=function(t,e){this.scene.execute("hinge_enableAngularMotor",{constraint:this.id,velocity:t,acceleration:e})},l.HingeConstraint.prototype.disableMotor=function(t,e){this.scene.execute("hinge_disableMotor",{constraint:this.id})},l.SliderConstraint=function(t,e,i,r){void 0===r&&(r=i,i=e,e=void 0),this.type="slider",this.appliedImpulse=0,this.id=o(),this.scene=t.parent,this.objecta=t._physijs.id,this.positiona=a(i,t).clone(),this.axis=r,e&&(this.objectb=e._physijs.id,this.positionb=a(i,e).clone())},l.SliderConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axis:this.axis}},l.SliderConstraint.prototype.setLimits=function(t,e,i,r){this.scene.execute("slider_setLimits",{constraint:this.id,lin_lower:t,lin_upper:e,ang_lower:i,ang_upper:r})},l.SliderConstraint.prototype.setRestitution=function(t,e){this.scene.execute("slider_setRestitution",{constraint:this.id,linear:t,angular:e})},l.SliderConstraint.prototype.enableLinearMotor=function(t,e){this.scene.execute("slider_enableLinearMotor",{constraint:this.id,velocity:t,acceleration:e})},l.SliderConstraint.prototype.disableLinearMotor=function(){this.scene.execute("slider_disableLinearMotor",{constraint:this.id})},l.SliderConstraint.prototype.enableAngularMotor=function(t,e){this.scene.execute("slider_enableAngularMotor",{constraint:this.id,velocity:t,acceleration:e})},l.SliderConstraint.prototype.disableAngularMotor=function(){this.scene.execute("slider_disableAngularMotor",{constraint:this.id})},l.ConeTwistConstraint=function(t,e,i){if(void 0===i)throw"Both objects must be defined in a ConeTwistConstraint.";this.type="conetwist",this.appliedImpulse=0,this.id=o(),this.scene=t.parent,this.objecta=t._physijs.id,this.positiona=a(i,t).clone(),this.objectb=e._physijs.id,this.positionb=a(i,e).clone(),this.axisa={x:t.rotation.x,y:t.rotation.y,z:t.rotation.z},this.axisb={x:e.rotation.x,y:e.rotation.y,z:e.rotation.z}},l.ConeTwistConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axisa:this.axisa,axisb:this.axisb}},l.ConeTwistConstraint.prototype.setLimit=function(t,e,i){this.scene.execute("conetwist_setLimit",{constraint:this.id,x:t,y:e,z:i})},l.ConeTwistConstraint.prototype.enableMotor=function(){this.scene.execute("conetwist_enableMotor",{constraint:this.id})},l.ConeTwistConstraint.prototype.setMaxMotorImpulse=function(t){this.scene.execute("conetwist_setMaxMotorImpulse",{constraint:this.id,max_impulse:t})},l.ConeTwistConstraint.prototype.setMotorTarget=function(t){t instanceof M.Vector3?t=(new M.Quaternion).setFromEuler(new M.Euler(t.x,t.y,t.z)):t instanceof M.Euler?t=(new M.Quaternion).setFromEuler(t):t instanceof M.Matrix4&&(t=(new M.Quaternion).setFromRotationMatrix(t)),this.scene.execute("conetwist_setMotorTarget",{constraint:this.id,x:t.x,y:t.y,z:t.z,w:t.w})},l.ConeTwistConstraint.prototype.disableMotor=function(){this.scene.execute("conetwist_disableMotor",{constraint:this.id})},l.DOFConstraint=function(t,e,i){void 0===i&&(i=e,e=void 0),this.type="dof",this.appliedImpulse=0,this.id=o(),this.scene=t.parent,this.objecta=t._physijs.id,this.positiona=a(i,t).clone(),this.axisa={x:t.rotation.x,y:t.rotation.y,z:t.rotation.z},e&&(this.objectb=e._physijs.id,this.positionb=a(i,e).clone(),this.axisb={x:e.rotation.x,y:e.rotation.y,z:e.rotation.z})},l.DOFConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axisa:this.axisa,axisb:this.axisb}},l.DOFConstraint.prototype.setLinearLowerLimit=function(t){this.scene.execute("dof_setLinearLowerLimit",{constraint:this.id,x:t.x,y:t.y,z:t.z})},l.DOFConstraint.prototype.setLinearUpperLimit=function(t){this.scene.execute("dof_setLinearUpperLimit",{constraint:this.id,x:t.x,y:t.y,z:t.z})},l.DOFConstraint.prototype.setAngularLowerLimit=function(t){this.scene.execute("dof_setAngularLowerLimit",{constraint:this.id,x:t.x,y:t.y,z:t.z})},l.DOFConstraint.prototype.setAngularUpperLimit=function(t){this.scene.execute("dof_setAngularUpperLimit",{constraint:this.id,x:t.x,y:t.y,z:t.z})},l.DOFConstraint.prototype.enableAngularMotor=function(t){this.scene.execute("dof_enableAngularMotor",{constraint:this.id,which:t})},l.DOFConstraint.prototype.configureAngularMotor=function(t,e,i,r,n){this.scene.execute("dof_configureAngularMotor",{constraint:this.id,which:t,low_angle:e,high_angle:i,velocity:r,max_force:n})},l.DOFConstraint.prototype.disableAngularMotor=function(t){this.scene.execute("dof_disableAngularMotor",{constraint:this.id,which:t})},l.Scene=function(t){var r=this;n.call(this),M.Scene.call(this),this._worker=new Worker(l.scripts.worker||"/js/lib/physijs_worker.js"),this._worker.transferableMessage=this._worker.webkitPostMessage||this._worker.postMessage,this._materials_ref_counts={},this._objects={},this._vehicles={},this._constraints={};var e=new ArrayBuffer(1);this._worker.transferableMessage(e,[e]),u=0===e.byteLength,this._worker.onmessage=function(t){var e,i=t.data;if(i instanceof ArrayBuffer&&1!==i.byteLength&&(i=new Float32Array(i)),i instanceof Float32Array)switch(i[0]){case v:r._updateScene(i);break;case x:r._updateCollisions(i);break;case b:r._updateVehicles(i);break;case w:r._updateConstraints(i)}else if(i.cmd)switch(i.cmd){case"objectReady":e=i.params,r._objects[e]&&r._objects[e].dispatchEvent("ready");break;case"worldReady":r.dispatchEvent("ready");break;case"vehicle":window.test=i;break;default:console.debug("Received: "+i.cmd),console.dir(i.params)}else switch(i[0]){case v:r._updateScene(i);break;case x:r._updateCollisions(i);break;case b:r._updateVehicles(i);break;case w:r._updateConstraints(i)}},(t=t||{}).ammo=l.scripts.ammo||"/js/lib/ammo.js",t.fixedTimeStep=t.fixedTimeStep||1/60,t.rateLimit=t.rateLimit||!0,this.execute("init",t)},l.Scene.prototype=new M.Scene,l.Scene.prototype.constructor=l.Scene,n.make(l.Scene),l.Scene.prototype._updateScene=function(t){var e,i,r,n=t[1];for(i=0;i<n;i++)r=2+14*i,void 0!==(e=this._objects[t[r]])&&(!1===e.__dirtyPosition&&e.position.set(t[r+1],t[r+2],t[r+3]),!1===e.__dirtyRotation&&e.quaternion.set(t[r+4],t[r+5],t[r+6],t[r+7]),e._physijs.linearVelocity.set(t[r+8],t[r+9],t[r+10]),e._physijs.angularVelocity.set(t[r+11],t[r+12],t[r+13]));u&&this._worker.transferableMessage(t.buffer,[t.buffer]),h=!1,this.dispatchEvent("update")},l.Scene.prototype._updateVehicles=function(t){var e,i,r,n;for(r=0;r<(t.length-1)/9;r++)n=1+9*r,void 0!==(e=this._vehicles[t[n]])&&((i=e.wheels[t[n+1]]).position.set(t[n+2],t[n+3],t[n+4]),i.quaternion.set(t[n+5],t[n+6],t[n+7],t[n+8]));u&&this._worker.transferableMessage(t.buffer,[t.buffer])},l.Scene.prototype._updateConstraints=function(t){var e,i,r,n;for(r=0;r<(t.length-1)/6;r++)n=1+6*r,e=this._constraints[t[n]],i=this._objects[t[n+1]],void 0!==e&&void 0!==i&&(f.set(t[n+2],t[n+3],t[n+4]),g.extractRotation(i.matrix),f.applyMatrix4(g),e.positiona.addVectors(i.position,f),e.appliedImpulse=t[n+5]);u&&this._worker.transferableMessage(t.buffer,[t.buffer])},l.Scene.prototype._updateCollisions=function(t){var e,i,r,n,o,a,s,h={},c={};for(e=0;e<t[1];e++)c[(n=t[r=2+5*e])+"-"+(o=t[r+1])]=r+2,c[o+"-"+n]=-1*(r+2),h[n]||(h[n]=[]),h[n].push(o),h[o]||(h[o]=[]),h[o].push(n);for(a in this._objects)if(this._objects.hasOwnProperty(a))if(n=this._objects[a],h[a]){for(i=0;i<n._physijs.touches.length;i++)-1===h[a].indexOf(n._physijs.touches[i])&&n._physijs.touches.splice(i--,1);for(i=0;i<h[a].length;i++)if(s=h[a][i],(o=this._objects[s])&&-1===n._physijs.touches.indexOf(s)){n._physijs.touches.push(s),f.subVectors(n.getLinearVelocity(),o.getLinearVelocity()),p=f.clone(),f.subVectors(n.getAngularVelocity(),o.getAngularVelocity()),d=f.clone();var l=c[n._physijs.id+"-"+o._physijs.id];0<l?f.set(-t[l],-t[l+1],-t[l+2]):(l*=-1,f.set(t[l],t[l+1],t[l+2])),n.dispatchEvent("collision",o,p,d,f)}}else n._physijs.touches.length=0;this.collisions=h,u&&this._worker.transferableMessage(t.buffer,[t.buffer])},l.Scene.prototype.addConstraint=function(t,e){var i;if(this._constraints[t.id]=t,this.execute("addConstraint",t.getDefinition()),e)switch(t.type){case"point":case"hinge":(i=new M.Mesh(new M.SphereGeometry(1.5),new M.MeshNormalMaterial)).position.copy(t.positiona),this._objects[t.objecta].add(i);break;case"slider":(i=new M.Mesh(new M.BoxGeometry(10,1,1),new M.MeshNormalMaterial)).position.copy(t.positiona),i.rotation.set(t.axis.y,t.axis.x,t.axis.z),this._objects[t.objecta].add(i);break;case"conetwist":case"dof":(i=new M.Mesh(new M.SphereGeometry(1.5),new M.MeshNormalMaterial)).position.copy(t.positiona),this._objects[t.objecta].add(i)}return t},l.Scene.prototype.onSimulationResume=function(){this.execute("onSimulationResume",{})},l.Scene.prototype.removeConstraint=function(t){void 0!==this._constraints[t.id]&&(this.execute("removeConstraint",{id:t.id}),delete this._constraints[t.id])},l.Scene.prototype.execute=function(t,e){this._worker.postMessage({cmd:t,params:e})},r=function(t,e){var i;for(i=0;i<e.children.length;i++)e.children[i]._physijs&&(e.children[i].updateMatrix(),e.children[i].updateMatrixWorld(),f.setFromMatrixPosition(e.children[i].matrixWorld),y.setFromRotationMatrix(e.children[i].matrixWorld),e.children[i]._physijs.position_offset={x:f.x,y:f.y,z:f.z},e.children[i]._physijs.rotation={x:y.x,y:y.y,z:y.z,w:y.w},t._physijs.children.push(e.children[i]._physijs)),r(t,e.children[i])},l.Scene.prototype.add=function(t){M.Mesh.prototype.add.call(this,t),t._physijs&&(t.world=this,t instanceof l.Vehicle?(this.add(t.mesh),this._vehicles[t._physijs.id]=t,this.execute("addVehicle",t._physijs)):(t.__dirtyPosition=!1,t.__dirtyRotation=!1,(this._objects[t._physijs.id]=t).children.length&&(t._physijs.children=[],r(t,t)),t.material._physijs&&(this._materials_ref_counts.hasOwnProperty(t.material._physijs.id)?this._materials_ref_counts[t.material._physijs.id]++:(this.execute("registerMaterial",t.material._physijs),t._physijs.materialId=t.material._physijs.id,this._materials_ref_counts[t.material._physijs.id]=1)),t._physijs.position={x:t.position.x,y:t.position.y,z:t.position.z},t._physijs.rotation={x:t.quaternion.x,y:t.quaternion.y,z:t.quaternion.z,w:t.quaternion.w},new M.Vector3(1,1,1),t._physijs.width&&(t._physijs.width*=t.scale.x),t._physijs.height&&(t._physijs.height*=t.scale.y),t._physijs.depth&&(t._physijs.depth*=t.scale.z),this.execute("addObject",t._physijs)))},l.Scene.prototype.remove=function(t){if(t instanceof l.Vehicle){for(this.execute("removeVehicle",{id:t._physijs.id});t.wheels.length;)this.remove(t.wheels.pop());this.remove(t.mesh),delete this._vehicles[t._physijs.id]}else M.Mesh.prototype.remove.call(this,t),t._physijs&&(delete this._objects[t._physijs.id],this.execute("removeObject",{id:t._physijs.id}));t.material&&t.material._physijs&&this._materials_ref_counts.hasOwnProperty(t.material._physijs.id)&&(this._materials_ref_counts[t.material._physijs.id]--,0==this._materials_ref_counts[t.material._physijs.id]&&(this.execute("unRegisterMaterial",t.material._physijs),delete this._materials_ref_counts[t.material._physijs.id]))},l.Scene.prototype.setFixedTimeStep=function(t){t&&this.execute("setFixedTimeStep",t)},l.Scene.prototype.setGravity=function(t){t&&this.execute("setGravity",t)},l.Scene.prototype.simulate=function(t,e){var i,r,n;if(h)return!1;for(i in h=!0,this._objects)this._objects.hasOwnProperty(i)&&((r=this._objects[i]).__dirtyPosition||r.__dirtyRotation)&&(n={id:r._physijs.id},r.__dirtyPosition&&(n.pos={x:r.position.x,y:r.position.y,z:r.position.z},r.__dirtyPosition=!1),r.__dirtyRotation&&(n.quat={x:r.quaternion.x,y:r.quaternion.y,z:r.quaternion.z,w:r.quaternion.w},r.__dirtyRotation=!1),this.execute("updateTransform",n));return this.execute("simulate",{timeStep:t,maxSubSteps:e}),!0},l.Mesh=function(t,e,i){t&&(n.call(this),M.Mesh.call(this,t,e),t.boundingBox||t.computeBoundingBox(),this._physijs={type:null,id:o(),mass:i||0,touches:[],linearVelocity:new M.Vector3,angularVelocity:new M.Vector3})},l.Mesh.prototype=new M.Mesh,l.Mesh.prototype.constructor=l.Mesh,n.make(l.Mesh),l.Mesh.prototype.__defineGetter__("mass",function(){return this._physijs.mass}),l.Mesh.prototype.__defineSetter__("mass",function(t){this._physijs.mass=t,this.world&&this.world.execute("updateMass",{id:this._physijs.id,mass:t})}),l.Mesh.prototype.applyCentralImpulse=function(t){this.world&&this.world.execute("applyCentralImpulse",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.applyImpulse=function(t,e){this.world&&this.world.execute("applyImpulse",{id:this._physijs.id,impulse_x:t.x,impulse_y:t.y,impulse_z:t.z,x:e.x,y:e.y,z:e.z})},l.Mesh.prototype.applyCentralForce=function(t){this.world&&this.world.execute("applyCentralForce",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.applyForce=function(t,e){this.world&&this.world.execute("applyForce",{id:this._physijs.id,force_x:t.x,force_y:t.y,force_z:t.z,x:e.x,y:e.y,z:e.z})},l.Mesh.prototype.getAngularVelocity=function(){return this._physijs.angularVelocity},l.Mesh.prototype.setAngularVelocity=function(t){this.world&&this.world.execute("setAngularVelocity",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.getLinearVelocity=function(){return this._physijs.linearVelocity},l.Mesh.prototype.setLinearVelocity=function(t){this.world&&this.world.execute("setLinearVelocity",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.setAngularFactor=function(t){this.world&&this.world.execute("setAngularFactor",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.setLinearFactor=function(t){this.world&&this.world.execute("setLinearFactor",{id:this._physijs.id,x:t.x,y:t.y,z:t.z})},l.Mesh.prototype.setDamping=function(t,e){this.world&&this.world.execute("setDamping",{id:this._physijs.id,linear:t,angular:e})},l.Mesh.prototype.setCcdMotionThreshold=function(t){this.world&&this.world.execute("setCcdMotionThreshold",{id:this._physijs.id,threshold:t})},l.Mesh.prototype.setCcdSweptSphereRadius=function(t){this.world&&this.world.execute("setCcdSweptSphereRadius",{id:this._physijs.id,radius:t})},l.PlaneMesh=function(t,e,i){var r,n;l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=t.boundingBox.max.x-t.boundingBox.min.x,n=t.boundingBox.max.y-t.boundingBox.min.y,this._physijs.type="plane",this._physijs.normal=t.faces[0].normal.clone(),this._physijs.mass=void 0===i?r*n:i},l.PlaneMesh.prototype=new l.Mesh,l.PlaneMesh.prototype.constructor=l.PlaneMesh,l.HeightfieldMesh=function(t,e,i,r,n){l.Mesh.call(this,t,e,i),this._physijs.type="heightfield",this._physijs.xsize=t.boundingBox.max.x-t.boundingBox.min.x,this._physijs.ysize=t.boundingBox.max.y-t.boundingBox.min.y,this._physijs.xpts=void 0===r?Math.sqrt(t.vertices.length):r+1,this._physijs.ypts=void 0===n?Math.sqrt(t.vertices.length):n+1,this._physijs.absMaxHeight=Math.max(t.boundingBox.max.z,Math.abs(t.boundingBox.min.z));for(var o,a,s=[],h=0;h<t.vertices.length;h++)o=h%this._physijs.xpts,a=Math.round(h/this._physijs.xpts-h%this._physijs.xpts/this._physijs.xpts),s[h]=t.vertices[o+(this._physijs.ypts-a-1)*this._physijs.ypts].z;this._physijs.points=s},l.HeightfieldMesh.prototype=new l.Mesh,l.HeightfieldMesh.prototype.constructor=l.HeightfieldMesh,l.BoxMesh=function(t,e,i){var r,n,o;l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=t.boundingBox.max.x-t.boundingBox.min.x,n=t.boundingBox.max.y-t.boundingBox.min.y,o=t.boundingBox.max.z-t.boundingBox.min.z,this._physijs.type="box",this._physijs.width=r,this._physijs.height=n,this._physijs.depth=o,this._physijs.mass=void 0===i?r*n*o:i},l.BoxMesh.prototype=new l.Mesh,l.BoxMesh.prototype.constructor=l.BoxMesh,l.SphereMesh=function(t,e,i){l.Mesh.call(this,t,e,i),t.boundingSphere||t.computeBoundingSphere(),this._physijs.type="sphere",this._physijs.radius=t.boundingSphere.radius,this._physijs.mass=void 0===i?4/3*Math.PI*Math.pow(this._physijs.radius,3):i},l.SphereMesh.prototype=new l.Mesh,l.SphereMesh.prototype.constructor=l.SphereMesh,l.CylinderMesh=function(t,e,i){var r,n,o;l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=t.boundingBox.max.x-t.boundingBox.min.x,n=t.boundingBox.max.y-t.boundingBox.min.y,o=t.boundingBox.max.z-t.boundingBox.min.z,this._physijs.type="cylinder",this._physijs.width=r,this._physijs.height=n,this._physijs.depth=o,this._physijs.mass=void 0===i?r*n*o:i},l.CylinderMesh.prototype=new l.Mesh,l.CylinderMesh.prototype.constructor=l.CylinderMesh,l.CapsuleMesh=function(t,e,i){var r,n,o;l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=t.boundingBox.max.x-t.boundingBox.min.x,n=t.boundingBox.max.y-t.boundingBox.min.y,o=t.boundingBox.max.z-t.boundingBox.min.z,this._physijs.type="capsule",this._physijs.radius=Math.max(r/2,o/2),this._physijs.height=n,this._physijs.mass=void 0===i?r*n*o:i},l.CapsuleMesh.prototype=new l.Mesh,l.CapsuleMesh.prototype.constructor=l.CapsuleMesh,l.ConeMesh=function(t,e,i){var r,n;l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=t.boundingBox.max.x-t.boundingBox.min.x,n=t.boundingBox.max.y-t.boundingBox.min.y,this._physijs.type="cone",this._physijs.radius=r/2,this._physijs.height=n,this._physijs.mass=void 0===i?r*n:i},l.ConeMesh.prototype=new l.Mesh,l.ConeMesh.prototype.constructor=l.ConeMesh,l.ConcaveMesh=function(t,e,i){var r,n,o,a,s,h,c=[];for(l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),s=t.vertices,r=0;r<t.faces.length;r++)(h=t.faces[r])instanceof M.Face3?c.push([{x:s[h.a].x,y:s[h.a].y,z:s[h.a].z},{x:s[h.b].x,y:s[h.b].y,z:s[h.b].z},{x:s[h.c].x,y:s[h.c].y,z:s[h.c].z}]):h instanceof M.Face4&&(c.push([{x:s[h.a].x,y:s[h.a].y,z:s[h.a].z},{x:s[h.b].x,y:s[h.b].y,z:s[h.b].z},{x:s[h.d].x,y:s[h.d].y,z:s[h.d].z}]),c.push([{x:s[h.b].x,y:s[h.b].y,z:s[h.b].z},{x:s[h.c].x,y:s[h.c].y,z:s[h.c].z},{x:s[h.d].x,y:s[h.d].y,z:s[h.d].z}]));n=t.boundingBox.max.x-t.boundingBox.min.x,o=t.boundingBox.max.y-t.boundingBox.min.y,a=t.boundingBox.max.z-t.boundingBox.min.z,this._physijs.type="concave",this._physijs.triangles=c,this._physijs.mass=void 0===i?n*o*a:i},l.ConcaveMesh.prototype=new l.Mesh,l.ConcaveMesh.prototype.constructor=l.ConcaveMesh,l.ConvexMesh=function(t,e,i){var r,n,o,a,s=[];for(l.Mesh.call(this,t,e,i),t.boundingBox||t.computeBoundingBox(),r=0;r<t.vertices.length;r++)s.push({x:t.vertices[r].x,y:t.vertices[r].y,z:t.vertices[r].z});n=t.boundingBox.max.x-t.boundingBox.min.x,o=t.boundingBox.max.y-t.boundingBox.min.y,a=t.boundingBox.max.z-t.boundingBox.min.z,this._physijs.type="convex",this._physijs.points=s,this._physijs.mass=void 0===i?n*o*a:i},l.ConvexMesh.prototype=new l.Mesh,l.ConvexMesh.prototype.constructor=l.ConvexMesh,l.Vehicle=function(t,e){e=e||new l.VehicleTuning,this.mesh=t,this.wheels=[],this._physijs={id:o(),rigidBody:t._physijs.id,suspension_stiffness:e.suspension_stiffness,suspension_compression:e.suspension_compression,suspension_damping:e.suspension_damping,max_suspension_travel:e.max_suspension_travel,friction_slip:e.friction_slip,max_suspension_force:e.max_suspension_force}},l.Vehicle.prototype.addWheel=function(t,e,i,r,n,o,a,s,h){var c=new M.Mesh(t,e);c.castShadow=c.receiveShadow=!0,c.position.copy(r).multiplyScalar(o/100).add(i),this.world.add(c),this.wheels.push(c),this.world.execute("addWheel",{id:this._physijs.id,connection_point:{x:i.x,y:i.y,z:i.z},wheel_direction:{x:r.x,y:r.y,z:r.z},wheel_axle:{x:n.x,y:n.y,z:n.z},suspension_rest_length:o,wheel_radius:a,is_front_wheel:s,tuning:h})},l.Vehicle.prototype.setSteering=function(t,e){if(void 0!==e&&void 0!==this.wheels[e])this.world.execute("setSteering",{id:this._physijs.id,wheel:e,steering:t});else if(0<this.wheels.length)for(var i=0;i<this.wheels.length;i++)this.world.execute("setSteering",{id:this._physijs.id,wheel:i,steering:t})},l.Vehicle.prototype.setBrake=function(t,e){if(void 0!==e&&void 0!==this.wheels[e])this.world.execute("setBrake",{id:this._physijs.id,wheel:e,brake:t});else if(0<this.wheels.length)for(var i=0;i<this.wheels.length;i++)this.world.execute("setBrake",{id:this._physijs.id,wheel:i,brake:t})},l.Vehicle.prototype.applyEngineForce=function(t,e){if(void 0!==e&&void 0!==this.wheels[e])this.world.execute("applyEngineForce",{id:this._physijs.id,wheel:e,force:t});else if(0<this.wheels.length)for(var i=0;i<this.wheels.length;i++)this.world.execute("applyEngineForce",{id:this._physijs.id,wheel:i,force:t})},l.VehicleTuning=function(t,e,i,r,n,o){this.suspension_stiffness=void 0!==t?t:5.88,this.suspension_compression=void 0!==e?e:.83,this.suspension_damping=void 0!==i?i:.88,this.max_suspension_travel=void 0!==r?r:500,this.friction_slip=void 0!==n?n:10.5,this.max_suspension_force=void 0!==o?o:6e3},l)},{three:18}],10:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}(),o=function t(e,i,r){var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,r)}if("value"in n&&n.writable)return n.value;var a=n.get;return void 0!==a?a.call(r):void 0};Object.defineProperty(i,"__esModule",{value:!0});var a=t("three"),s=t("jquery"),h=t("./lib/buzz.js"),c=(t("kutility"),t("./sheen-scene.es6").SheenScene),l=t("./gallery.es6").Gallery,u=s("#splash-status"),p="is loading";i.MainScene=function(t){function n(t,e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),o(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,t,e,i,r),this.name="Art Decade",this.onPhone=r.onPhone||!1}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}(n,c),r(n,{enter:{value:function(){o(Object.getPrototypeOf(n.prototype),"enter",this).call(this),this.loading=!0,this.updateLoadingView(),this.sound=new h.sound("/media/falling3",{formats:["mp3","ogg"],webAudioApi:!0,volume:100}),h.defaults.duration=2e3,this.makeLights(),this.david=new l(this.scene,{domMode:this.onPhone,controlObject:this.controlObject,pitchObject:this.pitchObject,yLevel:0})}},doTimedWork:{value:function(){var t=this;o(Object.getPrototypeOf(n.prototype),"doTimedWork",this).call(this),this.david.create(function(){t.galleryDidLoad()})}},exit:{value:function(){o(Object.getPrototypeOf(n.prototype),"exit",this).call(this),this.david.destroy()}},children:{value:function(){return[this.lightContainer]}},update:{value:function(){o(Object.getPrototypeOf(n.prototype),"update",this).call(this),this.lightContainer&&(this.lightContainer.position.y=this.camera.position.y-5),this.david&&this.david.update()}},spacebarPressed:{value:function(){this.david.layout&&this.david.layout.toggleSlowMotion()}},toggleSingleRotation:{value:function(){this.david.layout&&this.david.layout.toggleRotateOnce()}},toggleCrazyRotation:{value:function(){this.david.layout&&this.david.layout.toggleCrazyRotate()}},toggleBigCube:{value:function(){this.david.layout&&this.david.layout.toggleBigCube()}},click:{value:function(){this.loading||this.hasStarted||this.start()}},updateLoadingView:{value:function(){var t=this;if(this.loading){var e=u.text();e.length<p.length+3?(e+=".",u.text(e)):u.text(p),setTimeout(function(){t.updateLoadingView()},250)}}},galleryDidLoad:{value:function(){var t=this;this.loading=!1,u.text("is ready"),u.css("font-style","italic"),this.onPhone?s("#mobile-error-overlay").fadeIn(1e3):(setTimeout(function(){t.hasStarted||s("#splash-controls").fadeIn(1e3)},250),setTimeout(function(){t.hasStarted||s("#click-to-start").fadeIn(1e3)},1750))}},start:{value:function(){s(".splash-overlay").fadeOut(1e3),this.onPhone&&s("#mobile-error-overlay").fadeOut(1e3),this.sound.loop().play().fadeIn().fadeOut(),this.david.layout.start(),this.hasStarted=!0,this.onPhone||(setTimeout(function(){s("#key-hint-1").fadeIn(666),setTimeout(function(){s("#key-hint-1").fadeOut(666)},9666)},43e3),setTimeout(function(){s("#key-hint-2").fadeIn(666),setTimeout(function(){s("#key-hint-2").fadeOut(666)},9666)},21e4))}},makeLights:{value:function(){var t,e=new a.Object3D;function i(){var t=new a.DirectionalLight(16777215,.9);return t.color.setHSL(.1,1,.95),e.add(t),t}this.scene.add(e),this.lightContainer=e,this.frontLight=i(),this.frontLight.position.set(-40,125,200),(t=this.frontLight).castShadow=!0,t.shadowCameraFar=500,t.shadowDarkness=.6,t.shadowMapWidth=t.shadowMapHeight=2048,this.backLight=i(),this.backLight.position.set(40,125,-200),this.leftLight=i(),this.leftLight.position.set(-200,75,-45),this.rightLight=i(),this.rightLight.position.set(200,75,-45),this.rightLight.shadowDarkness=.05,this.lights=[this.frontLight,this.backLight,this.leftLight,this.rightLight]}}}),n}()},{"./gallery.es6":5,"./lib/buzz.js":8,"./sheen-scene.es6":13,jquery:16,kutility:17,three:18}],11:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}(),n=function t(e,i,r){var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,r)}if("value"in n&&n.writable)return n.value;var a=n.get;return void 0!==a?a.call(r):void 0},o=t("jquery"),a=t("three"),s=t("./lib/physi.js"),h=t("./three-boiler.es6").ThreeBoiler,c=t("./main-scene.es6").MainScene,l=t("./controls/fly-controls"),u=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),p=function(t){function i(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,{antialias:!0,alpha:!0,onPhone:u}),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||o("#splash-please-use-chrome").show(),this.renderer&&(this.renderer.shadowMapEnabled=!0,this.renderer.shadowMapCullFace=a.CullFaceBack,this.renderer.shadowMapType=a.PCFSoftShadowMap,this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0),this.controls=new l(this.camera),this.scene.add(this.controls.getObject()),this.mainScene=new c(this.renderer,this.camera,this.scene,{onPhone:u}),this.mainScene.controlObject=this.controls.getObject(),this.mainScene.pitchObject=this.controls.pitchObject(),o(document).click(function(t){o(t.target).is("a")||(e.controls.requestPointerlock&&e.controls.requestPointerlock(),e.controls.enabled=!0,e.mainScene.click())})}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}(i,h),r(i,{createScene:{value:function(){var t=new s.Scene;return t.setGravity(new a.Vector3(0,-5,0)),t.addEventListener("update",function(){t.simulate(void 0,1)}),t}},activate:{value:function(){n(Object.getPrototypeOf(i.prototype),"activate",this).call(this),this.scene.simulate(),this.mainScene.startScene()}},render:{value:function(){n(Object.getPrototypeOf(i.prototype),"render",this).call(this),this.controls.update(),this.mainScene.update()}},keypress:{value:function(t){switch(n(Object.getPrototypeOf(i.prototype),"keypress",this).call(this,t),t){case 113:this.mainScene.toggleCrazyRotation();break;case 114:this.mainScene.toggleSingleRotation();break;case 112:this.mainScene.toggleBigCube()}}},spacebarPressed:{value:function(){this.mainScene.spacebarPressed()}}}),i}();o(function(){(new p).activate()})},{"./controls/fly-controls":1,"./lib/physi.js":9,"./main-scene.es6":10,"./three-boiler.es6":14,jquery:16,three:18}],12:[function(t,e,i){"use strict";var o=t("three"),a=t("kutility"),s=t("./lib/physi.js");e.exports=r;var h=t("./util/model-loader");function r(t){var e=t.position||new o.Vector3;this.startX=e.x,this.startY=e.y,this.startZ=e.z,this.scale=t.scale||1,this.modelName=t.modelName,this.modelChoices=[],this.meshCreator=t.meshCreator,this.ignorePhysics=t.ignorePhysics,this.mass=t.mass||20,this.friction=t.friction||.4,this.restitution=t.restitution||.6,this.collisionHandler=t.collisionHandler,this.melting=!1,this.twitching=!1}r.prototype.move=function(t,e,i){this.mesh&&(this.mesh.position.x+=t,this.mesh.position.y+=e,this.mesh.position.z+=i,this.mesh.__dirtyPosition=!0)},r.prototype.rotate=function(t,e,i){this.mesh&&(this.mesh.rotation.x+=t,this.mesh.rotation.y+=e,this.mesh.rotation.z+=i,this.mesh.__dirtyRotation=!0)},r.prototype.moveTo=function(t,e,i){this.mesh&&(this.mesh.position.set(t,e,i),this.move(0,0,0))},r.prototype.scaleBody=function(t){this.mesh&&this.mesh.scale.set(t,t,t)},r.prototype.scaleMultiply=function(t){this.mesh&&this.mesh.scale.set(this.initialScale.x*t,this.initialScale.y*t,this.initialScale.z*t)},r.prototype.createMesh=function(r){var n=this;n.meshCreator?n.meshCreator(function(t,e,i){n.geometry=t,n.material=e,n.mesh=i,r&&r()}):(n.modelName||(n.modelChoices?n.modelName=a.choice(n.modelChoices):n.modelName=""),h(n.modelName,function(t,e){n.geometry=t,n.materials=e,n.faceMaterial=new o.MeshFaceMaterial(e),n.ignorePhysics?(n.material=n.faceMaterial,n.mesh=new o.Mesh(t,n.material)):(n.material=s.createMaterial(n.faceMaterial,this.friction,this.restitution),n.mesh=new s.ConvexMesh(t,n.material,n.mass)),r&&r()}))},r.prototype.addTo=function(t,e){var n=this,i=function(){t.add(n.mesh),e&&e(n)};n.mesh?i():n.createMesh(function(){!n.ignorePhysics&&n.collisionHandler&&n.mesh.addEventListener("collision",function(t,e,i,r){n.collisionHandler(t,e,i,r)}),n.scaleBody(n.scale),n.moveTo(n.startX,n.startY,n.startZ),n.additionalInit(),n.initialPosition={x:n.mesh.position.x,y:n.mesh.position.y,z:n.mesh.position.z},n.initialScale={x:n.mesh.scale.x,y:n.mesh.scale.y,z:n.mesh.scale.z},n.initialRotation={x:n.mesh.rotation.x,y:n.mesh.rotation.y,z:n.mesh.rotation.z},i()})},r.prototype.removeFrom=function(t){this.mesh&&t.remove(this.mesh)},r.prototype.setMeshColor=function(t){if(this.mesh)for(var e=this.mesh.material.materials||[this.mesh.material],i=0;i<e.length;i++){var r=e[i];r.color=new o.Color(t),r.ambient=new o.Color(t),r.emissive=new o.Color(t),r.needsUpdate=!0}},r.prototype.update=function(){this.twitching&&this.twitch(this.twitchIntensity||1),this.fluctuating&&this.fluctuate(1),this.additionalRender()},r.prototype.twitch=function(t){var e=(Math.random()-.5)*t,i=(Math.random()-.5)*t,r=(Math.random()-.5)*t;this.move(e,i,r)},r.prototype.fluctuate=function(t){var e=(Math.random()-.5)*t,i=(Math.random()-.5)*t,r=(Math.random()-.5)*t;this.rotate(e,i,r)},r.prototype.fallToFloor=function(e,i){e||(e=1.5),i||(i=.5);var r=this,n=setInterval(function(){var t=Math.random()*-i;r.move(0,t,0),r.mesh&&r.mesh.position.y<e&&clearInterval(n)},24)},r.prototype.additionalInit=function(){},r.prototype.additionalRender=function(){}},{"./lib/physi.js":9,"./util/model-loader":15,kutility:17,three:18}],13:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}();Object.defineProperty(i,"__esModule",{value:!0});t("three");var o=t("jquery");i.SheenScene=function(){function n(t,e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.renderer=t,this.camera=e,this.scene=i,this.options=r,this.name="sheen scene",this.domContainer=o("body"),o(window).resize(this.resize.bind(this)),this.hasStarted=!1}return r(n,{update:{value:function(){}},startScene:{value:function(){this.enter(),this.isLive||this.doTimedWork()}},enter:{value:function(){this.active=!0,this.camera.position.set(0,0,0),this.camera.rotation.x=0,this.camera.rotation.y=0,this.camera.rotation.z=0}},doTimedWork:{value:function(){}},exit:{value:function(){this.active=!1;for(var t=this.children(),e=0;e<t.length;e++){var i=t[e];this.scene.remove(i)}}},iWantOut:{value:function(){this.exitCallback&&this.exitCallback(this)}},addMesh:{value:function(){}},click:{value:function(){this.active&&this.isLive&&!this.hasStarted&&(this.doTimedWork(),this.hasStarted=!0)}},resize:{value:function(){}},children:{value:function(){return[]}},makeAudio:{value:function(t){var e=document.createElement("audio");return e.src=t+".mp3",e.preload=!0,e}},makeVideo:{value:function(t,e,i){var r,n=document.createElement("video");return r=0<n.canPlayType("video/mp4").length?t+".mp4":t+".webm",n.src=r,n.preload=!0,n.loop=!0,e?o(n).addClass("full-screen-video"):o(n).addClass("video-overlay"),void 0!==i&&o(n).css("z-index",i),this.domContainer.append(n),n}},makeImage:{value:function(t,e,i){var r=o(\'<img src="\'+t+\'" class="image-overlay"/>\');return e&&(r.css("top","0px"),r.css("left","0px"),r.css("width","100%"),r.css("height","100%")),void 0!==i&&r.css("z-index",i),this.domContainer.append(r),r}},makeCanvas:{value:function(t){var e=o(\'<canvas class="canvas-overlay"></canvas>\');return void 0!==t&&e.css("z-index",t),this.domContainer.append(e),e.get(0)}}}),n}()},{jquery:16,three:18}],14:[function(t,e,i){"use strict";var r=function(){function r(t,e){for(var i in e){var r=e[i];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("jquery"),o=t("three");i.ThreeBoiler=function(){function i(t){var e=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.onPhone=t.onPhone||!1,!this.onPhone){try{this.renderer=new o.WebGLRenderer(t),this.renderMode="webgl"}catch(t){n(".webgl-error").show(),setTimeout(function(){n(".webgl-error").fadeOut()},6666),this.renderer=new o.CanvasRenderer,this.renderMode="canvas"}this.renderer.setClearColor(16777215,1),document.body.appendChild(this.renderer.domElement)}this.scene=this.createScene(),this.camera=this.createCamera(),this.scene.add(this.camera),this.ambientLight=this.createAmbientLight(),this.scene.add(this.ambientLight),n(window).resize(function(){e.resize()}),this.resize(),n("body").keypress(function(t){e.keypress(t.which)})}return r(i,{createScene:{value:function(){return new o.Scene}},createCamera:{value:function(){return new o.PerspectiveCamera(65,window.innerWidth/window.innerHeight,1,5e3)}},createAmbientLight:{value:function(){return new o.AmbientLight(4210752)}},activate:{value:function(){this.frame=0,this.render()}},render:{value:function(){var t=this;requestAnimationFrame(function(){t.render()}),this.frame+=1,this.renderer&&this.renderer.render(this.scene,this.camera)}},resize:{value:function(){this.renderer&&this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},fadeSceneOverlay:{value:function(t,e){e||(e={});var i=e.duration||1e3;$sceneOverlay.fadeIn(i,function(){t(),$sceneOverlay.fadeOut(i)})}},keypress:{value:function(t){switch(t){case 32:this.spacebarPressed()}}},spacebarPressed:{value:function(){}}}),i}();window._typeface_js={faces:o.FontUtils.faces,loadFace:o.FontUtils.loadFace},o.typeface_js=window._typeface_js,function(){for(var n=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),r=window.setTimeout(function(){t(e+i)},i);return n=e+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},{jquery:16,three:18}],15:[function(t,e,i){"use strict";var r=t("three"),a={};function s(t,e){var i,r=a[t],n=r.geometry.clone();if(Array.isArray(r.materials)){i=[];for(var o=0;o<r.materials.length;o++)i.push(r.materials[o].clone())}else i=r.materials.clone();e(n,i)}e.exports=function(n,o){"function"==typeof o&&(a[n]?s(n,o):(new r.JSONLoader).load(n,function(t,e){var i,r;i=t,r=e,a[n]={geometry:i,materials:r},s(n,o)}))}},{three:18}],16:[function(t,e,i){var r,n;r="undefined"!=typeof window?window:this,n=function(f,t){var e=[],l=e.slice,m=e.concat,s=e.push,n=e.indexOf,i={},r=i.toString,g=i.hasOwnProperty,y={},v=f.document,_=function(t,e){return new _.fn.init(t,e)},o=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,a=/^-ms-/,h=/-([\\da-z])/gi,c=function(t,e){return e.toUpperCase()};function u(t){var e=t.length,i=_.type(t);return"function"!==i&&!_.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t))}_.fn=_.prototype={jquery:"2.1.3",constructor:_,selector:"",length:0,toArray:function(){return l.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:l.call(this)},pushStack:function(t){var e=_.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return _.each(this,t,e)},map:function(i){return this.pushStack(_.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(0<=i&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:e.sort,splice:e.splice},_.extend=_.fn.extend=function(){var t,e,i,r,n,o,a=arguments[0]||{},s=1,h=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||_.isFunction(a)||(a={}),s===h&&(a=this,s--);s<h;s++)if(null!=(t=arguments[s]))for(e in t)i=a[e],a!==(r=t[e])&&(c&&r&&(_.isPlainObject(r)||(n=_.isArray(r)))?(o=n?(n=!1,i&&_.isArray(i)?i:[]):i&&_.isPlainObject(i)?i:{},a[e]=_.extend(c,o,r)):void 0!==r&&(a[e]=r));return a},_.extend({expando:"jQuery"+("2.1.3"+Math.random()).replace(/\\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===_.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!_.isArray(t)&&0<=t-parseFloat(t)+1},isPlainObject:function(t){return"object"===_.type(t)&&!t.nodeType&&!_.isWindow(t)&&!(t.constructor&&!g.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i[r.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=_.trim(t))&&(1===t.indexOf("use strict")?((e=v.createElement("script")).text=t,v.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(a,"ms-").replace(h,c)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var r=0,n=t.length,o=u(t);if(i){if(o)for(;r<n&&!1!==e.apply(t[r],i);r++);else for(r in t)if(!1===e.apply(t[r],i))break}else if(o)for(;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(o,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(u(Object(t))?_.merge(i,"string"==typeof t?[t]:t):s.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:n.call(e,t,i)},merge:function(t,e){for(var i=+e.length,r=0,n=t.length;r<i;r++)t[n++]=e[r];return t.length=n,t},grep:function(t,e,i){for(var r=[],n=0,o=t.length,a=!i;n<o;n++)!e(t[n],n)!==a&&r.push(t[n]);return r},map:function(t,e,i){var r,n=0,o=t.length,a=[];if(u(t))for(;n<o;n++)null!=(r=e(t[n],n,i))&&a.push(r);else for(n in t)null!=(r=e(t[n],n,i))&&a.push(r);return m.apply([],a)},guid:1,proxy:function(t,e){var i,r,n;if("string"==typeof e&&(i=t[e],e=t,t=i),_.isFunction(t))return r=l.call(arguments,2),(n=function(){return t.apply(e||this,r.concat(l.call(arguments)))}).guid=t.guid=t.guid||_.guid++,n},now:Date.now,support:y}),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){i["[object "+e+"]"]=e.toLowerCase()});var p=function(i){var t,f,b,o,r,m,u,g,w,c,l,y,M,n,v,x,a,s,_,S="sizzle"+1*new Date,T=i.document,C=0,p=0,h=ot(),d=ot(),E=ot(),A=function(t,e){return t===e&&(l=!0),0},L={}.hasOwnProperty,e=[],P=e.pop,k=e.push,R=e.push,D=e.slice,F=function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\\\x20\\\\t\\\\r\\\\n\\\\f]",U="(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+",V=U.replace("w","w#"),N="\\\\["+B+"*("+U+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\"|("+V+"))|)"+B+"*\\\\]",z=":("+U+")(?:\\\\(((\'((?:\\\\\\\\.|[^\\\\\\\\\'])*)\'|\\"((?:\\\\\\\\.|[^\\\\\\\\\\"])*)\\")|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|"+N+")*)|.*)\\\\)|)",I=new RegExp(B+"+","g"),G=new RegExp("^"+B+"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)"+B+"+$","g"),j=new RegExp("^"+B+"*,"+B+"*"),H=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),W=new RegExp("="+B+"*([^\\\\]\'\\"]*?)"+B+"*\\\\]","g"),X=new RegExp(z),q=new RegExp("^"+V+"$"),Y={ID:new RegExp("^#("+U+")"),CLASS:new RegExp("^\\\\.("+U+")"),TAG:new RegExp("^("+U.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\("+B+"*(even|odd|(([+-]|)(\\\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\\\d+)|))"+B+"*\\\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\("+B+"*((?:-\\\\d)?\\\\d*)"+B+"*\\\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,Q=/^h\\d$/i,Z=/^[^{]+\\{\\s*\\[native \\w/,J=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,$=/[+~]/,tt=/\'|\\\\/g,et=new RegExp("\\\\\\\\([\\\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),it=function(t,e,i){var r="0x"+e-65536;return r!=r||i?e:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},rt=function(){y()};try{R.apply(e=D.call(T.childNodes),T.childNodes),e[T.childNodes.length].nodeType}catch(t){R={apply:e.length?function(t,e){k.apply(t,D.call(e))}:function(t,e){for(var i=t.length,r=0;t[i++]=e[r++];);t.length=i-1}}}function nt(t,e,i,r){var n,o,a,s,h,c,l,u,p,d;if((e?e.ownerDocument||e:T)!==M&&y(e),i=i||[],s=(e=e||M).nodeType,"string"!=typeof t||!t||1!==s&&9!==s&&11!==s)return i;if(!r&&v){if(11!==s&&(n=J.exec(t)))if(a=n[1]){if(9===s){if(!(o=e.getElementById(a))||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&_(e,o)&&o.id===a)return i.push(o),i}else{if(n[2])return R.apply(i,e.getElementsByTagName(t)),i;if((a=n[3])&&f.getElementsByClassName)return R.apply(i,e.getElementsByClassName(a)),i}if(f.qsa&&(!x||!x.test(t))){if(u=l=S,p=e,d=1!==s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(c=m(t),(l=e.getAttribute("id"))?u=l.replace(tt,"\\\\$&"):e.setAttribute("id",u),u="[id=\'"+u+"\'] ",h=c.length;h--;)c[h]=u+mt(c[h]);p=$.test(t)&&dt(e.parentNode)||e,d=c.join(",")}if(d)try{return R.apply(i,p.querySelectorAll(d)),i}catch(t){}finally{l||e.removeAttribute("id")}}}return g(t.replace(G,"$1"),e,i,r)}function ot(){var r=[];return function t(e,i){return r.push(e+" ")>b.cacheLength&&delete t[r.shift()],t[e+" "]=i}}function at(t){return t[S]=!0,t}function st(t){var e=M.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var i=t.split("|"),r=t.length;r--;)b.attrHandle[i[r]]=e}function ct(t,e){var i=e&&t,r=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(r)return r;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function lt(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ut(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}function pt(a){return at(function(o){return o=+o,at(function(t,e){for(var i,r=a([],t.length,o),n=r.length;n--;)t[i=r[n]]&&(t[i]=!(e[i]=t[i]))})})}function dt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in f=nt.support={},r=nt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},y=nt.setDocument=function(t){var e,i,h=t?t.ownerDocument||t:T;return h!==M&&9===h.nodeType&&h.documentElement?(n=(M=h).documentElement,(i=h.defaultView)&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",rt,!1):i.attachEvent&&i.attachEvent("onunload",rt)),v=!r(h),f.attributes=st(function(t){return t.className="i",!t.getAttribute("className")}),f.getElementsByTagName=st(function(t){return t.appendChild(h.createComment("")),!t.getElementsByTagName("*").length}),f.getElementsByClassName=Z.test(h.getElementsByClassName),f.getById=st(function(t){return n.appendChild(t).id=S,!h.getElementsByName||!h.getElementsByName(S).length}),f.getById?(b.find.ID=function(t,e){if(void 0!==e.getElementById&&v){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},b.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var i=t.replace(et,it);return function(t){var e=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===i}}),b.find.TAG=f.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):f.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,r=[],n=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;i=o[n++];)1===i.nodeType&&r.push(i);return r},b.find.CLASS=f.getElementsByClassName&&function(t,e){if(v)return e.getElementsByClassName(t)},a=[],x=[],(f.qsa=Z.test(h.querySelectorAll))&&(st(function(t){n.appendChild(t).innerHTML="<a id=\'"+S+"\'></a><select id=\'"+S+"-\\f]\' msallowcapture=\'\'><option selected=\'\'></option></select>",t.querySelectorAll("[msallowcapture^=\'\']").length&&x.push("[*^$]="+B+"*(?:\'\'|\\"\\")"),t.querySelectorAll("[selected]").length||x.push("\\\\["+B+"*(?:value|"+O+")"),t.querySelectorAll("[id~="+S+"-]").length||x.push("~="),t.querySelectorAll(":checked").length||x.push(":checked"),t.querySelectorAll("a#"+S+"+*").length||x.push(".#.+[+~]")}),st(function(t){var e=h.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&x.push("name"+B+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||x.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),x.push(",.*:")})),(f.matchesSelector=Z.test(s=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.oMatchesSelector||n.msMatchesSelector))&&st(function(t){f.disconnectedMatch=s.call(t,"div"),s.call(t,"[s!=\'\']:x"),a.push("!=",z)}),x=x.length&&new RegExp(x.join("|")),a=a.length&&new RegExp(a.join("|")),e=Z.test(n.compareDocumentPosition),_=e||Z.test(n.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(i.contains?i.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!f.sortDetached&&e.compareDocumentPosition(t)===i?t===h||t.ownerDocument===T&&_(T,t)?-1:e===h||e.ownerDocument===T&&_(T,e)?1:c?F(c,t)-F(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return l=!0,0;var i,r=0,n=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!n||!o)return t===h?-1:e===h?1:n?-1:o?1:c?F(c,t)-F(c,e):0;if(n===o)return ct(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)s.unshift(i);for(;a[r]===s[r];)r++;return r?ct(a[r],s[r]):a[r]===T?-1:s[r]===T?1:0},h):M},nt.matches=function(t,e){return nt(t,null,null,e)},nt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==M&&y(t),e=e.replace(W,"=\'$1\']"),f.matchesSelector&&v&&(!a||!a.test(e))&&(!x||!x.test(e)))try{var i=s.call(t,e);if(i||f.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return 0<nt(e,M,null,[t]).length},nt.contains=function(t,e){return(t.ownerDocument||t)!==M&&y(t),_(t,e)},nt.attr=function(t,e){(t.ownerDocument||t)!==M&&y(t);var i=b.attrHandle[e.toLowerCase()],r=i&&L.call(b.attrHandle,e.toLowerCase())?i(t,e,!v):void 0;return void 0!==r?r:f.attributes||!v?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},nt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},nt.uniqueSort=function(t){var e,i=[],r=0,n=0;if(l=!f.detectDuplicates,c=!f.sortStable&&t.slice(0),t.sort(A),l){for(;e=t[n++];)e===t[n]&&(r=i.push(n));for(;r--;)t.splice(i[r],1)}return c=null,t},o=nt.getText=function(t){var e,i="",r=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[r++];)i+=o(e);return i},(b=nt.selectors={cacheLength:50,createPseudo:at,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||nt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&nt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&X.test(i)&&(e=m(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=h[t+" "];return e||(e=new RegExp("(^|"+B+")"+t+"("+B+"|$)"))&&h(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(i,r,n){return function(t){var e=nt.attr(t,i);return null==e?"!="===r:!r||(e+="","="===r?e===n:"!="===r?e!==n:"^="===r?n&&0===e.indexOf(n):"*="===r?n&&-1<e.indexOf(n):"$="===r?n&&e.slice(-n.length)===n:"~="===r?-1<(" "+e.replace(I," ")+" ").indexOf(n):"|="===r&&(e===n||e.slice(0,n.length+1)===n+"-"))}},CHILD:function(d,t,e,f,m){var g="nth"!==d.slice(0,3),y="last"!==d.slice(-4),v="of-type"===t;return 1===f&&0===m?function(t){return!!t.parentNode}:function(t,e,i){var r,n,o,a,s,h,c=g!==y?"nextSibling":"previousSibling",l=t.parentNode,u=v&&t.nodeName.toLowerCase(),p=!i&&!v;if(l){if(g){for(;c;){for(o=t;o=o[c];)if(v?o.nodeName.toLowerCase()===u:1===o.nodeType)return!1;h=c="only"===d&&!h&&"nextSibling"}return!0}if(h=[y?l.firstChild:l.lastChild],y&&p){for(s=(r=(n=l[S]||(l[S]={}))[d]||[])[0]===C&&r[1],a=r[0]===C&&r[2],o=s&&l.childNodes[s];o=++s&&o&&o[c]||(a=s=0)||h.pop();)if(1===o.nodeType&&++a&&o===t){n[d]=[C,s,a];break}}else if(p&&(r=(t[S]||(t[S]={}))[d])&&r[0]===C)a=r[1];else for(;(o=++s&&o&&o[c]||(a=s=0)||h.pop())&&((v?o.nodeName.toLowerCase()!==u:1!==o.nodeType)||!++a||(p&&((o[S]||(o[S]={}))[d]=[C,a]),o!==t)););return(a-=m)===f||a%f==0&&0<=a/f}}},PSEUDO:function(t,o){var e,a=b.pseudos[t]||b.setFilters[t.toLowerCase()]||nt.error("unsupported pseudo: "+t);return a[S]?a(o):1<a.length?(e=[t,t,"",o],b.setFilters.hasOwnProperty(t.toLowerCase())?at(function(t,e){for(var i,r=a(t,o),n=r.length;n--;)t[i=F(t,r[n])]=!(e[i]=r[n])}):function(t){return a(t,0,e)}):a}},pseudos:{not:at(function(t){var r=[],n=[],s=u(t.replace(G,"$1"));return s[S]?at(function(t,e,i,r){for(var n,o=s(t,null,r,[]),a=t.length;a--;)(n=o[a])&&(t[a]=!(e[a]=n))}):function(t,e,i){return r[0]=t,s(r,null,i,n),r[0]=null,!n.pop()}}),has:at(function(e){return function(t){return 0<nt(e,t).length}}),contains:at(function(e){return e=e.replace(et,it),function(t){return-1<(t.textContent||t.innerText||o(t)).indexOf(e)}}),lang:at(function(i){return q.test(i||"")||nt.error("unsupported lang: "+i),i=i.replace(et,it).toLowerCase(),function(t){var e;do{if(e=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===n},focus:function(t){return t===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:pt(function(){return[0]}),last:pt(function(t,e){return[e-1]}),eq:pt(function(t,e,i){return[i<0?i+e:i]}),even:pt(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:pt(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:pt(function(t,e,i){for(var r=i<0?i+e:i;0<=--r;)t.push(r);return t}),gt:pt(function(t,e,i){for(var r=i<0?i+e:i;++r<e;)t.push(r);return t})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[t]=lt(t);for(t in{submit:!0,reset:!0})b.pseudos[t]=ut(t);function ft(){}function mt(t){for(var e=0,i=t.length,r="";e<i;e++)r+=t[e].value;return r}function gt(a,t,e){var s=t.dir,h=e&&"parentNode"===s,c=p++;return t.first?function(t,e,i){for(;t=t[s];)if(1===t.nodeType||h)return a(t,e,i)}:function(t,e,i){var r,n,o=[C,c];if(i){for(;t=t[s];)if((1===t.nodeType||h)&&a(t,e,i))return!0}else for(;t=t[s];)if(1===t.nodeType||h){if((r=(n=t[S]||(t[S]={}))[s])&&r[0]===C&&r[1]===c)return o[2]=r[2];if((n[s]=o)[2]=a(t,e,i))return!0}}}function yt(n){return 1<n.length?function(t,e,i){for(var r=n.length;r--;)if(!n[r](t,e,i))return!1;return!0}:n[0]}function vt(t,e,i,r,n){for(var o,a=[],s=0,h=t.length,c=null!=e;s<h;s++)(o=t[s])&&(i&&!i(o,r,n)||(a.push(o),c&&e.push(s)));return a}function xt(d,f,m,g,y,t){return g&&!g[S]&&(g=xt(g)),y&&!y[S]&&(y=xt(y,t)),at(function(t,e,i,r){var n,o,a,s=[],h=[],c=e.length,l=t||function(t,e,i){for(var r=0,n=e.length;r<n;r++)nt(t,e[r],i);return i}(f||"*",i.nodeType?[i]:i,[]),u=!d||!t&&f?l:vt(l,s,d,i,r),p=m?y||(t?d:c||g)?[]:e:u;if(m&&m(u,p,i,r),g)for(n=vt(p,h),g(n,[],i,r),o=n.length;o--;)(a=n[o])&&(p[h[o]]=!(u[h[o]]=a));if(t){if(y||d){if(y){for(n=[],o=p.length;o--;)(a=p[o])&&n.push(u[o]=a);y(null,p=[],n,r)}for(o=p.length;o--;)(a=p[o])&&-1<(n=y?F(t,a):s[o])&&(t[n]=!(e[n]=a))}}else p=vt(p===e?p.splice(c,p.length):p),y?y(null,e,p,r):R.apply(e,p)})}function bt(t){for(var n,e,i,r=t.length,o=b.relative[t[0].type],a=o||b.relative[" "],s=o?1:0,h=gt(function(t){return t===n},a,!0),c=gt(function(t){return-1<F(n,t)},a,!0),l=[function(t,e,i){var r=!o&&(i||e!==w)||((n=e).nodeType?h(t,e,i):c(t,e,i));return n=null,r}];s<r;s++)if(e=b.relative[t[s].type])l=[gt(yt(l),e)];else{if((e=b.filter[t[s].type].apply(null,t[s].matches))[S]){for(i=++s;i<r&&!b.relative[t[i].type];i++);return xt(1<s&&yt(l),1<s&&mt(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(G,"$1"),e,s<i&&bt(t.slice(s,i)),i<r&&bt(t=t.slice(i)),i<r&&mt(t))}l.push(e)}return yt(l)}return ft.prototype=b.filters=b.pseudos,b.setFilters=new ft,m=nt.tokenize=function(t,e){var i,r,n,o,a,s,h,c=d[t+" "];if(c)return e?0:c.slice(0);for(a=t,s=[],h=b.preFilter;a;){for(o in i&&!(r=j.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(n=[])),i=!1,(r=H.exec(a))&&(i=r.shift(),n.push({value:i,type:r[0].replace(G," ")}),a=a.slice(i.length)),b.filter)!(r=Y[o].exec(a))||h[o]&&!(r=h[o](r))||(i=r.shift(),n.push({value:i,type:o,matches:r}),a=a.slice(i.length));if(!i)break}return e?a.length:a?nt.error(t):d(t,s).slice(0)},u=nt.compile=function(t,e){var i,g,y,v,x,r,n=[],o=[],a=E[t+" "];if(!a){for(e||(e=m(t)),i=e.length;i--;)(a=bt(e[i]))[S]?n.push(a):o.push(a);(a=E(t,(g=o,v=0<(y=n).length,x=0<g.length,r=function(t,e,i,r,n){var o,a,s,h=0,c="0",l=t&&[],u=[],p=w,d=t||x&&b.find.TAG("*",n),f=C+=null==p?1:Math.random()||.1,m=d.length;for(n&&(w=e!==M&&e);c!==m&&null!=(o=d[c]);c++){if(x&&o){for(a=0;s=g[a++];)if(s(o,e,i)){r.push(o);break}n&&(C=f)}v&&((o=!s&&o)&&h--,t&&l.push(o))}if(h+=c,v&&c!==h){for(a=0;s=y[a++];)s(l,u,e,i);if(t){if(0<h)for(;c--;)l[c]||u[c]||(u[c]=P.call(r));u=vt(u)}R.apply(r,u),n&&!t&&0<u.length&&1<h+y.length&&nt.uniqueSort(r)}return n&&(C=f,w=p),l},v?at(r):r))).selector=t}return a},g=nt.select=function(t,e,i,r){var n,o,a,s,h,c="function"==typeof t&&t,l=!r&&m(t=c.selector||t);if(i=i||[],1===l.length){if(2<(o=l[0]=l[0].slice(0)).length&&"ID"===(a=o[0]).type&&f.getById&&9===e.nodeType&&v&&b.relative[o[1].type]){if(!(e=(b.find.ID(a.matches[0].replace(et,it),e)||[])[0]))return i;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(n=Y.needsContext.test(t)?0:o.length;n--&&(a=o[n],!b.relative[s=a.type]);)if((h=b.find[s])&&(r=h(a.matches[0].replace(et,it),$.test(o[0].type)&&dt(e.parentNode)||e))){if(o.splice(n,1),!(t=r.length&&mt(o)))return R.apply(i,r),i;break}}return(c||u(t,l))(r,e,!v,i,$.test(t)&&dt(e.parentNode)||e),i},f.sortStable=S.split("").sort(A).join("")===S,f.detectDuplicates=!!l,y(),f.sortDetached=st(function(t){return 1&t.compareDocumentPosition(M.createElement("div"))}),st(function(t){return t.innerHTML="<a href=\'#\'></a>","#"===t.firstChild.getAttribute("href")})||ht("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),f.attributes&&st(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ht("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),st(function(t){return null==t.getAttribute("disabled")})||ht(O,function(t,e,i){var r;if(!i)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),nt}(f);_.find=p,_.expr=p.selectors,_.expr[":"]=_.expr.pseudos,_.unique=p.uniqueSort,_.text=p.getText,_.isXMLDoc=p.isXML,_.contains=p.contains;var d=_.expr.match.needsContext,x=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,b=/^.[^:#\\[\\.,]*$/;function w(t,i,r){if(_.isFunction(i))return _.grep(t,function(t,e){return!!i.call(t,e,t)!==r});if(i.nodeType)return _.grep(t,function(t){return t===i!==r});if("string"==typeof i){if(b.test(i))return _.filter(i,t,r);i=_.filter(i,t)}return _.grep(t,function(t){return 0<=n.call(i,t)!==r})}_.filter=function(t,e,i){var r=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?_.find.matchesSelector(r,t)?[r]:[]:_.find.matches(t,_.grep(e,function(t){return 1===t.nodeType}))},_.fn.extend({find:function(t){var e,i=this.length,r=[],n=this;if("string"!=typeof t)return this.pushStack(_(t).filter(function(){for(e=0;e<i;e++)if(_.contains(n[e],this))return!0}));for(e=0;e<i;e++)_.find(t,n[e],r);return(r=this.pushStack(1<i?_.unique(r):r)).selector=this.selector?this.selector+" "+t:t,r},filter:function(t){return this.pushStack(w(this,t||[],!1))},not:function(t){return this.pushStack(w(this,t||[],!0))},is:function(t){return!!w(this,"string"==typeof t&&d.test(t)?_(t):t||[],!1).length}});var M,S=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/;(_.fn.init=function(t,e){var i,r;if(!t)return this;if("string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):_.isFunction(t)?void 0!==M.ready?M.ready(t):t(_):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),_.makeArray(t,this));if(!(i="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:S.exec(t))||!i[1]&&e)return!e||e.jquery?(e||M).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof _?e[0]:e,_.merge(this,_.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:v,!0)),x.test(i[1])&&_.isPlainObject(e))for(i in e)_.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=v.getElementById(i[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=v,this.selector=t,this}).prototype=_.fn,M=_(v);var T=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};function E(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}_.extend({dir:function(t,e,i){for(var r=[],n=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(n&&_(t).is(i))break;r.push(t)}return r},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),_.fn.extend({has:function(t){var e=_(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(_.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,r=0,n=this.length,o=[],a=d.test(t)||"string"!=typeof t?_(t,e||this.context):0;r<n;r++)for(i=this[r];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&_.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(1<o.length?_.unique(o):o)},index:function(t){return t?"string"==typeof t?n.call(_(t),this[0]):n.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(_.unique(_.merge(this.get(),_(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),_.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return _.dir(t,"parentNode")},parentsUntil:function(t,e,i){return _.dir(t,"parentNode",i)},next:function(t){return E(t,"nextSibling")},prev:function(t){return E(t,"previousSibling")},nextAll:function(t){return _.dir(t,"nextSibling")},prevAll:function(t){return _.dir(t,"previousSibling")},nextUntil:function(t,e,i){return _.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return _.dir(t,"previousSibling",i)},siblings:function(t){return _.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return _.sibling(t.firstChild)},contents:function(t){return t.contentDocument||_.merge([],t.childNodes)}},function(r,n){_.fn[r]=function(t,e){var i=_.map(this,n,t);return"Until"!==r.slice(-5)&&(e=t),e&&"string"==typeof e&&(i=_.filter(e,i)),1<this.length&&(C[r]||_.unique(i),T.test(r)&&i.reverse()),this.pushStack(i)}});var A,L=/\\S+/g,P={};function k(){v.removeEventListener("DOMContentLoaded",k,!1),f.removeEventListener("load",k,!1),_.ready()}_.Callbacks=function(n){var t,i;n="string"==typeof n?P[n]||(i=P[t=n]={},_.each(t.match(L)||[],function(t,e){i[e]=!0}),i):_.extend({},n);var e,r,o,a,s,h,c=[],l=!n.once&&[],u=function(t){for(e=n.memory&&t,r=!0,h=a||0,a=0,s=c.length,o=!0;c&&h<s;h++)if(!1===c[h].apply(t[0],t[1])&&n.stopOnFalse){e=!1;break}o=!1,c&&(l?l.length&&u(l.shift()):e?c=[]:p.disable())},p={add:function(){if(c){var t=c.length;!function r(t){_.each(t,function(t,e){var i=_.type(e);"function"===i?n.unique&&p.has(e)||c.push(e):e&&e.length&&"string"!==i&&r(e)})}(arguments),o?s=c.length:e&&(a=t,u(e))}return this},remove:function(){return c&&_.each(arguments,function(t,e){for(var i;-1<(i=_.inArray(e,c,i));)c.splice(i,1),o&&(i<=s&&s--,i<=h&&h--)}),this},has:function(t){return t?-1<_.inArray(t,c):!(!c||!c.length)},empty:function(){return c=[],s=0,this},disable:function(){return c=l=e=void 0,this},disabled:function(){return!c},lock:function(){return l=void 0,e||p.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!c||r&&!l||(e=[t,(e=e||[]).slice?e.slice():e],o?l.push(e):u(e)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!r}};return p},_.extend({Deferred:function(t){var o=[["resolve","done",_.Callbacks("once memory"),"resolved"],["reject","fail",_.Callbacks("once memory"),"rejected"],["notify","progress",_.Callbacks("memory")]],n="pending",a={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var n=arguments;return _.Deferred(function(r){_.each(o,function(t,e){var i=_.isFunction(n[t])&&n[t];s[e[1]](function(){var t=i&&i.apply(this,arguments);t&&_.isFunction(t.promise)?t.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[e[0]+"With"](this===a?r.promise():this,i?[t]:arguments)})}),n=null}).promise()},promise:function(t){return null!=t?_.extend(t,a):a}},s={};return a.pipe=a.then,_.each(o,function(t,e){var i=e[2],r=e[3];a[e[1]]=i.add,r&&i.add(function(){n=r},o[1^t][2].disable,o[2][2].lock),s[e[0]]=function(){return s[e[0]+"With"](this===s?a:this,arguments),this},s[e[0]+"With"]=i.fireWith}),a.promise(s),t&&t.call(s,s),s},when:function(t){var n,e,i,r=0,o=l.call(arguments),a=o.length,s=1!==a||t&&_.isFunction(t.promise)?a:0,h=1===s?t:_.Deferred(),c=function(e,i,r){return function(t){i[e]=this,r[e]=1<arguments.length?l.call(arguments):t,r===n?h.notifyWith(i,r):--s||h.resolveWith(i,r)}};if(1<a)for(n=new Array(a),e=new Array(a),i=new Array(a);r<a;r++)o[r]&&_.isFunction(o[r].promise)?o[r].promise().done(c(r,i,o)).fail(h.reject).progress(c(r,e,n)):--s;return s||h.resolveWith(i,o),h.promise()}}),_.fn.ready=function(t){return _.ready.promise().done(t),this},_.extend({isReady:!1,readyWait:1,holdReady:function(t){t?_.readyWait++:_.ready(!0)},ready:function(t){(!0===t?--_.readyWait:_.isReady)||(_.isReady=!0)!==t&&0<--_.readyWait||(A.resolveWith(v,[_]),_.fn.triggerHandler&&(_(v).triggerHandler("ready"),_(v).off("ready")))}}),_.ready.promise=function(t){return A||(A=_.Deferred(),"complete"===v.readyState?setTimeout(_.ready):(v.addEventListener("DOMContentLoaded",k,!1),f.addEventListener("load",k,!1))),A.promise(t)},_.ready.promise();var R=_.access=function(t,e,i,r,n,o,a){var s=0,h=t.length,c=null==i;if("object"===_.type(i))for(s in n=!0,i)_.access(t,e,s,i[s],!0,o,a);else if(void 0!==r&&(n=!0,_.isFunction(r)||(a=!0),c&&(e=a?(e.call(t,r),null):(c=e,function(t,e,i){return c.call(_(t),i)})),e))for(;s<h;s++)e(t[s],i,a?r:r.call(t[s],s,e(t[s],i)));return n?t:c?e.call(t):h?e(t[0],i):o};function D(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=_.expando+D.uid++}_.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},D.uid=1,D.accepts=_.acceptData,D.prototype={key:function(e){if(!D.accepts(e))return 0;var i={},r=e[this.expando];if(!r){r=D.uid++;try{i[this.expando]={value:r},Object.defineProperties(e,i)}catch(t){i[this.expando]=r,_.extend(e,i)}}return this.cache[r]||(this.cache[r]={}),r},set:function(t,e,i){var r,n=this.key(t),o=this.cache[n];if("string"==typeof e)o[e]=i;else if(_.isEmptyObject(o))_.extend(this.cache[n],e);else for(r in e)o[r]=e[r];return o},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var r;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(r=this.get(t,e))?r:this.get(t,_.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,r,n,o=this.key(t),a=this.cache[o];if(void 0===e)this.cache[o]={};else{i=(r=_.isArray(e)?e.concat(e.map(_.camelCase)):(n=_.camelCase(e),e in a?[e,n]:(r=n)in a?[r]:r.match(L)||[])).length;for(;i--;)delete a[r[i]]}},hasData:function(t){return!_.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var F=new D,O=new D,B=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,U=/([A-Z])/g;function V(t,e,i){var r;if(void 0===i&&1===t.nodeType)if(r="data-"+e.replace(U,"-$1").toLowerCase(),"string"==typeof(i=t.getAttribute(r))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:B.test(i)?_.parseJSON(i):i)}catch(t){}O.set(t,e,i)}else i=void 0;return i}_.extend({hasData:function(t){return O.hasData(t)||F.hasData(t)},data:function(t,e,i){return O.access(t,e,i)},removeData:function(t,e){O.remove(t,e)},_data:function(t,e,i){return F.access(t,e,i)},_removeData:function(t,e){F.remove(t,e)}}),_.fn.extend({data:function(r,t){var e,i,n,o=this[0],a=o&&o.attributes;if(void 0!==r)return"object"==typeof r?this.each(function(){O.set(this,r)}):R(this,function(e){var t,i=_.camelCase(r);if(o&&void 0===e)return void 0!==(t=O.get(o,r))?t:void 0!==(t=O.get(o,i))?t:void 0!==(t=V(o,i,void 0))?t:void 0;this.each(function(){var t=O.get(this,i);O.set(this,i,e),-1!==r.indexOf("-")&&void 0!==t&&O.set(this,r,e)})},null,t,1<arguments.length,null,!0);if(this.length&&(n=O.get(o),1===o.nodeType&&!F.get(o,"hasDataAttrs"))){for(e=a.length;e--;)a[e]&&0===(i=a[e].name).indexOf("data-")&&(i=_.camelCase(i.slice(5)),V(o,i,n[i]));F.set(o,"hasDataAttrs",!0)}return n},removeData:function(t){return this.each(function(){O.remove(this,t)})}}),_.extend({queue:function(t,e,i){var r;if(t)return e=(e||"fx")+"queue",r=F.get(t,e),i&&(!r||_.isArray(i)?r=F.access(t,e,_.makeArray(i)):r.push(i)),r||[]},dequeue:function(t,e){e=e||"fx";var i=_.queue(t,e),r=i.length,n=i.shift(),o=_._queueHooks(t,e);"inprogress"===n&&(n=i.shift(),r--),n&&("fx"===e&&i.unshift("inprogress"),delete o.stop,n.call(t,function(){_.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return F.get(t,i)||F.access(t,i,{empty:_.Callbacks("once memory").add(function(){F.remove(t,[e+"queue",i])})})}}),_.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?_.queue(this[0],e):void 0===i?this:this.each(function(){var t=_.queue(this,e,i);_._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&_.dequeue(this,e)})},dequeue:function(t){return this.each(function(){_.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,r=1,n=_.Deferred(),o=this,a=this.length,s=function(){--r||n.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=F.get(o[a],t+"queueHooks"))&&i.empty&&(r++,i.empty.add(s));return s(),n.promise(e)}});var N,z,I=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,G=["Top","Right","Bottom","Left"],j=function(t,e){return t=e||t,"none"===_.css(t,"display")||!_.contains(t.ownerDocument,t)},H=/^(?:checkbox|radio)$/i;N=v.createDocumentFragment().appendChild(v.createElement("div")),(z=v.createElement("input")).setAttribute("type","radio"),z.setAttribute("checked","checked"),z.setAttribute("name","t"),N.appendChild(z),y.checkClone=N.cloneNode(!0).cloneNode(!0).lastChild.checked,N.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!N.cloneNode(!0).lastChild.defaultValue;var W="undefined";y.focusinBubbles="onfocusin"in f;var X=/^key/,q=/^(?:mouse|pointer|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,K=/^([^.]*)(?:\\.(.+)|)$/;function Q(){return!0}function Z(){return!1}function J(){try{return v.activeElement}catch(t){}}_.event={global:{},add:function(e,t,i,r,n){var o,a,s,h,c,l,u,p,d,f,m,g=F.get(e);if(g)for(i.handler&&(i=(o=i).handler,n=o.selector),i.guid||(i.guid=_.guid++),(h=g.events)||(h=g.events={}),(a=g.handle)||(a=g.handle=function(t){return typeof _!==W&&_.event.triggered!==t.type?_.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(L)||[""]).length;c--;)d=m=(s=K.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),d&&(u=_.event.special[d]||{},d=(n?u.delegateType:u.bindType)||d,u=_.event.special[d]||{},l=_.extend({type:d,origType:m,data:r,handler:i,guid:i.guid,selector:n,needsContext:n&&_.expr.match.needsContext.test(n),namespace:f.join(".")},o),(p=h[d])||((p=h[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,r,f,a)||e.addEventListener&&e.addEventListener(d,a,!1)),u.add&&(u.add.call(e,l),l.handler.guid||(l.handler.guid=i.guid)),n?p.splice(p.delegateCount++,0,l):p.push(l),_.event.global[d]=!0)},remove:function(t,e,i,r,n){var o,a,s,h,c,l,u,p,d,f,m,g=F.hasData(t)&&F.get(t);if(g&&(h=g.events)){for(c=(e=(e||"").match(L)||[""]).length;c--;)if(d=m=(s=K.exec(e[c])||[])[1],f=(s[2]||"").split(".").sort(),d){for(u=_.event.special[d]||{},p=h[d=(r?u.delegateType:u.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\\\.)"+f.join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"),a=o=p.length;o--;)l=p[o],!n&&m!==l.origType||i&&i.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(p.splice(o,1),l.selector&&p.delegateCount--,u.remove&&u.remove.call(t,l));a&&!p.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||_.removeEvent(t,d,g.handle),delete h[d])}else for(d in h)_.event.remove(t,d+e[c],i,r,!0);_.isEmptyObject(h)&&(delete g.handle,F.remove(t,"events"))}},trigger:function(t,e,i,r){var n,o,a,s,h,c,l,u=[i||v],p=g.call(t,"type")?t.type:t,d=g.call(t,"namespace")?t.namespace.split("."):[];if(o=a=i=i||v,3!==i.nodeType&&8!==i.nodeType&&!Y.test(p+_.event.triggered)&&(0<=p.indexOf(".")&&(p=(d=p.split(".")).shift(),d.sort()),h=p.indexOf(":")<0&&"on"+p,(t=t[_.expando]?t:new _.Event(p,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=d.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\\\.)"+d.join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:_.makeArray(e,[t]),l=_.event.special[p]||{},r||!l.trigger||!1!==l.trigger.apply(i,e))){if(!r&&!l.noBubble&&!_.isWindow(i)){for(s=l.delegateType||p,Y.test(s+p)||(o=o.parentNode);o;o=o.parentNode)u.push(o),a=o;a===(i.ownerDocument||v)&&u.push(a.defaultView||a.parentWindow||f)}for(n=0;(o=u[n++])&&!t.isPropagationStopped();)t.type=1<n?s:l.bindType||p,(c=(F.get(o,"events")||{})[t.type]&&F.get(o,"handle"))&&c.apply(o,e),(c=h&&o[h])&&c.apply&&_.acceptData(o)&&(t.result=c.apply(o,e),!1===t.result&&t.preventDefault());return t.type=p,r||t.isDefaultPrevented()||l._default&&!1!==l._default.apply(u.pop(),e)||!_.acceptData(i)||h&&_.isFunction(i[p])&&!_.isWindow(i)&&((a=i[h])&&(i[h]=null),i[_.event.triggered=p](),_.event.triggered=void 0,a&&(i[h]=a)),t.result}},dispatch:function(t){t=_.event.fix(t);var e,i,r,n,o,a,s=l.call(arguments),h=(F.get(this,"events")||{})[t.type]||[],c=_.event.special[t.type]||{};if((s[0]=t).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=_.event.handlers.call(this,t,h),e=0;(n=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=n.elem,i=0;(o=n.handlers[i++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(r=((_.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,s))&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,r,n,o,a=[],s=e.delegateCount,h=t.target;if(s&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!==this;h=h.parentNode||this)if(!0!==h.disabled||"click"!==t.type){for(r=[],i=0;i<s;i++)void 0===r[n=(o=e[i]).selector+" "]&&(r[n]=o.needsContext?0<=_(n,this).index(h):_.find(n,this,null,[h]).length),r[n]&&r.push(o);r.length&&a.push({elem:h,handlers:r})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,r,n,o=e.button;return null==t.pageX&&null!=e.clientX&&(r=(i=t.target.ownerDocument||v).documentElement,n=i.body,t.pageX=e.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[_.expando])return t;var e,i,r,n=t.type,o=t,a=this.fixHooks[n];for(a||(this.fixHooks[n]=a=q.test(n)?this.mouseHooks:X.test(n)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,t=new _.Event(o),e=r.length;e--;)t[i=r[e]]=o[i];return t.target||(t.target=v),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==J()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===J()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&_.nodeName(this,"input"))return this.click(),!1},_default:function(t){return _.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,r){var n=_.extend(new _.Event,i,{type:t,isSimulated:!0,originalEvent:{}});r?_.event.trigger(n,null,e):_.event.dispatch.call(e,n),n.isDefaultPrevented()&&i.preventDefault()}},_.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},_.Event=function(t,e){if(!(this instanceof _.Event))return new _.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Q:Z):this.type=t,e&&_.extend(this,e),this.timeStamp=t&&t.timeStamp||_.now(),this[_.expando]=!0},_.Event.prototype={isDefaultPrevented:Z,isPropagationStopped:Z,isImmediatePropagationStopped:Z,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Q,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Q,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Q,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},_.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,n){_.event.special[t]={delegateType:n,bindType:n,handle:function(t){var e,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||_.contains(this,i))||(t.type=r.origType,e=r.handler.apply(this,arguments),t.type=n),e}}}),y.focusinBubbles||_.each({focus:"focusin",blur:"focusout"},function(i,r){var n=function(t){_.event.simulate(r,t.target,_.event.fix(t),!0)};_.event.special[r]={setup:function(){var t=this.ownerDocument||this,e=F.access(t,r);e||t.addEventListener(i,n,!0),F.access(t,r,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=F.access(t,r)-1;e?F.access(t,r,e):(t.removeEventListener(i,n,!0),F.remove(t,r))}}}),_.fn.extend({on:function(t,e,i,r,n){var o,a;if("object"==typeof t){for(a in"string"!=typeof e&&(i=i||e,e=void 0),t)this.on(a,e,i,t[a],n);return this}if(null==i&&null==r?(r=e,i=e=void 0):null==r&&("string"==typeof e?(r=i,i=void 0):(r=i,i=e,e=void 0)),!1===r)r=Z;else if(!r)return this;return 1===n&&(o=r,(r=function(t){return _().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=_.guid++)),this.each(function(){_.event.add(this,t,r,i,e)})},one:function(t,e,i,r){return this.on(t,e,i,r,1)},off:function(t,e,i){var r,n;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,_(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=Z),this.each(function(){_.event.remove(this,t,i,e)});for(n in t)this.off(n,e,t[n]);return this},trigger:function(t,e){return this.each(function(){_.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return _.event.trigger(t,e,i,!0)}});var $=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,tt=/<([\\w:]+)/,et=/<|&#?\\w+;/,it=/<(?:script|style|link)/i,rt=/checked\\s*(?:[^=]|=\\s*.checked.)/i,nt=/^$|\\/(?:java|ecma)script/i,ot=/^true\\/(.*)/,at=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,st={option:[1,"<select multiple=\'multiple\'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ht(t,e){return _.nodeName(t,"table")&&_.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function ct(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function lt(t){var e=ot.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function ut(t,e){for(var i=0,r=t.length;i<r;i++)F.set(t[i],"globalEval",!e||F.get(e[i],"globalEval"))}function pt(t,e){var i,r,n,o,a,s,h,c;if(1===e.nodeType){if(F.hasData(t)&&(o=F.access(t),a=F.set(e,o),c=o.events))for(n in delete a.handle,a.events={},c)for(i=0,r=c[n].length;i<r;i++)_.event.add(e,n,c[n][i]);O.hasData(t)&&(s=O.access(t),h=_.extend({},s),O.set(e,h))}}function dt(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&_.nodeName(t,e)?_.merge([t],i):i}st.optgroup=st.option,st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td,_.extend({clone:function(t,e,i){var r,n,o,a,s,h,c,l=t.cloneNode(!0),u=_.contains(t.ownerDocument,t);if(!(y.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||_.isXMLDoc(t)))for(a=dt(l),r=0,n=(o=dt(t)).length;r<n;r++)s=o[r],h=a[r],void 0,"input"===(c=h.nodeName.toLowerCase())&&H.test(s.type)?h.checked=s.checked:"input"!==c&&"textarea"!==c||(h.defaultValue=s.defaultValue);if(e)if(i)for(o=o||dt(t),a=a||dt(l),r=0,n=o.length;r<n;r++)pt(o[r],a[r]);else pt(t,l);return 0<(a=dt(l,"script")).length&&ut(a,!u&&dt(t,"script")),l},buildFragment:function(t,e,i,r){for(var n,o,a,s,h,c,l=e.createDocumentFragment(),u=[],p=0,d=t.length;p<d;p++)if((n=t[p])||0===n)if("object"===_.type(n))_.merge(u,n.nodeType?[n]:n);else if(et.test(n)){for(o=o||l.appendChild(e.createElement("div")),a=(tt.exec(n)||["",""])[1].toLowerCase(),s=st[a]||st._default,o.innerHTML=s[1]+n.replace($,"<$1></$2>")+s[2],c=s[0];c--;)o=o.lastChild;_.merge(u,o.childNodes),(o=l.firstChild).textContent=""}else u.push(e.createTextNode(n));for(l.textContent="",p=0;n=u[p++];)if((!r||-1===_.inArray(n,r))&&(h=_.contains(n.ownerDocument,n),o=dt(l.appendChild(n),"script"),h&&ut(o),i))for(c=0;n=o[c++];)nt.test(n.type||"")&&i.push(n);return l},cleanData:function(t){for(var e,i,r,n,o=_.event.special,a=0;void 0!==(i=t[a]);a++){if(_.acceptData(i)&&(n=i[F.expando])&&(e=F.cache[n])){if(e.events)for(r in e.events)o[r]?_.event.remove(i,r):_.removeEvent(i,r,e.handle);F.cache[n]&&delete F.cache[n]}delete O.cache[i[O.expando]]}}}),_.fn.extend({text:function(t){return R(this,function(t){return void 0===t?_.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ht(this,t).appendChild(t)})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=ht(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,r=t?_.filter(t,this):this,n=0;null!=(i=r[n]);n++)e||1!==i.nodeType||_.cleanData(dt(i)),i.parentNode&&(e&&_.contains(i.ownerDocument,i)&&ut(dt(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(_.cleanData(dt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return _.clone(this,t,e)})},html:function(t){return R(this,function(t){var e=this[0]||{},i=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!it.test(t)&&!st[(tt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace($,"<$1></$2>");try{for(;i<r;i++)1===(e=this[i]||{}).nodeType&&(_.cleanData(dt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,_.cleanData(dt(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(i,r){i=m.apply([],i);var t,e,n,o,a,s,h=0,c=this.length,l=this,u=c-1,p=i[0],d=_.isFunction(p);if(d||1<c&&"string"==typeof p&&!y.checkClone&&rt.test(p))return this.each(function(t){var e=l.eq(t);d&&(i[0]=p.call(this,t,e.html())),e.domManip(i,r)});if(c&&(e=(t=_.buildFragment(i,this[0].ownerDocument,!1,this)).firstChild,1===t.childNodes.length&&(t=e),e)){for(o=(n=_.map(dt(t,"script"),ct)).length;h<c;h++)a=t,h!==u&&(a=_.clone(a,!0,!0),o&&_.merge(n,dt(a,"script"))),r.call(this[h],a,h);if(o)for(s=n[n.length-1].ownerDocument,_.map(n,lt),h=0;h<o;h++)a=n[h],nt.test(a.type||"")&&!F.access(a,"globalEval")&&_.contains(s,a)&&(a.src?_._evalUrl&&_._evalUrl(a.src):_.globalEval(a.textContent.replace(at,"")))}return this}}),_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){_.fn[t]=function(t){for(var e,i=[],r=_(t),n=r.length-1,o=0;o<=n;o++)e=o===n?this:this.clone(!0),_(r[o])[a](e),s.apply(i,e.get());return this.pushStack(i)}});var ft,mt={};function gt(t,e){var i,r=_(e.createElement(t)).appendTo(e.body),n=f.getDefaultComputedStyle&&(i=f.getDefaultComputedStyle(r[0]))?i.display:_.css(r[0],"display");return r.detach(),n}function yt(t){var e=v,i=mt[t];return i||("none"!==(i=gt(t,e))&&i||((e=(ft=(ft||_("<iframe frameborder=\'0\' width=\'0\' height=\'0\'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=gt(t,e),ft.detach()),mt[t]=i),i}var vt=/^margin/,xt=new RegExp("^("+I+")(?!px)[a-z%]+$","i"),bt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):f.getComputedStyle(t,null)};function wt(t,e,i){var r,n,o,a,s=t.style;return(i=i||bt(t))&&(a=i.getPropertyValue(e)||i[e]),i&&(""!==a||_.contains(t.ownerDocument,t)||(a=_.style(t,e)),xt.test(a)&&vt.test(e)&&(r=s.width,n=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=r,s.minWidth=n,s.maxWidth=o)),void 0!==a?a+"":a}function Mt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){var e,i,r=v.documentElement,n=v.createElement("div"),o=v.createElement("div");function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",r.appendChild(n);var t=f.getComputedStyle(o,null);e="1%"!==t.top,i="4px"===t.width,r.removeChild(n)}o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===o.style.backgroundClip,n.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",n.appendChild(o),f.getComputedStyle&&_.extend(y,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,e=o.appendChild(v.createElement("div"));return e.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",o.style.width="1px",r.appendChild(n),t=!parseFloat(f.getComputedStyle(e,null).marginRight),r.removeChild(n),o.removeChild(e),t}}))}(),_.swap=function(t,e,i,r){var n,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in n=i.apply(t,r||[]),e)t.style[o]=a[o];return n};var _t=/^(none|table(?!-c[ea]).+)/,St=new RegExp("^("+I+")(.*)$","i"),Tt=new RegExp("^([+-])=("+I+")","i"),Ct={position:"absolute",visibility:"hidden",display:"block"},Et={letterSpacing:"0",fontWeight:"400"},At=["Webkit","O","Moz","ms"];function Lt(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),r=e,n=At.length;n--;)if((e=At[n]+i)in t)return e;return r}function Pt(t,e,i){var r=St.exec(e);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):e}function kt(t,e,i,r,n){for(var o=i===(r?"border":"content")?4:"width"===e?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=_.css(t,i+G[o],!0,n)),r?("content"===i&&(a-=_.css(t,"padding"+G[o],!0,n)),"margin"!==i&&(a-=_.css(t,"border"+G[o]+"Width",!0,n))):(a+=_.css(t,"padding"+G[o],!0,n),"padding"!==i&&(a+=_.css(t,"border"+G[o]+"Width",!0,n)));return a}function Rt(t,e,i){var r=!0,n="width"===e?t.offsetWidth:t.offsetHeight,o=bt(t),a="border-box"===_.css(t,"boxSizing",!1,o);if(n<=0||null==n){if(((n=wt(t,e,o))<0||null==n)&&(n=t.style[e]),xt.test(n))return n;r=a&&(y.boxSizingReliable()||n===t.style[e]),n=parseFloat(n)||0}return n+kt(t,e,i||(a?"border":"content"),r,o)+"px"}function Dt(t,e){for(var i,r,n,o=[],a=0,s=t.length;a<s;a++)(r=t[a]).style&&(o[a]=F.get(r,"olddisplay"),i=r.style.display,e?(o[a]||"none"!==i||(r.style.display=""),""===r.style.display&&j(r)&&(o[a]=F.access(r,"olddisplay",yt(r.nodeName)))):(n=j(r),"none"===i&&n||F.set(r,"olddisplay",n?i:_.css(r,"display"))));for(a=0;a<s;a++)(r=t[a]).style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?o[a]||"":"none"));return t}function Ft(t,e,i,r,n){return new Ft.prototype.init(t,e,i,r,n)}_.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=wt(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n,o,a,s=_.camelCase(e),h=t.style;if(e=_.cssProps[s]||(_.cssProps[s]=Lt(h,s)),a=_.cssHooks[e]||_.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(n=a.get(t,!1,r))?n:h[e];"string"===(o=typeof i)&&(n=Tt.exec(i))&&(i=(n[1]+1)*n[2]+parseFloat(_.css(t,e)),o="number"),null!=i&&i==i&&("number"!==o||_.cssNumber[s]||(i+="px"),y.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,r))||(h[e]=i))}},css:function(t,e,i,r){var n,o,a,s=_.camelCase(e);return e=_.cssProps[s]||(_.cssProps[s]=Lt(t.style,s)),(a=_.cssHooks[e]||_.cssHooks[s])&&"get"in a&&(n=a.get(t,!0,i)),void 0===n&&(n=wt(t,e,r)),"normal"===n&&e in Et&&(n=Et[e]),""===i||i?(o=parseFloat(n),!0===i||_.isNumeric(o)?o||0:n):n}}),_.each(["height","width"],function(t,n){_.cssHooks[n]={get:function(t,e,i){if(e)return _t.test(_.css(t,"display"))&&0===t.offsetWidth?_.swap(t,Ct,function(){return Rt(t,n,i)}):Rt(t,n,i)},set:function(t,e,i){var r=i&&bt(t);return Pt(0,e,i?kt(t,n,i,"border-box"===_.css(t,"boxSizing",!1,r),r):0)}}}),_.cssHooks.marginRight=Mt(y.reliableMarginRight,function(t,e){if(e)return _.swap(t,{display:"inline-block"},wt,[t,"marginRight"])}),_.each({margin:"",padding:"",border:"Width"},function(n,o){_.cssHooks[n+o]={expand:function(t){for(var e=0,i={},r="string"==typeof t?t.split(" "):[t];e<4;e++)i[n+G[e]+o]=r[e]||r[e-2]||r[0];return i}},vt.test(n)||(_.cssHooks[n+o].set=Pt)}),_.fn.extend({css:function(t,e){return R(this,function(t,e,i){var r,n,o={},a=0;if(_.isArray(e)){for(r=bt(t),n=e.length;a<n;a++)o[e[a]]=_.css(t,e[a],!1,r);return o}return void 0!==i?_.style(t,e,i):_.css(t,e)},t,e,1<arguments.length)},show:function(){return Dt(this,!0)},hide:function(){return Dt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){j(this)?_(this).show():_(this).hide()})}}),((_.Tween=Ft).prototype={constructor:Ft,init:function(t,e,i,r,n,o){this.elem=t,this.prop=i,this.easing=n||"swing",this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(_.cssNumber[i]?"":"px")},cur:function(){var t=Ft.propHooks[this.prop];return t&&t.get?t.get(this):Ft.propHooks._default.get(this)},run:function(t){var e,i=Ft.propHooks[this.prop];return this.options.duration?this.pos=e=_.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ft.propHooks._default.set(this),this}}).init.prototype=Ft.prototype,(Ft.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=_.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){_.fx.step[t.prop]?_.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[_.cssProps[t.prop]]||_.cssHooks[t.prop])?_.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}}).scrollTop=Ft.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},_.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},_.fx=Ft.prototype.init,_.fx.step={};var Ot,Bt,Ut,Vt,Nt,zt=/^(?:toggle|show|hide)$/,It=new RegExp("^(?:([+-])=|)("+I+")([a-z%]*)$","i"),Gt=/queueHooks$/,jt=[function(e,t,i){var r,n,o,a,s,h,c,l=this,u={},p=e.style,d=e.nodeType&&j(e),f=F.get(e,"fxshow");i.queue||(null==(s=_._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,h=s.empty.fire,s.empty.fire=function(){s.unqueued||h()}),s.unqueued++,l.always(function(){l.always(function(){s.unqueued--,_.queue(e,"fx").length||s.empty.fire()})}));1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],c=_.css(e,"display"),"inline"===("none"===c?F.get(e,"olddisplay")||yt(e.nodeName):c)&&"none"===_.css(e,"float")&&(p.display="inline-block"));i.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(r in t)if(n=t[r],zt.exec(n)){if(delete t[r],o=o||"toggle"===n,n===(d?"hide":"show")){if("show"!==n||!f||void 0===f[r])continue;d=!0}u[r]=f&&f[r]||_.style(e,r)}else c=void 0;if(_.isEmptyObject(u))"inline"===("none"===c?yt(e.nodeName):c)&&(p.display=c);else for(r in f?"hidden"in f&&(d=f.hidden):f=F.access(e,"fxshow",{}),o&&(f.hidden=!d),d?_(e).show():l.done(function(){_(e).hide()}),l.done(function(){var t;for(t in F.remove(e,"fxshow"),u)_.style(e,t,u[t])}),u)a=qt(d?f[r]:0,r,l),r in f||(f[r]=a.start,d&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}],Ht={"*":[function(t,e){var i=this.createTween(t,e),r=i.cur(),n=It.exec(e),o=n&&n[3]||(_.cssNumber[t]?"":"px"),a=(_.cssNumber[t]||"px"!==o&&+r)&&It.exec(_.css(i.elem,t)),s=1,h=20;if(a&&a[3]!==o)for(o=o||a[3],n=n||[],a=+r||1;a/=s=s||".5",_.style(i.elem,t,a+o),s!==(s=i.cur()/r)&&1!==s&&--h;);return n&&(a=i.start=+a||+r||0,i.unit=o,i.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),i}]};function Wt(){return setTimeout(function(){Ot=void 0}),Ot=_.now()}function Xt(t,e){var i,r=0,n={height:t};for(e=e?1:0;r<4;r+=2-e)n["margin"+(i=G[r])]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function qt(t,e,i){for(var r,n=(Ht[e]||[]).concat(Ht["*"]),o=0,a=n.length;o<a;o++)if(r=n[o].call(i,e,t))return r}function Yt(o,t,e){var i,a,r=0,n=jt.length,s=_.Deferred().always(function(){delete h.elem}),h=function(){if(a)return!1;for(var t=Ot||Wt(),e=Math.max(0,c.startTime+c.duration-t),i=1-(e/c.duration||0),r=0,n=c.tweens.length;r<n;r++)c.tweens[r].run(i);return s.notifyWith(o,[c,i,e]),i<1&&n?e:(s.resolveWith(o,[c]),!1)},c=s.promise({elem:o,props:_.extend({},t),opts:_.extend(!0,{specialEasing:{}},e),originalProperties:t,originalOptions:e,startTime:Ot||Wt(),duration:e.duration,tweens:[],createTween:function(t,e){var i=_.Tween(o,c.opts,t,e,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var e=0,i=t?c.tweens.length:0;if(a)return this;for(a=!0;e<i;e++)c.tweens[e].run(1);return t?s.resolveWith(o,[c,t]):s.rejectWith(o,[c,t]),this}}),l=c.props;for(!function(t,e){var i,r,n,o,a;for(i in t)if(n=e[r=_.camelCase(i)],o=t[i],_.isArray(o)&&(n=o[1],o=t[i]=o[0]),i!==r&&(t[r]=o,delete t[i]),(a=_.cssHooks[r])&&"expand"in a)for(i in o=a.expand(o),delete t[r],o)i in t||(t[i]=o[i],e[i]=n);else e[r]=n}(l,c.opts.specialEasing);r<n;r++)if(i=jt[r].call(c,o,l,c.opts))return i;return _.map(l,qt,c),_.isFunction(c.opts.start)&&c.opts.start.call(o,c),_.fx.timer(_.extend(h,{elem:o,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}_.Animation=_.extend(Yt,{tweener:function(t,e){for(var i,r=0,n=(t=_.isFunction(t)?(e=t,["*"]):t.split(" ")).length;r<n;r++)i=t[r],Ht[i]=Ht[i]||[],Ht[i].unshift(e)},prefilter:function(t,e){e?jt.unshift(t):jt.push(t)}}),_.speed=function(t,e,i){var r=t&&"object"==typeof t?_.extend({},t):{complete:i||!i&&e||_.isFunction(t)&&t,duration:t,easing:i&&e||e&&!_.isFunction(e)&&e};return r.duration=_.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in _.fx.speeds?_.fx.speeds[r.duration]:_.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){_.isFunction(r.old)&&r.old.call(this),r.queue&&_.dequeue(this,r.queue)},r},_.fn.extend({fadeTo:function(t,e,i,r){return this.filter(j).css("opacity",0).show().end().animate({opacity:e},t,i,r)},animate:function(e,t,i,r){var n=_.isEmptyObject(e),o=_.speed(t,i,r),a=function(){var t=Yt(this,_.extend({},e),o);(n||F.get(this,"finish"))&&t.stop(!0)};return a.finish=a,n||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(n,t,o){var a=function(t){var e=t.stop;delete t.stop,e(o)};return"string"!=typeof n&&(o=t,t=n,n=void 0),t&&!1!==n&&this.queue(n||"fx",[]),this.each(function(){var t=!0,e=null!=n&&n+"queueHooks",i=_.timers,r=F.get(this);if(e)r[e]&&r[e].stop&&a(r[e]);else for(e in r)r[e]&&r[e].stop&&Gt.test(e)&&a(r[e]);for(e=i.length;e--;)i[e].elem!==this||null!=n&&i[e].queue!==n||(i[e].anim.stop(o),t=!1,i.splice(e,1));!t&&o||_.dequeue(this,n)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=F.get(this),i=e[a+"queue"],r=e[a+"queueHooks"],n=_.timers,o=i?i.length:0;for(e.finish=!0,_.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),t=n.length;t--;)n[t].elem===this&&n[t].queue===a&&(n[t].anim.stop(!0),n.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),_.each(["toggle","show","hide"],function(t,r){var n=_.fn[r];_.fn[r]=function(t,e,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(Xt(r,!0),t,e,i)}}),_.each({slideDown:Xt("show"),slideUp:Xt("hide"),slideToggle:Xt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,r){_.fn[t]=function(t,e,i){return this.animate(r,t,e,i)}}),_.timers=[],_.fx.tick=function(){var t,e=0,i=_.timers;for(Ot=_.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||_.fx.stop(),Ot=void 0},_.fx.timer=function(t){_.timers.push(t),t()?_.fx.start():_.timers.pop()},_.fx.interval=13,_.fx.start=function(){Bt||(Bt=setInterval(_.fx.tick,_.fx.interval))},_.fx.stop=function(){clearInterval(Bt),Bt=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fn.delay=function(r,t){return r=_.fx&&_.fx.speeds[r]||r,t=t||"fx",this.queue(t,function(t,e){var i=setTimeout(t,r);e.stop=function(){clearTimeout(i)}})},Ut=v.createElement("input"),Vt=v.createElement("select"),Nt=Vt.appendChild(v.createElement("option")),Ut.type="checkbox",y.checkOn=""!==Ut.value,y.optSelected=Nt.selected,Vt.disabled=!0,y.optDisabled=!Nt.disabled,(Ut=v.createElement("input")).value="t",Ut.type="radio",y.radioValue="t"===Ut.value;var Kt,Qt=_.expr.attrHandle;_.fn.extend({attr:function(t,e){return R(this,_.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){_.removeAttr(this,t)})}}),_.extend({attr:function(t,e,i){var r,n,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===W?_.prop(t,e,i):(1===o&&_.isXMLDoc(t)||(e=e.toLowerCase(),r=_.attrHooks[e]||(_.expr.match.bool.test(e)?Kt:void 0)),void 0===i?r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=_.find.attr(t,e))?void 0:n:null!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):void _.removeAttr(t,e))},removeAttr:function(t,e){var i,r,n=0,o=e&&e.match(L);if(o&&1===t.nodeType)for(;i=o[n++];)r=_.propFix[i]||i,_.expr.match.bool.test(i)&&(t[r]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!y.radioValue&&"radio"===e&&_.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),Kt={set:function(t,e,i){return!1===e?_.removeAttr(t,i):t.setAttribute(i,i),i}},_.each(_.expr.match.bool.source.match(/\\w+/g),function(t,e){var o=Qt[e]||_.find.attr;Qt[e]=function(t,e,i){var r,n;return i||(n=Qt[e],Qt[e]=r,r=null!=o(t,e,i)?e.toLowerCase():null,Qt[e]=n),r}});var Zt=/^(?:input|select|textarea|button)$/i;_.fn.extend({prop:function(t,e){return R(this,_.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[_.propFix[t]||t]})}}),_.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,i){var r,n,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return(1!==o||!_.isXMLDoc(t))&&(e=_.propFix[e]||e,n=_.propHooks[e]),void 0!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:t[e]=i:n&&"get"in n&&null!==(r=n.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||Zt.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),y.optSelected||(_.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),_.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_.propFix[this.toLowerCase()]=this});var Jt=/[\\t\\r\\n\\f]/g;_.fn.extend({addClass:function(e){var t,i,r,n,o,a,s="string"==typeof e&&e,h=0,c=this.length;if(_.isFunction(e))return this.each(function(t){_(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(L)||[];h<c;h++)if(r=1===(i=this[h]).nodeType&&(i.className?(" "+i.className+" ").replace(Jt," "):" ")){for(o=0;n=t[o++];)r.indexOf(" "+n+" ")<0&&(r+=n+" ");a=_.trim(r),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,r,n,o,a,s=0===arguments.length||"string"==typeof e&&e,h=0,c=this.length;if(_.isFunction(e))return this.each(function(t){_(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(L)||[];h<c;h++)if(r=1===(i=this[h]).nodeType&&(i.className?(" "+i.className+" ").replace(Jt," "):"")){for(o=0;n=t[o++];)for(;0<=r.indexOf(" "+n+" ");)r=r.replace(" "+n+" "," ");a=e?_.trim(r):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(n,e){var o=typeof n;return"boolean"==typeof e&&"string"===o?e?this.addClass(n):this.removeClass(n):_.isFunction(n)?this.each(function(t){_(this).toggleClass(n.call(this,t,this.className,e),e)}):this.each(function(){if("string"===o)for(var t,e=0,i=_(this),r=n.match(L)||[];t=r[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else o!==W&&"boolean"!==o||(this.className&&F.set(this,"__className__",this.className),this.className=this.className||!1===n?"":F.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,r=this.length;i<r;i++)if(1===this[i].nodeType&&0<=(" "+this[i].className+" ").replace(Jt," ").indexOf(e))return!0;return!1}});var $t=/\\r/g;_.fn.extend({val:function(i){var r,t,n,e=this[0];return arguments.length?(n=_.isFunction(i),this.each(function(t){var e;1===this.nodeType&&(null==(e=n?i.call(this,t,_(this).val()):i)?e="":"number"==typeof e?e+="":_.isArray(e)&&(e=_.map(e,function(t){return null==t?"":t+""})),(r=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,e,"value")||(this.value=e))})):e?(r=_.valHooks[e.type]||_.valHooks[e.nodeName.toLowerCase()])&&"get"in r&&void 0!==(t=r.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace($t,""):null==t?"":t:void 0}}),_.extend({valHooks:{option:{get:function(t){var e=_.find.attr(t,"value");return null!=e?e:_.trim(_.text(t))}},select:{get:function(t){for(var e,i,r=t.options,n=t.selectedIndex,o="select-one"===t.type||n<0,a=o?null:[],s=o?n+1:r.length,h=n<0?s:o?n:0;h<s;h++)if(((i=r[h]).selected||h===n)&&(y.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!_.nodeName(i.parentNode,"optgroup"))){if(e=_(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,r,n=t.options,o=_.makeArray(e),a=n.length;a--;)((r=n[a]).selected=0<=_.inArray(r.value,o))&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]={set:function(t,e){if(_.isArray(e))return t.checked=0<=_.inArray(_(t).val(),e)}},y.checkOn||(_.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),_.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,i){_.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),_.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,r){return this.on(e,t,i,r)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var te=_.now(),ee=/\\?/;_.parseJSON=function(t){return JSON.parse(t+"")},_.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||_.error("Invalid XML: "+t),e};var ie=/#.*$/,re=/([?&])_=[^&]*/,ne=/^(.*?):[ \\t]*([^\\r\\n]*)$/gm,oe=/^(?:GET|HEAD)$/,ae=/^\\/\\//,se=/^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,he={},ce={},le="*/".concat("*"),ue=f.location.href,pe=se.exec(ue.toLowerCase())||[];function de(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,r=0,n=t.toLowerCase().match(L)||[];if(_.isFunction(e))for(;i=n[r++];)"+"===i[0]?(i=i.slice(1)||"*",(o[i]=o[i]||[]).unshift(e)):(o[i]=o[i]||[]).push(e)}}function fe(e,n,o,a){var s={},h=e===ce;function c(t){var r;return s[t]=!0,_.each(e[t]||[],function(t,e){var i=e(n,o,a);return"string"!=typeof i||h||s[i]?h?!(r=i):void 0:(n.dataTypes.unshift(i),c(i),!1)}),r}return c(n.dataTypes[0])||!s["*"]&&c("*")}function me(t,e){var i,r,n=_.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((n[i]?t:r||(r={}))[i]=e[i]);return r&&_.extend(!0,t,r),t}_.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ue,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pe[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":_.parseJSON,"text xml":_.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?me(me(t,_.ajaxSettings),e):me(_.ajaxSettings,t)},ajaxPrefilter:de(he),ajaxTransport:de(ce),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var l,u,p,i,d,r,f,n,m=_.ajaxSetup({},e),g=m.context||m,y=m.context&&(g.nodeType||g.jquery)?_(g):_.event,v=_.Deferred(),x=_.Callbacks("once memory"),b=m.statusCode||{},o={},a={},w=0,s="canceled",M={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!i)for(i={};e=ne.exec(p);)i[e[1].toLowerCase()]=e[2];e=i[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?p:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return w||(t=a[i]=a[i]||t,o[t]=e),this},overrideMimeType:function(t){return w||(m.mimeType=t),this},statusCode:function(t){var e;if(t)if(w<2)for(e in t)b[e]=[b[e],t[e]];else M.always(t[M.status]);return this},abort:function(t){var e=t||s;return l&&l.abort(e),h(0,e),this}};if(v.promise(M).complete=x.add,M.success=M.done,M.error=M.fail,m.url=((t||m.url||ue)+"").replace(ie,"").replace(ae,pe[1]+"//"),m.type=e.method||e.type||m.method||m.type,m.dataTypes=_.trim(m.dataType||"*").toLowerCase().match(L)||[""],null==m.crossDomain&&(r=se.exec(m.url.toLowerCase()),m.crossDomain=!(!r||r[1]===pe[1]&&r[2]===pe[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(pe[3]||("http:"===pe[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=_.param(m.data,m.traditional)),fe(he,m,e,M),2===w)return M;for(n in(f=_.event&&m.global)&&0==_.active++&&_.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!oe.test(m.type),u=m.url,m.hasContent||(m.data&&(u=m.url+=(ee.test(u)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=re.test(u)?u.replace(re,"$1_="+te++):u+(ee.test(u)?"&":"?")+"_="+te++)),m.ifModified&&(_.lastModified[u]&&M.setRequestHeader("If-Modified-Since",_.lastModified[u]),_.etag[u]&&M.setRequestHeader("If-None-Match",_.etag[u])),(m.data&&m.hasContent&&!1!==m.contentType||e.contentType)&&M.setRequestHeader("Content-Type",m.contentType),M.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+le+"; q=0.01":""):m.accepts["*"]),m.headers)M.setRequestHeader(n,m.headers[n]);if(m.beforeSend&&(!1===m.beforeSend.call(g,M,m)||2===w))return M.abort();for(n in s="abort",{success:1,error:1,complete:1})M[n](m[n]);if(l=fe(ce,m,e,M)){M.readyState=1,f&&y.trigger("ajaxSend",[M,m]),m.async&&0<m.timeout&&(d=setTimeout(function(){M.abort("timeout")},m.timeout));try{w=1,l.send(o,h)}catch(t){if(!(w<2))throw t;h(-1,t)}}else h(-1,"No Transport");function h(t,e,i,r){var n,o,a,s,h,c=e;2!==w&&(w=2,d&&clearTimeout(d),l=void 0,p=r||"",M.readyState=0<t?4:0,n=200<=t&&t<300||304===t,i&&(s=function(t,e,i){for(var r,n,o,a,s=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(n in s)if(s[n]&&s[n].test(r)){h.unshift(n);break}if(h[0]in i)o=h[0];else{for(n in i){if(!h[0]||t.converters[n+" "+h[0]]){o=n;break}a||(a=n)}o=o||a}if(o)return o!==h[0]&&h.unshift(o),i[o]}(m,M,i)),s=function(t,e,i,r){var n,o,a,s,h,c={},l=t.dataTypes.slice();if(l[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=l.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!h&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=o,o=l.shift())if("*"===o)o=h;else if("*"!==h&&h!==o){if(!(a=c[h+" "+o]||c["* "+o]))for(n in c)if((s=n.split(" "))[1]===o&&(a=c[h+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[n]:!0!==c[n]&&(o=s[0],l.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+h+" to "+o}}}return{state:"success",data:e}}(m,s,M,n),n?(m.ifModified&&((h=M.getResponseHeader("Last-Modified"))&&(_.lastModified[u]=h),(h=M.getResponseHeader("etag"))&&(_.etag[u]=h)),204===t||"HEAD"===m.type?c="nocontent":304===t?c="notmodified":(c=s.state,o=s.data,n=!(a=s.error))):(a=c,!t&&c||(c="error",t<0&&(t=0))),M.status=t,M.statusText=(e||c)+"",n?v.resolveWith(g,[o,c,M]):v.rejectWith(g,[M,c,a]),M.statusCode(b),b=void 0,f&&y.trigger(n?"ajaxSuccess":"ajaxError",[M,m,n?o:a]),x.fireWith(g,[M,c]),f&&(y.trigger("ajaxComplete",[M,m]),--_.active||_.event.trigger("ajaxStop")))}return M},getJSON:function(t,e,i){return _.get(t,e,i,"json")},getScript:function(t,e){return _.get(t,void 0,e,"script")}}),_.each(["get","post"],function(t,n){_[n]=function(t,e,i,r){return _.isFunction(e)&&(r=r||i,i=e,e=void 0),_.ajax({url:t,type:n,dataType:r,data:e,success:i})}}),_._evalUrl=function(t){return _.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},_.fn.extend({wrapAll:function(e){var t;return _.isFunction(e)?this.each(function(t){_(this).wrapAll(e.call(this,t))}):(this[0]&&(t=_(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(i){return _.isFunction(i)?this.each(function(t){_(this).wrapInner(i.call(this,t))}):this.each(function(){var t=_(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=_.isFunction(e);return this.each(function(t){_(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){_.nodeName(this,"body")||_(this).replaceWith(this.childNodes)}).end()}}),_.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},_.expr.filters.visible=function(t){return!_.expr.filters.hidden(t)};var ge=/%20/g,ye=/\\[\\]$/,ve=/\\r?\\n/g,xe=/^(?:submit|button|image|reset|file)$/i,be=/^(?:input|select|textarea|keygen)/i;function we(i,t,r,n){var e;if(_.isArray(t))_.each(t,function(t,e){r||ye.test(i)?n(i,e):we(i+"["+("object"==typeof e?t:"")+"]",e,r,n)});else if(r||"object"!==_.type(t))n(i,t);else for(e in t)we(i+"["+e+"]",t[e],r,n)}_.param=function(t,e){var i,r=[],n=function(t,e){e=_.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=_.ajaxSettings&&_.ajaxSettings.traditional),_.isArray(t)||t.jquery&&!_.isPlainObject(t))_.each(t,function(){n(this.name,this.value)});else for(i in t)we(i,t[i],e,n);return r.join("&").replace(ge,"+")},_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=_.prop(this,"elements");return t?_.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!_(this).is(":disabled")&&be.test(this.nodeName)&&!xe.test(t)&&(this.checked||!H.test(t))}).map(function(t,e){var i=_(this).val();return null==i?null:_.isArray(i)?_.map(i,function(t){return{name:e.name,value:t.replace(ve,"\\r\\n")}}):{name:e.name,value:i.replace(ve,"\\r\\n")}}).get()}}),_.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Me=0,_e={},Se={0:200,1223:204},Te=_.ajaxSettings.xhr();f.attachEvent&&f.attachEvent("onunload",function(){for(var t in _e)_e[t]()}),y.cors=!!Te&&"withCredentials"in Te,y.ajax=Te=!!Te,_.ajaxTransport(function(o){var a;if(y.cors||Te&&!o.crossDomain)return{send:function(t,e){var i,r=o.xhr(),n=++Me;if(r.open(o.type,o.url,o.async,o.username,o.password),o.xhrFields)for(i in o.xhrFields)r[i]=o.xhrFields[i];for(i in o.mimeType&&r.overrideMimeType&&r.overrideMimeType(o.mimeType),o.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)r.setRequestHeader(i,t[i]);a=function(t){return function(){a&&(delete _e[n],a=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?e(r.status,r.statusText):e(Se[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=a(),r.onerror=a("error"),a=_e[n]=a("abort");try{r.send(o.hasContent&&o.data||null)}catch(t){if(a)throw t}},abort:function(){a&&a()}}}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return _.globalEval(t),t}}}),_.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),_.ajaxTransport("script",function(i){var r,n;if(i.crossDomain)return{send:function(t,e){r=_("<script>").prop({async:!0,charset:i.scriptCharset,src:i.url}).on("load error",n=function(t){r.remove(),n=null,t&&e("error"===t.type?404:200,t.type)}),v.head.appendChild(r[0])},abort:function(){n&&n()}}});var Ce=[],Ee=/(=)\\?(?=&|$)|\\?\\?/;_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ce.pop()||_.expando+"_"+te++;return this[t]=!0,t}}),_.ajaxPrefilter("json jsonp",function(t,e,i){var r,n,o,a=!1!==t.jsonp&&(Ee.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ee.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=_.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ee,"$1"+r):!1!==t.jsonp&&(t.url+=(ee.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||_.error(r+" was not called"),o[0]},t.dataTypes[0]="json",n=f[r],f[r]=function(){o=arguments},i.always(function(){f[r]=n,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ce.push(r)),o&&_.isFunction(n)&&n(o[0]),o=n=void 0}),"script"}),_.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||v;var r=x.exec(t),n=!i&&[];return r?[e.createElement(r[1])]:(r=_.buildFragment([t],e,n),n&&n.length&&_(n).remove(),_.merge([],r.childNodes))};var Ae=_.fn.load;_.fn.load=function(t,e,i){if("string"!=typeof t&&Ae)return Ae.apply(this,arguments);var r,n,o,a=this,s=t.indexOf(" ");return 0<=s&&(r=_.trim(t.slice(s)),t=t.slice(0,s)),_.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(n="POST"),0<a.length&&_.ajax({url:t,type:n,dataType:"html",data:e}).done(function(t){o=arguments,a.html(r?_("<div>").append(_.parseHTML(t)).find(r):t)}).complete(i&&function(t,e){a.each(i,o||[t.responseText,e,t])}),this},_.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){_.fn[e]=function(t){return this.on(e,t)}}),_.expr.filters.animated=function(e){return _.grep(_.timers,function(t){return e===t.elem}).length};var Le=f.document.documentElement;function Pe(t){return _.isWindow(t)?t:9===t.nodeType&&t.defaultView}_.offset={setOffset:function(t,e,i){var r,n,o,a,s,h,c=_.css(t,"position"),l=_(t),u={};"static"===c&&(t.style.position="relative"),s=l.offset(),o=_.css(t,"top"),h=_.css(t,"left"),n=("absolute"===c||"fixed"===c)&&-1<(o+h).indexOf("auto")?(a=(r=l.position()).top,r.left):(a=parseFloat(o)||0,parseFloat(h)||0),_.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(u.top=e.top-s.top+a),null!=e.left&&(u.left=e.left-s.left+n),"using"in e?e.using.call(t,u):l.css(u)}},_.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){_.offset.setOffset(this,e,t)});var t,i,r=this[0],n={top:0,left:0},o=r&&r.ownerDocument;return o?(t=o.documentElement,_.contains(t,r)?(typeof r.getBoundingClientRect!==W&&(n=r.getBoundingClientRect()),i=Pe(o),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n):void 0},position:function(){if(this[0]){var t,e,i=this[0],r={top:0,left:0};return"fixed"===_.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),_.nodeName(t[0],"html")||(r=t.offset()),r.top+=_.css(t[0],"borderTopWidth",!0),r.left+=_.css(t[0],"borderLeftWidth",!0)),{top:e.top-r.top-_.css(i,"marginTop",!0),left:e.left-r.left-_.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Le;t&&!_.nodeName(t,"html")&&"static"===_.css(t,"position");)t=t.offsetParent;return t||Le})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var o="pageYOffset"===n;_.fn[e]=function(t){return R(this,function(t,e,i){var r=Pe(t);if(void 0===i)return r?r[n]:t[e];r?r.scrollTo(o?f.pageXOffset:i,o?i:f.pageYOffset):t[e]=i},e,t,arguments.length,null)}}),_.each(["top","left"],function(t,i){_.cssHooks[i]=Mt(y.pixelPosition,function(t,e){if(e)return e=wt(t,i),xt.test(e)?_(t).position()[i]+"px":e})}),_.each({Height:"height",Width:"width"},function(o,a){_.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,t){_.fn[t]=function(t,e){var i=arguments.length&&(r||"boolean"!=typeof t),n=r||(!0===t||!0===e?"margin":"border");return R(this,function(t,e,i){var r;return _.isWindow(t)?t.document.documentElement["client"+o]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+o],r["scroll"+o],t.body["offset"+o],r["offset"+o],r["client"+o])):void 0===i?_.css(t,e,n):_.style(t,e,i,n)},a,i?t:void 0,i,null)}})}),_.fn.size=function(){return this.length},_.fn.andSelf=_.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return _});var ke=f.jQuery,Re=f.$;return _.noConflict=function(t){return f.$===_&&(f.$=Re),t&&f.jQuery===_&&(f.jQuery=ke),_},typeof t===W&&(f.jQuery=f.$=_),_},"object"==typeof e&&"object"==typeof e.exports?e.exports=r.document?n(r,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(r)},{}],17:[function(t,e,i){function r(){}function a(t,e){t.css("-webkit-box-shadow",e),t.css("-moz-box-shadow",e),t.css("box-shadow",e)}e.exports=new r,r.prototype.choice=function(t){return t[Math.floor(Math.random()*t.length)]},r.prototype.shuffle=function(t){for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=t[i];return e.sort(function(){return.5-Math.random()}),e},r.prototype.randColor=function(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"},r.prototype.randInt=function(t,e){var i,r;return r=void 0!==t&&void 0!==e?(i=t,e):void 0!==t?t:0,i?Math.floor(Math.random()*(r-i))+i:Math.floor(Math.random()*r)},r.prototype.colorWheel=function(t){var e="rgb(",i=t%1536;return t=i%256,i<256?e+"0,255,"+t+")":i<512?e+"0,"+(255-t)+",255)":i<768?e+t+",0,255)":i<1024?e+"255,0,"+(255-t)+")":i<1280?e+"255,"+t+",0)":e+(255-t)+",255,0)"},r.prototype.alphize=function(t,e){return t.replace("rgb","rgba"),t.replace(")",", "+e+")"),t},r.prototype.contrasters=function(){var t=Math.floor(1536*Math.random());return[this.colorWheel(t),this.colorWheel(t+650)]},r.prototype.randomShadow=function(t,e){var i=e+"px";a(t,"0px 0px "+i+" "+i+" "+this.randColor())},r.prototype.shadow=function(t,e,i,r,n,o){a(t,e+"px"+" "+(i+"px")+" "+(r+"px")+" "+(n+"px")+" "+o)},r.prototype.addTransform=function(t,e){var i=this.getTransform(t),r=(i=i.replace("none",""))+e;this.setTransform(t,r)},r.prototype.setTransform=function(t,e){t.css("-webkit-transform",e),t.css("-moz-transform",e),t.css("-ms-transform",e),t.css("-o-transform",e),t.css("transform",e)},r.prototype.getTransform=function(t){for(var e=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"],i=0;i<e.length;i++){var r=t.css(e[i]);if("none"===r&&i+1<e.length)if(t.css(e[i+1]))continue;return r}},r.prototype.clearTransforms=function(t){t.css("-webkit-transform",""),t.css("-moz-transform",""),t.css("-ms-transform",""),t.css("-o-transform",""),t.css("transform","")},r.prototype.rotate=function(t,e){var i=this.getTransform(t);i=i.replace(/matrix\\(.*?\\)/,"").replace("none","");var r=" rotate("+e+"deg)";this.setTransform(t,i+r)},r.prototype.scale=function(t,e){var i=this.getTransform(t);i=i.replace(/matrix\\(.*?\\)/,"").replace("none","");var r=" scale("+e+","+e+")";this.setTransform(t,i+r)},r.prototype.translate=function(t,e,i){var r=this.getTransform(t);r=r.replace(/matrix\\(.*?\\)/,"").replace("none","");var n=" translate("+e+", "+i+")";this.setTransform(t,r+n)},r.prototype.skew=function(t,e,i){var r=this.getTransform(t);r=r.replace(/skew\\(.*?\\)/,"").replace(/matrix\\(.*?\\)/,"").replace("none","");var n=" skew("+(e+"deg")+", "+(i+"deg")+")";this.setTransform(t,r+n)},r.prototype.warp=function(t,e,i,r){var n=this.getTransform(t);n=n.replace(/matrix\\(.*?\\)/,"").replace("none","");var o=" rotate("+e+"deg)",a=" skew("+(i+"deg")+", "+(r+"deg")+")";this.setTransform(t,n+o+a)},r.prototype.slaw=function(t,e,i,r){var n=this.getTransform(t);n=n.replace(/matrix\\(.*?\\)/,"").replace("none","");var o=" scale("+e+","+e+")",a=" translate("+i+", "+r+")";this.setTransform(t,n+o+a)},r.prototype.straw=function(t,e,i){var r=this.getTransform(t);r=r.replace(/matrix\\(.*?\\)/,"").replace("none","");var n=" scale("+e+","+e+")",o=" rotate("+i+"deg)";this.setTransform(t,r+n+o)},r.prototype.perp=function(t,e){var i=e+"px";t.css("-webkit-perspective",i),t.css("-moz-perspective",i),t.css("-ms-perspective",i),t.css("-o-perspective",i),t.css("perspective",i)},r.prototype.perpo=function(t,e,i){var r=e+"% "+i+"%";t.css("-webkit-perspective-origin",r),t.css("-moz-perspective-origin",r),t.css("-ms-perspective-origin",r),t.css("-o-perspective-origin",r),t.css("perspective-origin",r)},r.prototype.trans3d=function(t,e,i,r){var n=this.getTransform(t);n=n.replace(/matrix3d\\(.*?\\)/,"").replace("none","");var o=" translate3d("+e+"px, "+i+"px, "+r+"px)";this.setTransform(t,n+o)},r.prototype.scale3d=function(t,e){var i=this.getTransform(t);i=i.replace(/matrix3d\\(.*?\\)/,"").replace("none","");var r=" scale3d("+e+", "+e+", "+e+")";this.setTransform(t,i+r)},r.prototype.rotate3d=function(t,e,i,r,n){var o=this.getTransform(t);o=o.replace(/matrix3d\\(.*?\\)/,"").replace("none","");var a=" rotate3d("+e+", "+i+", "+r+", "+n+"deg)";this.setTransform(t,o+a)},r.prototype.rotate3dx=function(t,e){this.rotate3d(t,1,0,0,e)},r.prototype.rotate3dy=function(t,e){this.rotate3d(t,0,1,0,e)},r.prototype.rotate3dz=function(t,e){this.rotate3d(t,0,0,1,e)},r.prototype.addFilter=function(t,e){var i=this.getFilter(t),r=(i=i.replace("none",""))+" "+e;this.setFilter(t,r)},r.prototype.setFilter=function(t,e){t.css("-webkit-filter",e),t.css("-moz-filter",e),t.css("-ms-filter",e),t.css("-o-filter",e),t.css("filter",e)},r.prototype.getFilter=function(t){for(var e=["filter","-webkit-filter","-moz-filter","-ms-filter","-o-filter"],i=0;i<e.length;i++){var r=t.css(e[i]);if("none"===r&&i+1<e.length)if(t.css(e[i+1]))continue;return r}},r.prototype.clearFilters=function(t){t.css("-webkit-filter",""),t.css("-moz-filter",""),t.css("-ms-filter",""),t.css("-o-filter",""),t.css("filter","")},r.prototype.grayscale=function(t,e){var i=this.getFilter(t);i=i.replace(/grayscale\\(.*?\\)/,"").replace("none","");var r=" grayscale("+e+"%)";this.setFilter(t,i+r)},r.prototype.sepia=function(t,e){var i=this.getFilter(t);i=i.replace(/sepia\\(.*?\\)/,"").replace("none","");var r=" sepia("+e+"%)";this.setFilter(t,i+r)},r.prototype.saturate=function(t,e){var i=this.getFilter(t);i=i.replace(/saturate\\(.*?\\)/,"").replace("none","");var r=" saturate("+e+"%)";this.setFilter(t,i+r)},r.prototype.invert=function(t,e){var i=this.getFilter(t);i=i.replace(/invert\\(.*?\\)/,"").replace("none","");var r=" invert("+e+"%)";this.setFilter(t,i+r)},r.prototype.hutate=function(t,e){var i=this.getFilter(t);i=i.replace(/hue-rotate\\(.*?\\)/,"").replace("none","");var r=" hue-rotate("+e+"deg)";this.setFilter(t,i+r)},r.prototype.opace=function(t,e){var i=this.getFilter(t);i=i.replace(/opacity\\(.*?\\)/,"").replace("none","");var r=" opacity("+e+"%)";this.setFilter(t,i+r)},r.prototype.brightness=function(t,e){var i=this.getFilter(t);i=i.replace(/brightness\\(.*?\\)/,"").replace("none","");var r=" brightness("+e+"%)";this.setFilter(t,i+r)},r.prototype.contrast=function(t,e){var i=this.getFilter(t);i=i.replace(/contrast\\(.*?\\)/,"").replace("none","");var r=" contrast("+e+"%)";this.setFilter(t,i+r)},r.prototype.blur=function(t,e){var i=this.getFilter(t);i=i.replace(/blur\\(.*?\\)/,"").replace("none","");var r=" blur("+e+"px)";this.setFilter(t,i+r)}},{}],18:[function(t,e,i){var r,n,o,a,s,h,c,l,u,p,d,f,m,g,y,v,x,b,w,M,_,S,T,C,E,A,L,P,k,R,D,F,O,B,U,V,N,z,I,G,j,H,W,X,q,Y,K,Q,Z,J,$,tt,et,it,rt,nt,ot,at,st,ht,ct,lt,ut,pt,dt,ft,mt,gt,yt,vt,xt,bt,wt,Mt,_t,St,Tt,Ct,Et,At,Lt,Pt,kt,Rt,Dt,Ft,Ot,Bt,Ut,Vt,Nt,zt,It,Gt,jt,Ht,Wt,Xt,qt,Yt,Kt,Qt,Zt,Jt,$t,te,ee,ie,re,ne,oe,ae,se,he,ce,le,ue,pe,de,fe,me,ge,ye,ve,xe,be,we,Me,_e,Se,Te,Ce,Ee,Ae,Le,Pe,ke,Re,De,Fe,Oe,Be,Ue,Ve,Ne,ze,Ie,Ge,je,He,We,Xe,qe,Ye,Ke,Qe=Qe||{},Ze={REVISION:"72"};"function"==typeof define&&define.amd?define("three",Ze):void 0!==i&&void 0!==e&&(e.exports=Ze),void 0!==Qe.requestAnimationFrame&&void 0!==Qe.cancelAnimationFrame||function(){for(var n=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!Qe.requestAnimationFrame;++e)Qe.requestAnimationFrame=Qe[t[e]+"RequestAnimationFrame"],Qe.cancelAnimationFrame=Qe[t[e]+"CancelAnimationFrame"]||Qe[t[e]+"CancelRequestAnimationFrame"];void 0===Qe.requestAnimationFrame&&void 0!==Qe.setTimeout&&(Qe.requestAnimationFrame=function(t){var e=Date.now(),i=Math.max(0,16-(e-n)),r=Qe.setTimeout(function(){t(e+i)},i);return n=e+i,r}),void 0===Qe.cancelAnimationFrame&&void 0!==Qe.clearTimeout&&(Qe.cancelAnimationFrame=function(t){Qe.clearTimeout(t)})}(),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\\s*function\\s*(\\S*)\\s*\\(/)[1]}}),Ze.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},Ze.CullFaceNone=0,Ze.CullFaceBack=1,Ze.CullFaceFront=2,Ze.CullFaceFrontBack=3,Ze.FrontFaceDirectionCW=0,Ze.FrontFaceDirectionCCW=1,Ze.BasicShadowMap=0,Ze.PCFShadowMap=1,Ze.PCFSoftShadowMap=2,Ze.FrontSide=0,Ze.BackSide=1,Ze.DoubleSide=2,Ze.FlatShading=1,Ze.SmoothShading=2,Ze.NoColors=0,Ze.FaceColors=1,Ze.VertexColors=2,Ze.NoBlending=0,Ze.NormalBlending=1,Ze.AdditiveBlending=2,Ze.SubtractiveBlending=3,Ze.MultiplyBlending=4,Ze.CustomBlending=5,Ze.AddEquation=100,Ze.SubtractEquation=101,Ze.ReverseSubtractEquation=102,Ze.MinEquation=103,Ze.MaxEquation=104,Ze.ZeroFactor=200,Ze.OneFactor=201,Ze.SrcColorFactor=202,Ze.OneMinusSrcColorFactor=203,Ze.SrcAlphaFactor=204,Ze.OneMinusSrcAlphaFactor=205,Ze.DstAlphaFactor=206,Ze.OneMinusDstAlphaFactor=207,Ze.DstColorFactor=208,Ze.OneMinusDstColorFactor=209,Ze.SrcAlphaSaturateFactor=210,Ze.NeverDepth=0,Ze.AlwaysDepth=1,Ze.LessDepth=2,Ze.LessEqualDepth=3,Ze.EqualDepth=4,Ze.GreaterEqualDepth=5,Ze.GreaterDepth=6,Ze.NotEqualDepth=7,Ze.MultiplyOperation=0,Ze.MixOperation=1,Ze.AddOperation=2,Ze.UVMapping=300,Ze.CubeReflectionMapping=301,Ze.CubeRefractionMapping=302,Ze.EquirectangularReflectionMapping=303,Ze.EquirectangularRefractionMapping=304,Ze.SphericalReflectionMapping=305,Ze.RepeatWrapping=1e3,Ze.ClampToEdgeWrapping=1001,Ze.MirroredRepeatWrapping=1002,Ze.NearestFilter=1003,Ze.NearestMipMapNearestFilter=1004,Ze.NearestMipMapLinearFilter=1005,Ze.LinearFilter=1006,Ze.LinearMipMapNearestFilter=1007,Ze.LinearMipMapLinearFilter=1008,Ze.UnsignedByteType=1009,Ze.ByteType=1010,Ze.ShortType=1011,Ze.UnsignedShortType=1012,Ze.IntType=1013,Ze.UnsignedIntType=1014,Ze.FloatType=1015,Ze.HalfFloatType=1025,Ze.UnsignedShort4444Type=1016,Ze.UnsignedShort5551Type=1017,Ze.UnsignedShort565Type=1018,Ze.AlphaFormat=1019,Ze.RGBFormat=1020,Ze.RGBAFormat=1021,Ze.LuminanceFormat=1022,Ze.LuminanceAlphaFormat=1023,Ze.RGBEFormat=Ze.RGBAFormat,Ze.RGB_S3TC_DXT1_Format=2001,Ze.RGBA_S3TC_DXT1_Format=2002,Ze.RGBA_S3TC_DXT3_Format=2003,Ze.RGBA_S3TC_DXT5_Format=2004,Ze.RGB_PVRTC_4BPPV1_Format=2100,Ze.RGB_PVRTC_2BPPV1_Format=2101,Ze.RGBA_PVRTC_4BPPV1_Format=2102,Ze.RGBA_PVRTC_2BPPV1_Format=2103,Ze.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},Ze.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Ze.Color=function(t){return 3===arguments.length?this.setRGB(t,arguments[1],arguments[2]):this.set(t)},Ze.Color.prototype={constructor:Ze.Color,r:1,g:1,b:1,set:function(t){return t instanceof Ze.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function o(t,e,i){return i<0&&(i+=1),1<i&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(t,e,i){if(t=Ze.Math.euclideanModulo(t,1),e=Ze.Math.clamp(e,0,1),i=Ze.Math.clamp(i,0,1),0===e)this.r=this.g=this.b=i;else{var r=i<=.5?i*(1+e):i+e-i*e,n=2*i-r;this.r=o(n,r,t+1/3),this.g=o(n,r,t),this.b=o(n,r,t-1/3)}return this}}(),setStyle:function(i){var t,e=function(t){var e=parseFloat(t);return e<1&&console.warn("THREE.Color: Alpha component of color "+i+" will be ignored."),e};if(t=/^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec(i)){var r,n=t[1],o=t[2];switch(n){case"rgb":if(r=/^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,this;if(r=/^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,this;break;case"rgba":if(r=/^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":if(r=/^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec(o)){var a=parseFloat(r[1]),s=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return this.setHSL(a,s,h)}break;case"hsla":if(r=/^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(o)){a=parseFloat(r[1]),s=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,s,h)}}}else if(t=/^\\#([A-Fa-f0-9]+)$/.exec(i)){var c,l=(c=t[1]).length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}i&&0<i.length&&(void 0!==(c=Ze.ColorKeywords[i])?this.setHex(c):console.warn("THREE.Color: Unknown color "+i));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=0<e?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,r=t||{h:0,s:0,l:0},n=this.r,o=this.g,a=this.b,s=Math.max(n,o,a),h=Math.min(n,o,a),c=(h+s)/2;if(h===s)i=e=0;else{var l=s-h;switch(i=c<=.5?l/(s+h):l/(2-s-h),s){case n:e=(o-a)/l+(o<a?6:0);break;case o:e=(a-n)/l+2;break;case a:e=(n-o)/l+4}e/=6}return r.h=e,r.s=i,r.l=c,r},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=i,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},Ze.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ze.Quaternion=function(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==r?r:1},Ze.Quaternion.prototype={constructor:Ze.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(t instanceof Ze.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),r=Math.cos(t._y/2),n=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),h=t.order;return"XYZ"===h?(this._x=o*r*n+i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n-o*a*s):"YXZ"===h?(this._x=o*r*n+i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n+o*a*s):"ZXY"===h?(this._x=o*r*n-i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n-o*a*s):"ZYX"===h?(this._x=o*r*n-i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n+o*a*s):"YZX"===h?(this._x=o*r*n+i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n-o*a*s):"XZY"===h&&(this._x=o*r*n-i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n+o*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,r=i[0],n=i[4],o=i[8],a=i[1],s=i[5],h=i[9],c=i[2],l=i[6],u=i[10],p=r+s+u;return this._z=0<p?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(l-h)*e,this._y=(o-c)*e,(a-n)*e):s<r&&u<r?(e=2*Math.sqrt(1+r-s-u),this._w=(l-h)/e,this._x=.25*e,this._y=(n+a)/e,(o+c)/e):u<s?(e=2*Math.sqrt(1+s-r-u),this._w=(o-c)/e,this._x=(n+a)/e,this._y=.25*e,(h+l)/e):(e=2*Math.sqrt(1+u-r-s),this._w=(a-n)/e,this._x=(o+c)/e,this._y=(h+l)/e,.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(t,e){return void 0===r&&(r=new Ze.Vector3),(n=t.dot(e)+1)<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?r.set(-t.y,t.x,0):r.set(0,-t.z,t.y)):r.crossVectors(t,e),this._x=r.x,this._y=r.y,this._z=r.z,this._w=n,this.normalize(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return this._w=0===t?(this._x=0,this._y=0,this._z=0,1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t._x,r=t._y,n=t._z,o=t._w,a=e._x,s=e._y,h=e._z,c=e._w;return this._x=i*c+o*a+r*h-n*s,this._y=r*c+o*s+n*a-i*h,this._z=n*c+o*h+i*s-r*a,this._w=o*c-i*a-r*s-n*h,this.onChangeCallback(),this},multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,r=this._y,n=this._z,o=this._w,a=o*t._w+i*t._x+r*t._y+n*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=o,this._x=i,this._y=r,this._z=n,this;var s=Math.acos(a),h=Math.sqrt(1-a*a);if(Math.abs(h)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(r+this._y),this._z=.5*(n+this._z),this;var c=Math.sin((1-e)*s)/h,l=Math.sin(e*s)/h;return this._w=o*c+this._w*l,this._x=i*c+this._x*l,this._y=r*c+this._y*l,this._z=n*c+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Ze.Quaternion.slerp=function(t,e,i,r){return i.copy(t).slerp(e,r)},Ze.Vector2=function(t,e){this.x=t||0,this.y=e||0},Ze.Vector2.prototype={constructor:Ze.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e}else this.x=0,this.y=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},clampScalar:function(t,e){return void 0===o&&(o=new Ze.Vector2,a=new Ze.Vector2),o.set(t,t),a.set(e,e),this.clamp(o,a)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this}},Ze.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},Ze.Vector3.prototype={constructor:Ze.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t instanceof Ze.Euler==0&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===g&&(g=new Ze.Quaternion),this.applyQuaternion(g.setFromEuler(t)),this},applyAxisAngle:function(t,e){return void 0===m&&(m=new Ze.Quaternion),this.applyQuaternion(m.setFromAxisAngle(t,e)),this},applyMatrix3:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6]*r,this.y=n[1]*e+n[4]*i+n[7]*r,this.z=n[2]*e+n[5]*i+n[8]*r,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r+n[12],this.y=n[1]*e+n[5]*i+n[9]*r+n[13],this.z=n[2]*e+n[6]*i+n[10]*r+n[14],this},applyProjection:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements,o=1/(n[3]*e+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*e+n[4]*i+n[8]*r+n[12])*o,this.y=(n[1]*e+n[5]*i+n[9]*r+n[13])*o,this.z=(n[2]*e+n[6]*i+n[10]*r+n[14])*o,this},applyQuaternion:function(t){var e=this.x,i=this.y,r=this.z,n=t.x,o=t.y,a=t.z,s=t.w,h=s*e+o*r-a*i,c=s*i+a*e-n*r,l=s*r+n*i-o*e,u=-n*e-o*i-a*r;return this.x=h*s+u*-n+c*-a-l*-o,this.y=c*s+u*-o+l*-n-h*-a,this.z=l*s+u*-a+h*-o-c*-n,this},project:function(t){return void 0===f&&(f=new Ze.Matrix4),f.multiplyMatrices(t.projectionMatrix,f.getInverse(t.matrixWorld)),this.applyProjection(f)},unproject:function(t){return void 0===d&&(d=new Ze.Matrix4),d.multiplyMatrices(t.matrixWorld,d.getInverse(t.projectionMatrix)),this.applyProjection(d)},transformDirection:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r,this.y=n[1]*e+n[5]*i+n[9]*r,this.z=n[2]*e+n[6]*i+n[10]*r,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},clampScalar:function(t,e){return void 0===u&&(u=new Ze.Vector3,p=new Ze.Vector3),u.set(t,t,t),p.set(e,e,e),this.clamp(u,p)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,r=this.y,n=this.z;return this.x=r*t.z-n*t.y,this.y=n*t.x-i*t.z,this.z=i*t.y-r*t.x,this},crossVectors:function(t,e){var i=t.x,r=t.y,n=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-n*a,this.y=n*o-i*s,this.z=i*a-r*o,this},projectOnVector:function(t){return void 0===c&&(c=new Ze.Vector3),c.copy(t).normalize(),l=this.dot(c),this.copy(c).multiplyScalar(l)},projectOnPlane:function(t){return void 0===h&&(h=new Ze.Vector3),h.copy(this).projectOnVector(t),this.sub(h)},reflect:function(t){return void 0===s&&(s=new Ze.Vector3),this.sub(s.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=this.dot(t)/(this.length()*t.length());return Math.acos(Ze.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r},setEulerFromRotationMatrix:function(t,e){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(t,e){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),i=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),r=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=i,this.z=r,this},setFromMatrixColumn:function(t,e){var i=4*t,r=e.elements;return this.x=r[i],this.y=r[i+1],this.z=r[i+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},Ze.Vector4=function(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1},Ze.Vector4.prototype={constructor:Ze.Vector4,set:function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*r+o[12]*n,this.y=o[1]*e+o[5]*i+o[9]*r+o[13]*n,this.z=o[2]*e+o[6]*i+o[10]*r+o[14]*n,this.w=o[3]*e+o[7]*i+o[11]*r+o[15]*n,this},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e,this.z*=e,this.w*=e}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return this.z=e<1e-4?(this.x=1,this.y=0):(this.x=t.x/e,this.y=t.y/e,t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,r,n,o=t.elements,a=o[0],s=o[4],h=o[8],c=o[1],l=o[5],u=o[9],p=o[2],d=o[6],f=o[10];if(Math.abs(s-c)<.01&&Math.abs(h-p)<.01&&Math.abs(u-d)<.01){if(Math.abs(s+c)<.1&&Math.abs(h+p)<.1&&Math.abs(u+d)<.1&&Math.abs(a+l+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(l+1)/2,y=(f+1)/2,v=(s+c)/4,x=(h+p)/4,b=(u+d)/4;return g<m&&y<m?n=m<.01?(i=0,r=.707106781):(r=v/(i=Math.sqrt(m)),x/i):y<g?n=g<.01?(r=0,i=.707106781):(i=v/(r=Math.sqrt(g)),b/r):y<.01?(r=i=.707106781,n=0):(i=x/(n=Math.sqrt(y)),r=b/n),this.set(i,r,n,e),this}var w=Math.sqrt((d-u)*(d-u)+(h-p)*(h-p)+(c-s)*(c-s));return Math.abs(w)<.001&&(w=1),this.x=(d-u)/w,this.y=(h-p)/w,this.z=(c-s)/w,this.w=Math.acos((a+l+f-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},clampScalar:function(t,e){return void 0===y&&(y=new Ze.Vector4,v=new Ze.Vector4),y.set(t,t,t,t),v.set(e,e,e,e),this.clamp(y,v)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},Ze.Euler=function(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._order=r||Ze.Euler.DefaultOrder},Ze.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ze.Euler.DefaultOrder="XYZ",Ze.Euler.prototype={constructor:Ze.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var r=Ze.Math.clamp,n=t.elements,o=n[0],a=n[4],s=n[8],h=n[1],c=n[5],l=n[9],u=n[2],p=n[6],d=n[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(h,c)):(this._y=Math.atan2(-u,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(h,o))):"ZYX"===e?(this._y=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(h,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(t,e,i){return void 0===b&&(b=new Ze.Matrix4),b.makeRotationFromQuaternion(t),this.setFromRotationMatrix(b,e,i),this},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(x=new Ze.Quaternion,function(t){x.setFromEuler(this),this.setFromQuaternion(x,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Ze.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Ze.Line3=function(t,e){this.start=void 0!==t?t:new Ze.Vector3,this.end=void 0!==e?e:new Ze.Vector3},Ze.Line3.prototype={constructor:Ze.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){return(t||new Ze.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new Ze.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new Ze.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(w=new Ze.Vector3,M=new Ze.Vector3,function(t,e){w.subVectors(t,this.start),M.subVectors(this.end,this.start);var i=M.dot(M),r=M.dot(w)/i;return e&&(r=Ze.Math.clamp(r,0,1)),r}),closestPointToPoint:function(t,e,i){var r=this.closestPointToPointParameter(t,e),n=i||new Ze.Vector3;return this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},Ze.Box2=function(t,e){this.min=void 0!==t?t:new Ze.Vector2(1/0,1/0),this.max=void 0!==e?e:new Ze.Vector2(-1/0,-1/0)},Ze.Box2.prototype={constructor:Ze.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(S=new Ze.Vector2,function(t,e){var i=S.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new Ze.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new Ze.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new Ze.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new Ze.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:(_=new Ze.Vector2,function(t){return _.copy(t).clamp(this.min,this.max).sub(t).length()}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Ze.Box3=function(t,e){this.min=void 0!==t?t:new Ze.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new Ze.Vector3(-1/0,-1/0,-1/0)},Ze.Box3.prototype={constructor:Ze.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(L=new Ze.Vector3,function(t,e){var i=L.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}),setFromObject:(A=new Ze.Vector3,function(t){var a=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){var e=t.geometry;if(void 0!==e)if(e instanceof Ze.Geometry)for(var i=e.vertices,r=0,n=i.length;r<n;r++)A.copy(i[r]),A.applyMatrix4(t.matrixWorld),a.expandByPoint(A);else if(e instanceof Ze.BufferGeometry&&void 0!==e.attributes.position){var o=e.attributes.position.array;for(r=0,n=o.length;r<n;r+=3)A.set(o[r],o[r+1],o[r+2]),A.applyMatrix4(t.matrixWorld),a.expandByPoint(A)}}),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new Ze.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new Ze.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new Ze.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},clampPoint:function(t,e){return(e||new Ze.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:(E=new Ze.Vector3,function(t){return E.copy(t).clamp(this.min,this.max).sub(t).length()}),getBoundingSphere:(C=new Ze.Vector3,function(t){var e=t||new Ze.Sphere;return e.center=this.center(),e.radius=.5*this.size(C).length(),e}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(T=[new Ze.Vector3,new Ze.Vector3,new Ze.Vector3,new Ze.Vector3,new Ze.Vector3,new Ze.Vector3,new Ze.Vector3,new Ze.Vector3],function(t){return T[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),T[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),T[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),T[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),T[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),T[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),T[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),T[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(T),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Ze.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},Ze.Matrix3.prototype={constructor:Ze.Matrix3,set:function(t,e,i,r,n,o,a,s,h){var c=this.elements;return c[0]=t,c[3]=e,c[6]=i,c[1]=r,c[4]=n,c[7]=o,c[2]=a,c[5]=s,c[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(t,e,i){void 0===k&&(k=new Ze.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length);for(var r=0,n=e;r<i;r+=3,n+=3)k.fromArray(t,n),k.applyMatrix3(this),k.toArray(t,n);return t},applyToBuffer:function(t,e,i){void 0===P&&(P=new Ze.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length/t.itemSize);for(var r=0,n=e;r<i;r++,n++)P.x=t.getX(n),P.y=t.getY(n),P.z=t.getZ(n),P.applyMatrix3(this),t.setXYZ(P.x,P.y,P.z);return t},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],s=t[6],h=t[7],c=t[8];return e*o*c-e*a*h-i*n*c+i*a*s+r*n*h-r*o*s},getInverse:function(t,e){var i=t.elements,r=this.elements;r[0]=i[10]*i[5]-i[6]*i[9],r[1]=-i[10]*i[1]+i[2]*i[9],r[2]=i[6]*i[1]-i[2]*i[5],r[3]=-i[10]*i[4]+i[6]*i[8],r[4]=i[10]*i[0]-i[2]*i[8],r[5]=-i[6]*i[0]+i[2]*i[4],r[6]=i[9]*i[4]-i[5]*i[8],r[7]=-i[9]*i[0]+i[1]*i[8],r[8]=i[5]*i[0]-i[1]*i[4];var n=i[0]*r[0]+i[1]*r[3]+i[2]*r[6];if(0!==n)return this.multiplyScalar(1/n),this;var o="Matrix3.getInverse(): can\'t invert matrix, determinant is 0";if(e)throw new Error(o);return console.warn(o),this.identity(),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},Ze.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},Ze.Matrix4.prototype={constructor:Ze.Matrix4,set:function(t,e,i,r,n,o,a,s,h,c,l,u,p,d,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=r,g[1]=n,g[5]=o,g[9]=a,g[13]=s,g[2]=h,g[6]=c,g[10]=l,g[14]=u,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ze.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){var r=this.elements;return t.set(r[0],r[1],r[2]),e.set(r[4],r[5],r[6]),i.set(r[8],r[9],r[10]),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(t){void 0===z&&(z=new Ze.Vector3);var e=this.elements,i=t.elements,r=1/z.set(i[0],i[1],i[2]).length(),n=1/z.set(i[4],i[5],i[6]).length(),o=1/z.set(i[8],i[9],i[10]).length();return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[4]=i[4]*n,e[5]=i[5]*n,e[6]=i[6]*n,e[8]=i[8]*o,e[9]=i[9]*o,e[10]=i[10]*o,this},makeRotationFromEuler:function(t){t instanceof Ze.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,r=t.y,n=t.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(r),h=Math.sin(r),c=Math.cos(n),l=Math.sin(n);if("XYZ"===t.order){var u=o*c,p=o*l,d=a*c,f=a*l;e[0]=s*c,e[4]=-s*l,e[8]=h,e[1]=p+d*h,e[5]=u-f*h,e[9]=-a*s,e[2]=f-u*h,e[6]=d+p*h,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,g=s*l,y=h*c,v=h*l;e[0]=m+v*a,e[4]=y*a-g,e[8]=o*h,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=g*a-y,e[6]=v+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*c,g=s*l,y=h*c,v=h*l;e[0]=m-v*a,e[4]=-o*l,e[8]=y+g*a,e[1]=g+y*a,e[5]=o*c,e[9]=v-m*a,e[2]=-o*h,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){u=o*c,p=o*l,d=a*c,f=a*l;e[0]=s*c,e[4]=d*h-p,e[8]=u*h+f,e[1]=s*l,e[5]=f*h+u,e[9]=p*h-d,e[2]=-h,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var x=o*s,b=o*h,w=a*s,M=a*h;e[0]=s*c,e[4]=M-x*l,e[8]=w*l+b,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-h*c,e[6]=b*l+w,e[10]=x-M*l}else if("XZY"===t.order){x=o*s,b=o*h,w=a*s,M=a*h;e[0]=s*c,e[4]=-l,e[8]=h*c,e[1]=x*l+M,e[5]=o*c,e[9]=b*l-w,e[2]=w*l-b,e[6]=a*c,e[10]=M*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z,o=t.w,a=i+i,s=r+r,h=n+n,c=i*a,l=i*s,u=i*h,p=r*s,d=r*h,f=n*h,m=o*a,g=o*s,y=o*h;return e[0]=1-(p+f),e[4]=l-y,e[8]=u+g,e[1]=l+y,e[5]=1-(c+f),e[9]=d-m,e[2]=u-g,e[6]=d+m,e[10]=1-(c+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(t,e,i){void 0===U&&(U=new Ze.Vector3),void 0===V&&(V=new Ze.Vector3),void 0===N&&(N=new Ze.Vector3);var r=this.elements;return N.subVectors(t,e).normalize(),0===N.length()&&(N.z=1),U.crossVectors(i,N).normalize(),0===U.length()&&(N.x+=1e-4,U.crossVectors(i,N).normalize()),V.crossVectors(N,U),r[0]=U.x,r[4]=V.x,r[8]=N.x,r[1]=U.y,r[5]=V.y,r[9]=N.y,r[2]=U.z,r[6]=V.z,r[10]=N.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,o=i[0],a=i[4],s=i[8],h=i[12],c=i[1],l=i[5],u=i[9],p=i[13],d=i[2],f=i[6],m=i[10],g=i[14],y=i[3],v=i[7],x=i[11],b=i[15],w=r[0],M=r[4],_=r[8],S=r[12],T=r[1],C=r[5],E=r[9],A=r[13],L=r[2],P=r[6],k=r[10],R=r[14],D=r[3],F=r[7],O=r[11],B=r[15];return n[0]=o*w+a*T+s*L+h*D,n[4]=o*M+a*C+s*P+h*F,n[8]=o*_+a*E+s*k+h*O,n[12]=o*S+a*A+s*R+h*B,n[1]=c*w+l*T+u*L+p*D,n[5]=c*M+l*C+u*P+p*F,n[9]=c*_+l*E+u*k+p*O,n[13]=c*S+l*A+u*R+p*B,n[2]=d*w+f*T+m*L+g*D,n[6]=d*M+f*C+m*P+g*F,n[10]=d*_+f*E+m*k+g*O,n[14]=d*S+f*A+m*R+g*B,n[3]=y*w+v*T+x*L+b*D,n[7]=y*M+v*C+x*P+b*F,n[11]=y*_+v*E+x*k+b*O,n[15]=y*S+v*A+x*R+b*B,this},multiplyToArray:function(t,e,i){var r=this.elements;return this.multiplyMatrices(t,e),i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(t,e,i){void 0===B&&(B=new Ze.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length);for(var r=0,n=e;r<i;r+=3,n+=3)B.fromArray(t,n),B.applyMatrix4(this),B.toArray(t,n);return t},applyToBuffer:function(t,e,i){void 0===O&&(O=new Ze.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length/t.itemSize);for(var r=0,n=e;r<i;r++,n++)O.x=t.getX(n),O.y=t.getY(n),O.z=t.getZ(n),O.applyMatrix4(this),t.setXYZ(O.x,O.y,O.z);return t},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],i=t[4],r=t[8],n=t[12],o=t[1],a=t[5],s=t[9],h=t[13],c=t[2],l=t[6],u=t[10],p=t[14];return t[3]*(+n*s*l-r*h*l-n*a*u+i*h*u+r*a*p-i*s*p)+t[7]*(+e*s*p-e*h*u+n*o*u-r*o*p+r*h*c-n*s*c)+t[11]*(+e*h*l-e*a*p-n*o*l+i*o*p+n*a*c-i*h*c)+t[15]*(-r*a*c-e*s*l+e*a*u+r*o*l-i*o*u+i*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){void 0===F&&(F=new Ze.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return F.set(t[12],t[13],t[14])},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,r=t.elements,n=r[0],o=r[4],a=r[8],s=r[12],h=r[1],c=r[5],l=r[9],u=r[13],p=r[2],d=r[6],f=r[10],m=r[14],g=r[3],y=r[7],v=r[11],x=r[15];i[0]=l*m*y-u*f*y+u*d*v-c*m*v-l*d*x+c*f*x,i[4]=s*f*y-a*m*y-s*d*v+o*m*v+a*d*x-o*f*x,i[8]=a*u*y-s*l*y+s*c*v-o*u*v-a*c*x+o*l*x,i[12]=s*l*d-a*u*d-s*c*f+o*u*f+a*c*m-o*l*m,i[1]=u*f*g-l*m*g-u*p*v+h*m*v+l*p*x-h*f*x,i[5]=a*m*g-s*f*g+s*p*v-n*m*v-a*p*x+n*f*x,i[9]=s*l*g-a*u*g-s*h*v+n*u*v+a*h*x-n*l*x,i[13]=a*u*p-s*l*p+s*h*f-n*u*f-a*h*m+n*l*m,i[2]=c*m*g-u*d*g+u*p*y-h*m*y-c*p*x+h*d*x,i[6]=s*d*g-o*m*g-s*p*y+n*m*y+o*p*x-n*d*x,i[10]=o*u*g-s*c*g+s*h*y-n*u*y-o*h*x+n*c*x,i[14]=s*c*p-o*u*p-s*h*d+n*u*d+o*h*m-n*c*m,i[3]=l*d*g-c*f*g-l*p*y+h*f*y+c*p*v-h*d*v,i[7]=o*f*g-a*d*g+a*p*y-n*f*y-o*p*v+n*d*v,i[11]=a*c*g-o*l*g-a*h*y+n*l*y+o*h*v-n*c*v,i[15]=o*l*p-a*c*p+a*h*d-n*l*d-o*h*f+n*c*f;var b=n*i[0]+h*i[4]+p*i[8]+g*i[12];if(0!==b)return this.multiplyScalar(1/b),this;var w="THREE.Matrix4.getInverse(): can\'t invert matrix, determinant is 0";if(e)throw new Error(w);return console.warn(w),this.identity(),this},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z;return e[0]*=i,e[4]*=r,e[8]*=n,e[1]*=i,e[5]*=r,e[9]*=n,e[2]*=i,e[6]*=r,e[10]*=n,e[3]*=i,e[7]*=r,e[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(i,r)))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=1-i,o=t.x,a=t.y,s=t.z,h=n*o,c=n*a;return this.set(h*o+i,h*a-r*s,h*s+r*a,0,h*a+r*s,c*a+i,c*s-r*o,0,h*s-r*a,c*s+r*o,n*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(t,e,i){void 0===R&&(R=new Ze.Vector3),void 0===D&&(D=new Ze.Matrix4);var r=this.elements,n=R.set(r[0],r[1],r[2]).length(),o=R.set(r[4],r[5],r[6]).length(),a=R.set(r[8],r[9],r[10]).length();this.determinant()<0&&(n=-n),t.x=r[12],t.y=r[13],t.z=r[14],D.elements.set(this.elements);var s=1/n,h=1/o,c=1/a;return D.elements[0]*=s,D.elements[1]*=s,D.elements[2]*=s,D.elements[4]*=h,D.elements[5]*=h,D.elements[6]*=h,D.elements[8]*=c,D.elements[9]*=c,D.elements[10]*=c,e.setFromRotationMatrix(D),i.x=n,i.y=o,i.z=a,this},makeFrustum:function(t,e,i,r,n,o){var a=this.elements,s=2*n/(e-t),h=2*n/(r-i),c=(e+t)/(e-t),l=(r+i)/(r-i),u=-(o+n)/(o-n),p=-2*o*n/(o-n);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=h,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,r){var n=i*Math.tan(Ze.Math.degToRad(.5*t)),o=-n,a=o*e,s=n*e;return this.makeFrustum(a,s,o,n,i,r)},makeOrthographic:function(t,e,i,r,n,o){var a=this.elements,s=e-t,h=i-r,c=o-n,l=(e+t)/s,u=(i+r)/h,p=(o+n)/c;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2/h,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,r=0;r<16;r++)if(e[r]!==i[r])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}},Ze.Ray=function(t,e){this.origin=void 0!==t?t:new Ze.Vector3,this.direction=void 0!==e?e:new Ze.Vector3},Ze.Ray.prototype={constructor:Ze.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new Ze.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:(Z=new Ze.Vector3,function(t){return this.origin.copy(this.at(t,Z)),this}),closestPointToPoint:function(t,e){var i=e||new Ze.Vector3;i.subVectors(t,this.origin);var r=i.dot(this.direction);return r<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:(Q=new Ze.Vector3,function(t){var e=Q.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Q.copy(this.direction).multiplyScalar(e).add(this.origin),Q.distanceToSquared(t))}),distanceSqToSegment:(q=new Ze.Vector3,Y=new Ze.Vector3,K=new Ze.Vector3,function(t,e,i,r){q.copy(t).add(e).multiplyScalar(.5),Y.copy(e).sub(t).normalize(),K.copy(this.origin).sub(q);var n,o,a,s,h=.5*t.distanceTo(e),c=-this.direction.dot(Y),l=K.dot(this.direction),u=-K.dot(Y),p=K.lengthSq(),d=Math.abs(1-c*c);if(0<d)if(o=c*l-u,s=h*d,0<=(n=c*u-l))if(-s<=o)if(o<=s){var f=1/d;a=(n*=f)*(n+c*(o*=f)+2*l)+o*(c*n+o+2*u)+p}else o=h,a=-(n=Math.max(0,-(c*o+l)))*n+o*(o+2*u)+p;else o=-h,a=-(n=Math.max(0,-(c*o+l)))*n+o*(o+2*u)+p;else a=o<=-s?-(n=Math.max(0,-(-c*h+l)))*n+(o=0<n?-h:Math.min(Math.max(-h,-u),h))*(o+2*u)+p:o<=s?(n=0,(o=Math.min(Math.max(-h,-u),h))*(o+2*u)+p):-(n=Math.max(0,-(c*h+l)))*n+(o=0<n?h:Math.min(Math.max(-h,-u),h))*(o+2*u)+p;else o=0<c?-h:h,a=-(n=Math.max(0,-(c*o+l)))*n+o*(o+2*u)+p;return i&&i.copy(this.direction).multiplyScalar(n).add(this.origin),r&&r.copy(Y).multiplyScalar(o).add(q),a}),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},intersectSphere:(X=new Ze.Vector3,function(t,e){X.subVectors(t.center,this.origin);var i=X.dot(this.direction),r=X.dot(X)-i*i,n=t.radius*t.radius;if(n<r)return null;var o=Math.sqrt(n-r),a=i-o,s=i+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}),isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return 0<=i?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},isIntersectionBox:(W=new Ze.Vector3,function(t){return null!==this.intersectBox(t,W)}),intersectBox:function(t,e){var i,r,n,o,a,s,h=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,u=this.origin;return r=0<=h?(i=(t.min.x-u.x)*h,(t.max.x-u.x)*h):(i=(t.max.x-u.x)*h,(t.min.x-u.x)*h),(o=0<=c?(n=(t.min.y-u.y)*c,(t.max.y-u.y)*c):(n=(t.max.y-u.y)*c,(t.min.y-u.y)*c))<i||r<n?null:((i<n||i!=i)&&(i=n),(o<r||r!=r)&&(r=o),(s=0<=l?(a=(t.min.z-u.z)*l,(t.max.z-u.z)*l):(a=(t.max.z-u.z)*l,(t.min.z-u.z)*l))<i||r<a?null:((i<a||i!=i)&&(i=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(0<=i?i:r,e)))},intersectTriangle:(I=new Ze.Vector3,G=new Ze.Vector3,j=new Ze.Vector3,H=new Ze.Vector3,function(t,e,i,r,n){G.subVectors(e,t),j.subVectors(i,t),H.crossVectors(G,j);var o,a=this.direction.dot(H);if(0<a){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}I.subVectors(this.origin,t);var s=o*this.direction.dot(j.crossVectors(I,j));if(s<0)return null;var h=o*this.direction.dot(G.cross(I));if(h<0)return null;if(a<s+h)return null;var c=-o*I.dot(H);return c<0?null:this.at(c/a,n)}),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},Ze.Sphere=function(t,e){this.center=void 0!==t?t:new Ze.Vector3,this.radius=void 0!==e?e:0},Ze.Sphere.prototype={constructor:Ze.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(J=new Ze.Box3,function(t,e){var i=this.center;void 0!==e?i.copy(e):J.setFromPoints(t).center(i);for(var r=0,n=0,o=t.length;n<o;n++)r=Math.max(r,i.distanceToSquared(t[n]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),r=e||new Ze.Vector3;return r.copy(t),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){var e=t||new Ze.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},Ze.Frustum=function(t,e,i,r,n,o){this.planes=[void 0!==t?t:new Ze.Plane,void 0!==e?e:new Ze.Plane,void 0!==i?i:new Ze.Plane,void 0!==r?r:new Ze.Plane,void 0!==n?n:new Ze.Plane,void 0!==o?o:new Ze.Plane]},Ze.Frustum.prototype={constructor:Ze.Frustum,set:function(t,e,i,r,n,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(r),a[4].copy(n),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,r=i[0],n=i[1],o=i[2],a=i[3],s=i[4],h=i[5],c=i[6],l=i[7],u=i[8],p=i[9],d=i[10],f=i[11],m=i[12],g=i[13],y=i[14],v=i[15];return e[0].setComponents(a-r,l-s,f-u,v-m).normalize(),e[1].setComponents(a+r,l+s,f+u,v+m).normalize(),e[2].setComponents(a+n,l+h,f+p,v+g).normalize(),e[3].setComponents(a-n,l-h,f-p,v-g).normalize(),e[4].setComponents(a-o,l-c,f-d,v-y).normalize(),e[5].setComponents(a+o,l+c,f+d,v+y).normalize(),this},intersectsObject:(et=new Ze.Sphere,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),et.copy(e.boundingSphere),et.applyMatrix4(t.matrixWorld),this.intersectsSphere(et)}),intersectsSphere:function(t){for(var e=this.planes,i=t.center,r=-t.radius,n=0;n<6;n++){if(e[n].distanceToPoint(i)<r)return!1}return!0},intersectsBox:($=new Ze.Vector3,tt=new Ze.Vector3,function(t){for(var e=this.planes,i=0;i<6;i++){var r=e[i];$.x=0<r.normal.x?t.min.x:t.max.x,tt.x=0<r.normal.x?t.max.x:t.min.x,$.y=0<r.normal.y?t.min.y:t.max.y,tt.y=0<r.normal.y?t.max.y:t.min.y,$.z=0<r.normal.z?t.min.z:t.max.z,tt.z=0<r.normal.z?t.max.z:t.min.z;var n=r.distanceToPoint($),o=r.distanceToPoint(tt);if(n<0&&o<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},Ze.Plane=function(t,e){this.normal=void 0!==t?t:new Ze.Vector3(1,0,0),this.constant=void 0!==e?e:0},Ze.Plane.prototype={constructor:Ze.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:(at=new Ze.Vector3,st=new Ze.Vector3,function(t,e,i){var r=at.subVectors(i,e).cross(st.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t);return(e||new Ze.Vector3).copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&0<i||i<0&&0<e},intersectLine:(ot=new Ze.Vector3,function(t,e){var i=e||new Ze.Vector3,r=t.delta(ot),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(t.start)?i.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/n;return o<0||1<o?void 0:i.copy(r).multiplyScalar(o).add(t.start)}),coplanarPoint:function(t){return(t||new Ze.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(it=new Ze.Vector3,rt=new Ze.Vector3,nt=new Ze.Matrix3,function(t,e){var i=e||nt.getNormalMatrix(t),r=it.copy(this.normal).applyMatrix3(i),n=this.coplanarPoint(rt);return n.applyMatrix4(t),this.setFromNormalAndCoplanarPoint(r,n),this}),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},Ze.Math={generateUUID:(ut="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),pt=new Array(36),dt=0,function(){for(var t=0;t<36;t++)pt[t]=8===t||13===t||18===t||23===t?"-":14===t?"4":(dt<=2&&(dt=33554432+16777216*Math.random()|0),lt=15&dt,dt>>=4,ut[19===t?3&lt|8:lt]);return pt.join("")}),clamp:function(t,e,i){return t<e?e:i<t?i:t},clampBottom:function(t,e){return t<e?e:t},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:(ct=Math.PI/180,function(t){return t*ct}),radToDeg:(ht=180/Math.PI,function(t){return t*ht}),isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},Ze.Spline=function(t){this.points=t;var e,i,r,n,o,a,s,h,c,l=[],u={x:0,y:0,z:0};function p(t,e,i,r,n,o,a){var s=.5*(i-t),h=.5*(r-e);return(2*(e-i)+s+h)*a+(-3*(e-i)-2*s-h)*o+s*n+e}this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return e=(this.points.length-1)*t,i=Math.floor(e),r=e-i,l[0]=0===i?i:i-1,l[1]=i,l[2]=i>this.points.length-2?this.points.length-1:i+1,l[3]=i>this.points.length-3?this.points.length-1:i+2,a=this.points[l[0]],s=this.points[l[1]],h=this.points[l[2]],c=this.points[l[3]],o=r*(n=r*r),u.x=p(a.x,s.x,h.x,c.x,r,n,o),u.y=p(a.y,s.y,h.y,c.y,r,n,o),u.z=p(a.z,s.z,h.z,c.z,r,n,o),u},this.getControlPointsArray=function(){var t,e,i=this.points.length,r=[];for(t=0;t<i;t++)e=this.points[t],r[t]=[e.x,e.y,e.z];return r},this.getLength=function(t){var e,i,r,n,o=0,a=0,s=0,h=new Ze.Vector3,c=new Ze.Vector3,l=[],u=0;for(l[0]=0,t||(t=100),r=this.points.length*t,h.copy(this.points[0]),e=1;e<r;e++)i=e/r,n=this.getPoint(i),c.copy(n),u+=c.distanceTo(h),h.copy(n),o=(this.points.length-1)*i,(a=Math.floor(o))!==s&&(l[a]=u,s=a);return l[l.length]=u,{chunks:l,total:u}},this.reparametrizeByArcLength=function(t){var e,i,r,n,o,a,s,h,c=[],l=new Ze.Vector3,u=this.getLength();for(c.push(l.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=u.chunks[e]-u.chunks[e-1],s=Math.ceil(t*a/u.total),n=(e-1)/(this.points.length-1),o=e/(this.points.length-1),i=1;i<s-1;i++)r=n+i*(1/s)*(o-n),h=this.getPoint(r),c.push(l.copy(h).clone());c.push(l.copy(this.points[e]).clone())}this.points=c}},Ze.Triangle=function(t,e,i){this.a=void 0!==t?t:new Ze.Vector3,this.b=void 0!==e?e:new Ze.Vector3,this.c=void 0!==i?i:new Ze.Vector3},Ze.Triangle.normal=(ft=new Ze.Vector3,function(t,e,i,r){var n=r||new Ze.Vector3;n.subVectors(i,e),ft.subVectors(t,e),n.cross(ft);var o=n.lengthSq();return 0<o?n.multiplyScalar(1/Math.sqrt(o)):n.set(0,0,0)}),Ze.Triangle.barycoordFromPoint=(mt=new Ze.Vector3,gt=new Ze.Vector3,yt=new Ze.Vector3,function(t,e,i,r,n){mt.subVectors(r,e),gt.subVectors(i,e),yt.subVectors(t,e);var o=mt.dot(mt),a=mt.dot(gt),s=mt.dot(yt),h=gt.dot(gt),c=gt.dot(yt),l=o*h-a*a,u=n||new Ze.Vector3;if(0===l)return u.set(-2,-1,-1);var p=1/l,d=(h*s-a*c)*p,f=(o*c-a*s)*p;return u.set(1-d-f,f,d)}),Ze.Triangle.containsPoint=(vt=new Ze.Vector3,function(t,e,i,r){var n=Ze.Triangle.barycoordFromPoint(t,e,i,r,vt);return 0<=n.x&&0<=n.y&&n.x+n.y<=1}),Ze.Triangle.prototype={constructor:Ze.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,r){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:(xt=new Ze.Vector3,bt=new Ze.Vector3,function(){return xt.subVectors(this.c,this.b),bt.subVectors(this.a,this.b),.5*xt.cross(bt).length()}),midpoint:function(t){return(t||new Ze.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return Ze.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new Ze.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return Ze.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Ze.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},Ze.Clock=function(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},Ze.Clock.prototype={constructor:Ze.Clock,start:function(){this.startTime=void 0!==Qe.performance&&void 0!==Qe.performance.now?Qe.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==Qe.performance&&void 0!==Qe.performance.now?Qe.performance.now():Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},Ze.EventDispatcher=function(){},Ze.EventDispatcher.prototype={constructor:Ze.EventDispatcher,apply:function(t){t.addEventListener=Ze.EventDispatcher.prototype.addEventListener,t.hasEventListener=Ze.EventDispatcher.prototype.hasEventListener,t.removeEventListener=Ze.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=Ze.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var r=i.indexOf(e);-1!==r&&i.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=[],r=e.length,n=0;n<r;n++)i[n]=e[n];for(n=0;n<r;n++)i[n].call(this,t)}}}},function(n){function o(t,e){return t.distance-e.distance}n.Raycaster=function(t,e,i,r){this.ray=new n.Ray(t,e),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})};var s=function(t,e,i,r){if(!1!==t.visible&&(t.raycast(e,i),!0===r))for(var n=t.children,o=0,a=n.length;o<a;o++)s(n[o],e,i,!0)};n.Raycaster.prototype={constructor:n.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e instanceof n.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e instanceof n.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return s(t,this,i,e),i.sort(o),i},intersectObjects:function(t,e){var i=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,n=t.length;r<n;r++)s(t[r],this,i,e);return i.sort(o),i}}}(Ze),Ze.Object3D=function(){Object.defineProperty(this,"id",{value:Ze.Object3DIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ze.Object3D.DefaultUp.clone();var t=new Ze.Vector3,e=new Ze.Euler,i=new Ze.Quaternion,r=new Ze.Vector3(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Ze.Matrix4},normalMatrix:{value:new Ze.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new Ze.Matrix4,this.matrixWorld=new Ze.Matrix4,this.matrixAutoUpdate=Ze.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},Ze.Object3D.DefaultUp=new Ze.Vector3(0,1,0),Ze.Object3D.DefaultMatrixAutoUpdate=!0,Ze.Object3D.prototype={constructor:Ze.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(t){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=t},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(Bt=new Ze.Quaternion,function(t,e){return Bt.setFromAxisAngle(t,e),this.quaternion.multiply(Bt),this}),rotateX:(Ot=new Ze.Vector3(1,0,0),function(t){return this.rotateOnAxis(Ot,t)}),rotateY:(Ft=new Ze.Vector3(0,1,0),function(t){return this.rotateOnAxis(Ft,t)}),rotateZ:(Dt=new Ze.Vector3(0,0,1),function(t){return this.rotateOnAxis(Dt,t)}),translateOnAxis:(Rt=new Ze.Vector3,function(t,e){return Rt.copy(t).applyQuaternion(this.quaternion),this.position.add(Rt.multiplyScalar(e)),this}),translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},translateX:(kt=new Ze.Vector3(1,0,0),function(t){return this.translateOnAxis(kt,t)}),translateY:(Pt=new Ze.Vector3(0,1,0),function(t){return this.translateOnAxis(Pt,t)}),translateZ:(Lt=new Ze.Vector3(0,0,1),function(t){return this.translateOnAxis(Lt,t)}),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(At=new Ze.Matrix4,function(t){return t.applyMatrix4(At.getInverse(this.matrixWorld))}),lookAt:(Et=new Ze.Matrix4,function(t){Et.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(Et)}),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can\'t be added as a child of itself.",t):t instanceof Ze.Object3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,r=this.children.length;i<r;i++){var n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}},getWorldPosition:function(t){var e=t||new Ze.Vector3;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Tt=new Ze.Vector3,Ct=new Ze.Vector3,function(t){var e=t||new Ze.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Tt,e,Ct),e}),getWorldRotation:(St=new Ze.Quaternion,function(t){var e=t||new Ze.Euler;return this.getWorldQuaternion(St),e.setFromQuaternion(St,this.rotation.order,!1)}),getWorldScale:(Mt=new Ze.Vector3,_t=new Ze.Quaternion,function(t){var e=t||new Ze.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Mt,_t,e),e}),getWorldDirection:(wt=new Ze.Quaternion,function(t){var e=t||new Ze.Vector3;return this.getWorldQuaternion(wt),e.set(0,0,1).applyQuaternion(wt)}),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t,i={};if(e&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"}),i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),!0!==this.visible&&(i.visible=this.visible),i.matrix=this.matrix.toArray(),0<this.children.length){i.children=[];for(var r=0;r<this.children.length;r++)i.children.push(this.children[r].toJSON(t).object)}var n={};if(e){var o=c(t.geometries),a=c(t.materials),s=c(t.textures),h=c(t.images);0<o.length&&(n.geometries=o),0<a.length&&(n.materials=a),0<s.length&&(n.textures=s),0<h.length&&(n.images=h)}return n.object=i,n;function c(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var r=t.children[i];this.add(r.clone())}return this}},Ze.EventDispatcher.prototype.apply(Ze.Object3D.prototype),Ze.Object3DIdCount=0,Ze.Face3=function(t,e,i,r,n,o){this.a=t,this.b=e,this.c=i,this.normal=r instanceof Ze.Vector3?r:new Ze.Vector3,this.vertexNormals=Array.isArray(r)?r:[],this.color=n instanceof Ze.Color?n:new Ze.Color,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==o?o:0},Ze.Face3.prototype={constructor:Ze.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},Ze.Face4=function(t,e,i,r,n,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Ze.Face3(t,e,i,n,o,a)},Ze.BufferAttribute=function(t,e){this.uuid=Ze.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},Ze.BufferAttribute.prototype={constructor:Ze.BufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[t+r]=e.array[i+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Ze.Color),e[i++]=o.r,e[i++]=o.g,e[i++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];e[i++]=o.a,e[i++]=o.b,e[i++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Ze.Vector2),e[i++]=o.x,e[i++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Ze.Vector3),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Ze.Vector4),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z,e[i++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this},clone:function(){return(new this.constructor).copy(this)}},Ze.Int8Attribute=function(t,e){return new Ze.BufferAttribute(new Int8Array(t),e)},Ze.Uint8Attribute=function(t,e){return new Ze.BufferAttribute(new Uint8Array(t),e)},Ze.Uint8ClampedAttribute=function(t,e){return new Ze.BufferAttribute(new Uint8ClampedArray(t),e)},Ze.Int16Attribute=function(t,e){return new Ze.BufferAttribute(new Int16Array(t),e)},Ze.Uint16Attribute=function(t,e){return new Ze.BufferAttribute(new Uint16Array(t),e)},Ze.Int32Attribute=function(t,e){return new Ze.BufferAttribute(new Int32Array(t),e)},Ze.Uint32Attribute=function(t,e){return new Ze.BufferAttribute(new Uint32Array(t),e)},Ze.Float32Attribute=function(t,e){return new Ze.BufferAttribute(new Float32Array(t),e)},Ze.Float64Attribute=function(t,e){return new Ze.BufferAttribute(new Float64Array(t),e)},Ze.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Ze.BufferAttribute(t,e).setDynamic(!0)},Ze.InstancedBufferAttribute=function(t,e,i){Ze.BufferAttribute.call(this,t,e),this.meshPerAttribute=i||1},Ze.InstancedBufferAttribute.prototype=Object.create(Ze.BufferAttribute.prototype),Ze.InstancedBufferAttribute.prototype.constructor=Ze.InstancedBufferAttribute,Ze.InstancedBufferAttribute.prototype.copy=function(t){return Ze.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Ze.InterleavedBuffer=function(t,e){this.uuid=Ze.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},Ze.InterleavedBuffer.prototype={constructor:Ze.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var r=0,n=this.stride;r<n;r++)this.array[t+r]=e.array[i+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},Ze.InstancedInterleavedBuffer=function(t,e,i){Ze.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=i||1},Ze.InstancedInterleavedBuffer.prototype=Object.create(Ze.InterleavedBuffer.prototype),Ze.InstancedInterleavedBuffer.prototype.constructor=Ze.InstancedInterleavedBuffer,Ze.InstancedInterleavedBuffer.prototype.copy=function(t){return Ze.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Ze.InterleavedBufferAttribute=function(t,e,i){this.uuid=Ze.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=i},Ze.InterleavedBufferAttribute.prototype={constructor:Ze.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.array.length/this.data.stride},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this.data.array[t+3]=n,this}},Ze.Geometry=function(){Object.defineProperty(this,"id",{value:Ze.GeometryIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},Ze.Geometry.prototype={constructor:Ze.Geometry,applyMatrix:function(t){for(var e=(new Ze.Matrix3).getNormalMatrix(t),i=0,r=this.vertices.length;i<r;i++){this.vertices[i].applyMatrix4(t)}for(i=0,r=this.faces.length;i<r;i++){var n=this.faces[i];n.normal.applyMatrix3(e).normalize();for(var o=0,a=n.vertexNormals.length;o<a;o++)n.vertexNormals[o].applyMatrix3(e).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},rotateX:function(t){return void 0===Gt&&(Gt=new Ze.Matrix4),Gt.makeRotationX(t),this.applyMatrix(Gt),this},rotateY:function(t){return void 0===It&&(It=new Ze.Matrix4),It.makeRotationY(t),this.applyMatrix(It),this},rotateZ:function(t){return void 0===zt&&(zt=new Ze.Matrix4),zt.makeRotationZ(t),this.applyMatrix(zt),this},translate:function(t,e,i){return void 0===Nt&&(Nt=new Ze.Matrix4),Nt.makeTranslation(t,e,i),this.applyMatrix(Nt),this},scale:function(t,e,i){return void 0===Vt&&(Vt=new Ze.Matrix4),Vt.makeScale(t,e,i),this.applyMatrix(Vt),this},lookAt:function(t){void 0===Ut&&(Ut=new Ze.Object3D),Ut.lookAt(t),Ut.updateMatrix(),this.applyMatrix(Ut.matrix)},fromBufferGeometry:function(t){var a=this,e=null!==t.index?t.index.array:void 0,i=t.attributes,r=i.position.array,s=void 0!==i.normal?i.normal.array:void 0,h=void 0!==i.color?i.color.array:void 0,c=void 0!==i.uv?i.uv.array:void 0,l=void 0!==i.uv2?i.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=[],p=[],d=[],n=0,o=0,f=0;n<r.length;n+=3,o+=2,f+=4)a.vertices.push(new Ze.Vector3(r[n],r[n+1],r[n+2])),void 0!==s&&u.push(new Ze.Vector3(s[n],s[n+1],s[n+2])),void 0!==h&&a.colors.push(new Ze.Color(h[n],h[n+1],h[n+2])),void 0!==c&&p.push(new Ze.Vector2(c[o],c[o+1])),void 0!==l&&d.push(new Ze.Vector2(l[o],l[o+1]));var m=function(t,e,i){var r=void 0!==s?[u[t].clone(),u[e].clone(),u[i].clone()]:[],n=void 0!==h?[a.colors[t].clone(),a.colors[e].clone(),a.colors[i].clone()]:[],o=new Ze.Face3(t,e,i,r,n);a.faces.push(o),void 0!==c&&a.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[i].clone()]),void 0!==l&&a.faceVertexUvs[1].push([d[t].clone(),d[e].clone(),d[i].clone()])};if(void 0!==e){var g=t.groups;if(0<g.length)for(n=0;n<g.length;n++)for(var y=g[n],v=y.start,x=(o=v,v+y.count);o<x;o+=3)m(e[o],e[o+1],e[o+2]);else for(n=0;n<e.length;n+=3)m(e[n],e[n+1],e[n+2])}else for(n=0;n<r.length/3;n+=3)m(n,n+1,n+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,r=new Ze.Matrix4;return r.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new Ze.Vector3,e=new Ze.Vector3,i=0,r=this.faces.length;i<r;i++){var n=this.faces[i],o=this.vertices[n.a],a=this.vertices[n.b],s=this.vertices[n.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),n.normal.copy(t)}},computeVertexNormals:function(t){var e,i,r,n,o,a;for(a=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)a[e]=new Ze.Vector3;if(t){var s,h,c,l=new Ze.Vector3,u=new Ze.Vector3;for(r=0,n=this.faces.length;r<n;r++)o=this.faces[r],s=this.vertices[o.a],h=this.vertices[o.b],c=this.vertices[o.c],l.subVectors(c,h),u.subVectors(s,h),l.cross(u),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(r=0,n=this.faces.length;r<n;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,i=this.vertices.length;e<i;e++)a[e].normalize();for(r=0,n=this.faces.length;r<n;r++){var p=(o=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}},computeMorphNormals:function(){var t,e,i,r,n;for(i=0,r=this.faces.length;i<r;i++)for((n=this.faces[i]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),t=0,e=n.vertexNormals.length;t<e;t++)n.__originalVertexNormals[t]?n.__originalVertexNormals[t].copy(n.vertexNormals[t]):n.__originalVertexNormals[t]=n.vertexNormals[t].clone();var o=new Ze.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(i=0,r=this.faces.length;i<r;i++)h=new Ze.Vector3,c={a:new Ze.Vector3,b:new Ze.Vector3,c:new Ze.Vector3},a.push(h),s.push(c)}var h,c,l=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)n=this.faces[i],h=l.faceNormals[i],c=l.vertexNormals[i],h.copy(n.normal),c.a.copy(n.vertexNormals[0]),c.b.copy(n.vertexNormals[1]),c.c.copy(n.vertexNormals[2])}for(i=0,r=this.faces.length;i<r;i++)(n=this.faces[i]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,r=e.length;i<r;i++)0<i&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ze.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ze.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t instanceof Ze.Geometry!=!1){var r,n=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,h=t.faces,c=this.faceVertexUvs[0],l=t.faceVertexUvs[0];void 0===i&&(i=0),void 0!==e&&(r=(new Ze.Matrix3).getNormalMatrix(e));for(var u=0,p=a.length;u<p;u++){var d=a[u].clone();void 0!==e&&d.applyMatrix4(e),o.push(d)}for(u=0,p=h.length;u<p;u++){var f,m,g,y=h[u],v=y.vertexNormals,x=y.vertexColors;(f=new Ze.Face3(y.a+n,y.b+n,y.c+n)).normal.copy(y.normal),void 0!==r&&f.normal.applyMatrix3(r).normalize();for(var b=0,w=v.length;b<w;b++)m=v[b].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),f.vertexNormals.push(m);f.color.copy(y.color);for(b=0,w=x.length;b<w;b++)g=x[b],f.vertexColors.push(g.clone());f.materialIndex=y.materialIndex+i,s.push(f)}for(u=0,p=l.length;u<p;u++){var M=l[u],_=[];if(void 0!==M){for(b=0,w=M.length;b<w;b++)_.push(M[b].clone());c.push(_)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t instanceof Ze.Mesh!=!1?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,i,r,n,o,a,s,h={},c=[],l=[],u=Math.pow(10,4);for(i=0,r=this.vertices.length;i<r;i++)t=this.vertices[i],void 0===h[e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u)]?(h[e]=i,c.push(this.vertices[i]),l[i]=c.length-1):l[i]=l[h[e]];var p=[];for(i=0,r=this.faces.length;i<r;i++){(n=this.faces[i]).a=l[n.a],n.b=l[n.b],n.c=l[n.c],o=[n.a,n.b,n.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){d,p.push(i);break}}for(i=p.length-1;0<=i;i--){var f=p[i];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},toJSON:function(){var t={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}for(var r=[],n=0;n<this.vertices.length;n++){var o=this.vertices[n];r.push(o.x,o.y,o.z)}var a=[],s=[],h={},c=[],l={},u=[],p={};for(n=0;n<this.faces.length;n++){var d=this.faces[n],f=void 0!==this.faceVertexUvs[0][n],m=0<d.normal.length(),g=0<d.vertexNormals.length,y=1!==d.color.r||1!==d.color.g||1!==d.color.b,v=0<d.vertexColors.length,x=0;if(x=_(x=_(x=_(x=_(x=_(x=_(x=_(x=_(x,0,0),1,!1),2,!1),3,f),4,m),5,g),6,y),7,v),a.push(x),a.push(d.a,d.b,d.c),f){var b=this.faceVertexUvs[0][n];a.push(C(b[0]),C(b[1]),C(b[2]))}if(m&&a.push(S(d.normal)),g){var w=d.vertexNormals;a.push(S(w[0]),S(w[1]),S(w[2]))}if(y&&a.push(T(d.color)),v){var M=d.vertexColors;a.push(T(M[0]),T(M[1]),T(M[2]))}}function _(t,e,i){return i?t|1<<e:t&~(1<<e)}function S(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==h[e]||(h[e]=s.length/3,s.push(t.x,t.y,t.z)),h[e]}function T(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]||(l[e]=c.length,c.push(t.getHex())),l[e]}function C(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]||(p[e]=u.length/2,u.push(t.x,t.y)),p[e]}return t.data={},t.data.vertices=r,t.data.normals=s,0<c.length&&(t.data.colors=c),0<u.length&&(t.data.uvs=[u]),t.data.faces=a,t},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,i=0,r=e.length;i<r;i++)this.vertices.push(e[i].clone());var n=t.faces;for(i=0,r=n.length;i<r;i++)this.faces.push(n[i].clone());for(i=0,r=t.faceVertexUvs.length;i<r;i++){var o=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var a=0,s=o.length;a<s;a++){for(var h=o[a],c=[],l=0,u=h.length;l<u;l++){var p=h[l];c.push(p.clone())}this.faceVertexUvs[i].push(c)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Ze.EventDispatcher.prototype.apply(Ze.Geometry.prototype),Ze.GeometryIdCount=0,Ze.DirectGeometry=function(){Object.defineProperty(this,"id",{value:Ze.GeometryIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},Ze.DirectGeometry.prototype={constructor:Ze.DirectGeometry,computeBoundingBox:Ze.Geometry.prototype.computeBoundingBox,computeBoundingSphere:Ze.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,i,r=[],n=t.faces,o=0;o<n.length;o++){var a=n[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,r.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,r.push(e)),this.groups=r},fromGeometry:function(t){var e=t.faces,i=t.vertices,r=t.faceVertexUvs,n=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,a=t.morphTargets,s=a.length;if(0<s){for(var h=[],c=0;c<s;c++)h[c]=[];this.morphTargets.position=h}var l=t.morphNormals,u=l.length;if(0<u){var p=[];for(c=0;c<u;c++)p[c]=[];this.morphTargets.normal=p}var d=t.skinIndices,f=t.skinWeights,m=d.length===i.length,g=f.length===i.length;for(c=0;c<e.length;c++){var y=e[c];this.vertices.push(i[y.a],i[y.b],i[y.c]);var v=y.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{var x=y.normal;this.normals.push(x,x,x)}var b,w=y.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var M=y.color;this.colors.push(M,M,M)}if(!0===n)void 0!==(b=r[0][c])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new Ze.Vector2,new Ze.Vector2,new Ze.Vector2));if(!0===o)void 0!==(b=r[1][c])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new Ze.Vector2,new Ze.Vector2,new Ze.Vector2));for(var _=0;_<s;_++){var S=a[_].vertices;h[_].push(S[y.a],S[y.b],S[y.c])}for(_=0;_<u;_++){var T=l[_].vertexNormals[c];p[_].push(T.a,T.b,T.c)}m&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),g&&this.skinWeights.push(f[y.a],f[y.b],f[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Ze.EventDispatcher.prototype.apply(Ze.DirectGeometry.prototype),Ze.BufferGeometry=function(){Object.defineProperty(this,"id",{value:Ze.GeometryIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},Ze.BufferGeometry.prototype={constructor:Ze.BufferGeometry,addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){if(e instanceof Ze.BufferAttribute==!1&&e instanceof Ze.InterleavedBufferAttribute==!1)return console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new Ze.BufferAttribute(e,arguments[2]));"index"===t&&(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)),this.attributes[t]=e},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){delete this.attributes[t]},get drawcalls(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups},get offsets(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new Ze.Matrix3).getNormalMatrix(t).applyToVector3Array(i.array),i.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(t){return void 0===Zt&&(Zt=new Ze.Matrix4),Zt.makeRotationX(t),this.applyMatrix(Zt),this},rotateY:function(t){return void 0===Qt&&(Qt=new Ze.Matrix4),Qt.makeRotationY(t),this.applyMatrix(Qt),this},rotateZ:function(t){return void 0===Kt&&(Kt=new Ze.Matrix4),Kt.makeRotationZ(t),this.applyMatrix(Kt),this},translate:function(t,e,i){return void 0===Yt&&(Yt=new Ze.Matrix4),Yt.makeTranslation(t,e,i),this.applyMatrix(Yt),this},scale:function(t,e,i){return void 0===qt&&(qt=new Ze.Matrix4),qt.makeScale(t,e,i),this.applyMatrix(qt),this},lookAt:function(t){void 0===Xt&&(Xt=new Ze.Object3D),Xt.lookAt(t),Xt.updateMatrix(),this.applyMatrix(Xt.matrix)},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t instanceof Ze.Points||t instanceof Ze.Line){var i=new Ze.Float32Attribute(3*e.vertices.length,3),r=new Ze.Float32Attribute(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var n=new Ze.Float32Attribute(e.lineDistances.length,1);this.addAttribute("lineDistance",n.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof Ze.Mesh&&e instanceof Ze.Geometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e,i=t.geometry;if(t instanceof Ze.Mesh){var r=i.__directGeometry;if(void 0===r)return this.fromGeometry(i);r.verticesNeedUpdate=i.verticesNeedUpdate,r.normalsNeedUpdate=i.normalsNeedUpdate,r.colorsNeedUpdate=i.colorsNeedUpdate,r.uvsNeedUpdate=i.uvsNeedUpdate,r.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=r}!0===i.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1);!0===i.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1);!0===i.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1);i.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1);return i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Ze.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new Ze.BufferAttribute(e,3).copyVector3sArray(t.vertices)),0<t.normals.length){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new Ze.BufferAttribute(i,3).copyVector3sArray(t.normals))}if(0<t.colors.length){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new Ze.BufferAttribute(r,3).copyColorsArray(t.colors))}if(0<t.uvs.length){var n=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new Ze.BufferAttribute(n,2).copyVector2sArray(t.uvs))}if(0<t.uvs2.length){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new Ze.BufferAttribute(o,2).copyVector2sArray(t.uvs2))}if(0<t.indices.length){var a=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length);this.setIndex(new Ze.BufferAttribute(a,1).copyIndicesArray(t.indices))}for(var s in this.groups=t.groups,t.morphTargets){for(var h=[],c=t.morphTargets[s],l=0,u=c.length;l<u;l++){var p=c[l],d=new Ze.Float32Attribute(3*p.length,3);h.push(d.copyVector3sArray(p))}this.morphAttributes[s]=h}if(0<t.skinIndices.length){var f=new Ze.Float32Attribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(0<t.skinWeights.length){var m=new Ze.Float32Attribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:(Wt=new Ze.Vector3,function(){null===this.boundingBox&&(this.boundingBox=new Ze.Box3);var t=this.attributes.position.array;if(t){var e=this.boundingBox;e.makeEmpty();for(var i=0,r=t.length;i<r;i+=3)Wt.fromArray(t,i),e.expandByPoint(Wt)}void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error(\'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.\',this)}),computeBoundingSphere:(jt=new Ze.Box3,Ht=new Ze.Vector3,function(){null===this.boundingSphere&&(this.boundingSphere=new Ze.Sphere);var t=this.attributes.position.array;if(t){jt.makeEmpty();for(var e=this.boundingSphere.center,i=0,r=t.length;i<r;i+=3)Ht.fromArray(t,i),jt.expandByPoint(Ht);jt.center(e);var n=0;for(i=0,r=t.length;i<r;i+=3)Ht.fromArray(t,i),n=Math.max(n,e.distanceToSquared(Ht));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error(\'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.\',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new Ze.BufferAttribute(new Float32Array(r.length),3));else for(var n=0,o=(c=e.normal.array).length;n<o;n++)c[n]=0;var a,s,h,c=e.normal.array,l=new Ze.Vector3,u=new Ze.Vector3,p=new Ze.Vector3,d=new Ze.Vector3,f=new Ze.Vector3;if(t){var m=t.array;0===i.length&&this.addGroup(0,m.length);for(var g=0,y=i.length;g<y;++g){var v=i[g],x=v.start;for(n=x,o=x+v.count;n<o;n+=3)a=3*m[n+0],s=3*m[n+1],h=3*m[n+2],l.fromArray(r,a),u.fromArray(r,s),p.fromArray(r,h),d.subVectors(p,u),f.subVectors(l,u),d.cross(f),c[a]+=d.x,c[a+1]+=d.y,c[a+2]+=d.z,c[s]+=d.x,c[s+1]+=d.y,c[s+2]+=d.z,c[h]+=d.x,c[h+1]+=d.y,c[h+2]+=d.z}}else for(n=0,o=r.length;n<o;n+=9)l.fromArray(r,n),u.fromArray(r,n+3),p.fromArray(r,n+6),d.subVectors(p,u),f.subVectors(l,u),d.cross(f),c[n]=d.x,c[n+1]=d.y,c[n+2]=d.z,c[n+3]=d.x,c[n+4]=d.y,c[n+5]=d.z,c[n+6]=d.x,c[n+7]=d.y,c[n+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(t){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(t,e){if(t instanceof Ze.BufferGeometry!=!1){void 0===e&&(e=0);var i=this.attributes;for(var r in i)if(void 0!==t.attributes[r])for(var n=i[r].array,o=t.attributes[r],a=o.array,s=0,h=o.itemSize*e;s<a.length;s++,h++)n[h]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,i,r,n=this.attributes.normal.array,o=0,a=n.length;o<a;o+=3)t=n[o],e=n[o+1],i=n[o+2],r=1/Math.sqrt(t*t+e*e+i*i),n[o]*=r,n[o+1]*=r,n[o+2]*=r},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var n=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:n}}var o=this.attributes;for(var i in o){var a=o[i];n=Array.prototype.slice.call(a.array);t.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:n}}var s=this.groups;0<s.length&&(t.data.groups=JSON.parse(JSON.stringify(s)));var h=this.boundingSphere;return null!==h&&(t.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),t},clone:function(){return(new this.constructor).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var r in i){var n=i[r];this.addAttribute(r,n.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var h=o[a];this.addGroup(h.start,h.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Ze.EventDispatcher.prototype.apply(Ze.BufferGeometry.prototype),Ze.BufferGeometry.MaxIndex=65535,Ze.InstancedBufferGeometry=function(){Ze.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},Ze.InstancedBufferGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.InstancedBufferGeometry.prototype.constructor=Ze.InstancedBufferGeometry,Ze.InstancedBufferGeometry.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,instances:i})},Ze.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var r in i){var n=i[r];this.addAttribute(r,n.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var h=o[a];this.addGroup(h.start,h.count,h.instances)}return this},Ze.EventDispatcher.prototype.apply(Ze.InstancedBufferGeometry.prototype),Ze.Camera=function(){Ze.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new Ze.Matrix4,this.projectionMatrix=new Ze.Matrix4},Ze.Camera.prototype=Object.create(Ze.Object3D.prototype),Ze.Camera.prototype.constructor=Ze.Camera,Ze.Camera.prototype.getWorldDirection=(Jt=new Ze.Quaternion,function(t){var e=t||new Ze.Vector3;return this.getWorldQuaternion(Jt),e.set(0,0,-1).applyQuaternion(Jt)}),Ze.Camera.prototype.lookAt=($t=new Ze.Matrix4,function(t){$t.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix($t)}),Ze.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},Ze.Camera.prototype.copy=function(t){return Ze.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},Ze.CubeCamera=function(t,e,i){Ze.Object3D.call(this),this.type="CubeCamera";var n=new Ze.PerspectiveCamera(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new Ze.Vector3(1,0,0)),this.add(n);var o=new Ze.PerspectiveCamera(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new Ze.Vector3(-1,0,0)),this.add(o);var a=new Ze.PerspectiveCamera(90,1,t,e);a.up.set(0,0,1),a.lookAt(new Ze.Vector3(0,1,0)),this.add(a);var s=new Ze.PerspectiveCamera(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new Ze.Vector3(0,-1,0)),this.add(s);var h=new Ze.PerspectiveCamera(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new Ze.Vector3(0,0,1)),this.add(h);var c=new Ze.PerspectiveCamera(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new Ze.Vector3(0,0,-1)),this.add(c),this.renderTarget=new Ze.WebGLRenderTargetCube(i,i,{format:Ze.RGBFormat,magFilter:Ze.LinearFilter,minFilter:Ze.LinearFilter}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,r=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,o,i),i.activeCubeFace=2,t.render(e,a,i),i.activeCubeFace=3,t.render(e,s,i),i.activeCubeFace=4,t.render(e,h,i),i.generateMipmaps=r,i.activeCubeFace=5,t.render(e,c,i),t.setRenderTarget(null)}},Ze.CubeCamera.prototype=Object.create(Ze.Object3D.prototype),Ze.CubeCamera.prototype.constructor=Ze.CubeCamera,Ze.OrthographicCamera=function(t,e,i,r,n,o){Ze.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=i,this.bottom=r,this.near=void 0!==n?n:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},Ze.OrthographicCamera.prototype=Object.create(Ze.Camera.prototype),Ze.OrthographicCamera.prototype.constructor=Ze.OrthographicCamera,Ze.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(i-t,i+t,r+e,r-e,this.near,this.far)},Ze.OrthographicCamera.prototype.copy=function(t){return Ze.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},Ze.OrthographicCamera.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,e},Ze.PerspectiveCamera=function(t,e,i,r){Ze.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},Ze.PerspectiveCamera.prototype=Object.create(Ze.Camera.prototype),Ze.PerspectiveCamera.prototype.constructor=Ze.PerspectiveCamera,Ze.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*Ze.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},Ze.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,r,n,o){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=r,this.width=n,this.height=o,this.updateProjectionMatrix()},Ze.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=Ze.Math.radToDeg(2*Math.atan(Math.tan(.5*Ze.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,i=Math.tan(Ze.Math.degToRad(.5*t))*this.near,r=-i,n=e*r,o=e*i,a=Math.abs(o-n),s=Math.abs(i-r);this.projectionMatrix.makeFrustum(n+this.x*a/this.fullWidth,n+(this.x+this.width)*a/this.fullWidth,i-(this.y+this.height)*s/this.fullHeight,i-this.y*s/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},Ze.PerspectiveCamera.prototype.copy=function(t){return Ze.Camera.prototype.copy.call(this,t),this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},Ze.PerspectiveCamera.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.fov=this.fov,e.object.aspect=this.aspect,e.object.near=this.near,e.object.far=this.far,e},Ze.Light=function(t){Ze.Object3D.call(this),this.type="Light",this.color=new Ze.Color(t)},Ze.Light.prototype=Object.create(Ze.Object3D.prototype),Ze.Light.prototype.constructor=Ze.Light,Ze.Light.prototype.copy=function(t){return Ze.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this},Ze.AmbientLight=function(t){Ze.Light.call(this,t),this.type="AmbientLight"},Ze.AmbientLight.prototype=Object.create(Ze.Light.prototype),Ze.AmbientLight.prototype.constructor=Ze.AmbientLight,Ze.AmbientLight.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e},Ze.DirectionalLight=function(t,e){Ze.Light.call(this,t),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new Ze.Object3D,this.intensity=void 0!==e?e:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},Ze.DirectionalLight.prototype=Object.create(Ze.Light.prototype),Ze.DirectionalLight.prototype.constructor=Ze.DirectionalLight,Ze.DirectionalLight.prototype.copy=function(t){return Ze.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.target=t.target.clone(),this.castShadow=t.castShadow,this.onlyShadow=t.onlyShadow,this.shadowCameraNear=t.shadowCameraNear,this.shadowCameraFar=t.shadowCameraFar,this.shadowCameraLeft=t.shadowCameraLeft,this.shadowCameraRight=t.shadowCameraRight,this.shadowCameraTop=t.shadowCameraTop,this.shadowCameraBottom=t.shadowCameraBottom,this.shadowCameraVisible=t.shadowCameraVisible,this.shadowBias=t.shadowBias,this.shadowDarkness=t.shadowDarkness,this.shadowMapWidth=t.shadowMapWidth,this.shadowMapHeight=t.shadowMapHeight,this},Ze.DirectionalLight.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,e},Ze.HemisphereLight=function(t,e,i){Ze.Light.call(this,t),this.type="HemisphereLight",this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new Ze.Color(e),this.intensity=void 0!==i?i:1},Ze.HemisphereLight.prototype=Object.create(Ze.Light.prototype),Ze.HemisphereLight.prototype.constructor=Ze.HemisphereLight,Ze.HemisphereLight.prototype.copy=function(t){return Ze.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this.intensity=t.intensity,this},Ze.HemisphereLight.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.groundColor=this.groundColor.getHex(),e.object.intensity=this.intensity,e},Ze.PointLight=function(t,e,i,r){Ze.Light.call(this,t),this.type="PointLight",this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0,this.decay=void 0!==r?r:1},Ze.PointLight.prototype=Object.create(Ze.Light.prototype),Ze.PointLight.prototype.constructor=Ze.PointLight,Ze.PointLight.prototype.copy=function(t){return Ze.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.decay=t.decay,this},Ze.PointLight.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,e.object.distance=this.distance,e.object.decay=this.decay,e},Ze.SpotLight=function(t,e,i,r,n,o){Ze.Light.call(this,t),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new Ze.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0,this.angle=void 0!==r?r:Math.PI/3,this.exponent=void 0!==n?n:10,this.decay=void 0!==o?o:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},Ze.SpotLight.prototype=Object.create(Ze.Light.prototype),Ze.SpotLight.prototype.constructor=Ze.SpotLight,Ze.SpotLight.prototype.copy=function(t){return Ze.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.angle=t.angle,this.exponent=t.exponent,this.decay=t.decay,this.target=t.target.clone(),this.castShadow=t.castShadow,this.onlyShadow=t.onlyShadow,this.shadowCameraNear=t.shadowCameraNear,this.shadowCameraFar=t.shadowCameraFar,this.shadowCameraFov=t.shadowCameraFov,this.shadowCameraVisible=t.shadowCameraVisible,this.shadowBias=t.shadowBias,this.shadowDarkness=t.shadowDarkness,this.shadowMapWidth=t.shadowMapWidth,this.shadowMapHeight=t.shadowMapHeight,this},Ze.SpotLight.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,e.object.distance=this.distance,e.object.angle=this.angle,e.object.exponent=this.exponent,e.object.decay=this.decay,e},Ze.Cache={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Ze.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},Ze.Loader.prototype={constructor:Ze.Loader,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var r=[],n=0;n<t.length;++n)r[n]=this.createMaterial(t[n],e,i);return r},createMaterial:function(t,u,p){function d(t){var e=Math.log(t)/Math.LN2;return Math.pow(2,Math.round(e))}function e(t,e,i,r,n,o,a){var s,h=u+i,c=Ze.Loader.Handlers.get(h);if(null!==c?s=c.load(h):(s=new Ze.Texture,(c=te).setCrossOrigin(p),c.load(h,function(t){if(!1===Ze.Math.isPowerOfTwo(t.width)||!1===Ze.Math.isPowerOfTwo(t.height)){var e=d(t.width),i=d(t.height),r=document.createElement("canvas");r.width=e,r.height=i,r.getContext("2d").drawImage(t,0,0,e,i),s.image=r}else s.image=t;s.needsUpdate=!0})),s.sourceFile=i,r&&(s.repeat.set(r[0],r[1]),1!==r[0]&&(s.wrapS=Ze.RepeatWrapping),1!==r[1]&&(s.wrapT=Ze.RepeatWrapping)),n&&s.offset.set(n[0],n[1]),o){var l={repeat:Ze.RepeatWrapping,mirror:Ze.MirroredRepeatWrapping};void 0!==l[o[0]]&&(s.wrapS=l[o[0]]),void 0!==l[o[1]]&&(s.wrapT=l[o[1]])}a&&(s.anisotropy=a),t[e]=s}function i(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}void 0===p&&void 0!==this.crossOrigin&&(p=this.crossOrigin),void 0===te&&(te=new Ze.ImageLoader);var r="MeshLambertMaterial",n={};if(t.shading){var o=t.shading.toLowerCase();"phong"===o?r="MeshPhongMaterial":"basic"===o&&(r="MeshBasicMaterial")}void 0!==t.blending&&void 0!==Ze[t.blending]&&(n.blending=Ze[t.blending]),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.opacity&&t.opacity<1&&(n.transparent=!0),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.flipSided&&(n.side=Ze.BackSide),void 0!==t.doubleSided&&(n.side=Ze.DoubleSide),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?n.vertexColors=Ze.FaceColors:t.vertexColors&&(n.vertexColors=Ze.VertexColors)),t.colorDiffuse?n.color=i(t.colorDiffuse):t.DbgColor&&(n.color=t.DbgColor),t.colorEmissive&&(n.emissive=i(t.colorEmissive)),"MeshPhongMaterial"===r&&(t.colorSpecular&&(n.specular=i(t.colorSpecular)),t.specularCoef&&(n.shininess=t.specularCoef)),void 0!==t.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),t.opacity=t.transparency),void 0!==t.opacity&&(n.opacity=t.opacity),u&&(t.mapDiffuse&&e(n,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e(n,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapAO&&e(n,"aoMap",t.mapAO,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy),t.mapBump&&e(n,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e(n,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e(n,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapAlpha&&e(n,"alphaMap",t.mapAlpha,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy)),t.mapBumpScale&&(n.bumpScale=t.mapBumpScale),t.mapNormalFactor&&(n.normalScale=new Ze.Vector2(t.mapNormalFactor,t.mapNormalFactor));var a=new Ze[r](n);return void 0!==t.DbgName&&(a.name=t.DbgName),a}},Ze.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=0,i=this.handlers.length;e<i;e+=2){var r=this.handlers[e],n=this.handlers[e+1];if(r.test(t))return n}return null}},Ze.XHRLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager},Ze.XHRLoader.prototype={constructor:Ze.XHRLoader,load:function(e,i,r,n){var o=this,t=Ze.Cache.get(e);if(void 0!==t)return i&&setTimeout(function(){i(t)},0),t;var a=new XMLHttpRequest;return a.open("GET",e,!0),a.addEventListener("load",function(t){Ze.Cache.add(e,this.response),i&&i(this.response),o.manager.itemEnd(e)},!1),void 0!==r&&a.addEventListener("progress",function(t){r(t)},!1),a.addEventListener("error",function(t){n&&n(t),o.manager.itemError(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),o.manager.itemStart(e),a},setResponseType:function(t){this.responseType=t},setCrossOrigin:function(t){this.crossOrigin=t},setWithCredentials:function(t){this.withCredentials=t}},Ze.ImageLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager},Ze.ImageLoader.prototype={constructor:Ze.ImageLoader,load:function(e,i,r,n){var o=this,t=Ze.Cache.get(e);if(void 0!==t)return i&&setTimeout(function(){i(t)},0),t;var a=document.createElement("img");return a.addEventListener("load",function(t){Ze.Cache.add(e,this),i&&i(this),o.manager.itemEnd(e)},!1),void 0!==r&&a.addEventListener("progress",function(t){r(t)},!1),a.addEventListener("error",function(t){n&&n(t),o.manager.itemError(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(t){this.crossOrigin=t}},Ze.JSONLoader=function(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Ze.DefaultLoadingManager,this.withCredentials=!1},Ze.JSONLoader.prototype={constructor:Ze.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(n,o,t,e){var a=this,s=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ze.Loader.prototype.extractUrlBase(n),i=new Ze.XHRLoader(this.manager);i.setCrossOrigin(this.crossOrigin),i.setWithCredentials(this.withCredentials),i.load(n,function(t){var e=JSON.parse(t),i=e.metadata;if(void 0!==i){if("object"===i.type)return void console.error("THREE.JSONLoader: "+n+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.type)return void console.error("THREE.JSONLoader: "+n+" should be loaded with THREE.SceneLoader instead.")}var r=a.parse(e,s);o(r.geometry,r.materials)})},setCrossOrigin:function(t){this.crossOrigin=t},setTexturePath:function(t){this.texturePath=t},parse:function(F,t){var O=new Ze.Geometry,e=void 0!==F.scale?1/F.scale:1;if(function(t){function e(t,e){return t&1<<e}var i,r,n,o,a,s,h,c,l,u,p,d,f,m,g,y,v,x,b,w,M,_,S,T,C,E,A,L=F.faces,P=F.vertices,k=F.normals,R=F.colors,D=0;if(void 0!==F.uvs){for(i=0;i<F.uvs.length;i++)F.uvs[i].length&&D++;for(i=0;i<D;i++)O.faceVertexUvs[i]=[]}o=0,a=P.length;for(;o<a;)(x=new Ze.Vector3).x=P[o++]*t,x.y=P[o++]*t,x.z=P[o++]*t,O.vertices.push(x);o=0,a=L.length;for(;o<a;)if(u=L[o++],p=e(u,0),d=e(u,1),f=e(u,3),m=e(u,4),g=e(u,5),y=e(u,6),v=e(u,7),p){if((w=new Ze.Face3).a=L[o],w.b=L[o+1],w.c=L[o+3],(M=new Ze.Face3).a=L[o+1],M.b=L[o+2],M.c=L[o+3],o+=4,d&&(l=L[o++],w.materialIndex=l,M.materialIndex=l),n=O.faces.length,f)for(i=0;i<D;i++)for(T=F.uvs[i],O.faceVertexUvs[i][n]=[],O.faceVertexUvs[i][n+1]=[],r=0;r<4;r++)c=L[o++],E=T[2*c],A=T[2*c+1],C=new Ze.Vector2(E,A),2!==r&&O.faceVertexUvs[i][n].push(C),0!==r&&O.faceVertexUvs[i][n+1].push(C);if(m&&(h=3*L[o++],w.normal.set(k[h++],k[h++],k[h]),M.normal.copy(w.normal)),g)for(i=0;i<4;i++)h=3*L[o++],S=new Ze.Vector3(k[h++],k[h++],k[h]),2!==i&&w.vertexNormals.push(S),0!==i&&M.vertexNormals.push(S);if(y&&(s=L[o++],_=R[s],w.color.setHex(_),M.color.setHex(_)),v)for(i=0;i<4;i++)s=L[o++],_=R[s],2!==i&&w.vertexColors.push(new Ze.Color(_)),0!==i&&M.vertexColors.push(new Ze.Color(_));O.faces.push(w),O.faces.push(M)}else{if((b=new Ze.Face3).a=L[o++],b.b=L[o++],b.c=L[o++],d&&(l=L[o++],b.materialIndex=l),n=O.faces.length,f)for(i=0;i<D;i++)for(T=F.uvs[i],O.faceVertexUvs[i][n]=[],r=0;r<3;r++)c=L[o++],E=T[2*c],A=T[2*c+1],C=new Ze.Vector2(E,A),O.faceVertexUvs[i][n].push(C);if(m&&(h=3*L[o++],b.normal.set(k[h++],k[h++],k[h])),g)for(i=0;i<3;i++)h=3*L[o++],S=new Ze.Vector3(k[h++],k[h++],k[h]),b.vertexNormals.push(S);if(y&&(s=L[o++],b.color.setHex(R[s])),v)for(i=0;i<3;i++)s=L[o++],b.vertexColors.push(new Ze.Color(R[s]));O.faces.push(b)}}(e),function(){var t=void 0!==F.influencesPerVertex?F.influencesPerVertex:2;if(F.skinWeights)for(var e=0,i=F.skinWeights.length;e<i;e+=t){var r=F.skinWeights[e],n=1<t?F.skinWeights[e+1]:0,o=2<t?F.skinWeights[e+2]:0,a=3<t?F.skinWeights[e+3]:0;O.skinWeights.push(new Ze.Vector4(r,n,o,a))}if(F.skinIndices)for(var e=0,i=F.skinIndices.length;e<i;e+=t){var s=F.skinIndices[e],h=1<t?F.skinIndices[e+1]:0,c=2<t?F.skinIndices[e+2]:0,l=3<t?F.skinIndices[e+3]:0;O.skinIndices.push(new Ze.Vector4(s,h,c,l))}O.bones=F.bones,O.bones&&0<O.bones.length&&(O.skinWeights.length!==O.skinIndices.length||O.skinIndices.length!==O.vertices.length)&&console.warn("When skinning, number of vertices ("+O.vertices.length+"), skinIndices ("+O.skinIndices.length+"), and skinWeights ("+O.skinWeights.length+") should match.");O.animation=F.animation,O.animations=F.animations}(),function(t){var e,i,r,n,o,a,s,h,c,l,u;if(void 0!==F.morphTargets)for(o=0,a=F.morphTargets.length;o<a;o++)for(O.morphTargets[o]={},O.morphTargets[o].name=F.morphTargets[o].name,O.morphTargets[o].vertices=[],r=O.morphTargets[o].vertices,n=F.morphTargets[o].vertices,e=0,i=n.length;e<i;e+=3){var p=new Ze.Vector3;p.x=n[e]*t,p.y=n[e+1]*t,p.z=n[e+2]*t,r.push(p)}if(void 0!==F.morphColors)for(o=0,a=F.morphColors.length;o<a;o++)for(O.morphColors[o]={},O.morphColors[o].name=F.morphColors[o].name,O.morphColors[o].colors=[],c=O.morphColors[o].colors,l=F.morphColors[o].colors,s=0,h=l.length;s<h;s+=3)(u=new Ze.Color(16755200)).setRGB(l[s],l[s+1],l[s+2]),c.push(u)}(e),O.computeFaceNormals(),O.computeBoundingSphere(),void 0===F.materials||0===F.materials.length)return{geometry:O};var i=Ze.Loader.prototype.initMaterials(F.materials,t,this.crossOrigin);return{geometry:O,materials:i}}},Ze.LoadingManager=function(t,e,i){var r=this,n=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===n&&void 0!==r.onStart&&r.onStart(t,o,a),n=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(n=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)}},Ze.DefaultLoadingManager=new Ze.LoadingManager,Ze.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager},Ze.BufferGeometryLoader.prototype={constructor:Ze.BufferGeometryLoader,load:function(t,e,i,r){var n=this,o=new Ze.XHRLoader(n.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new Ze.BufferGeometry,i=t.data.index;if(void 0!==i){var r=new Qe[i.type](i.array);e.setIndex(new Ze.BufferAttribute(r,1))}var n=t.data.attributes;for(var o in n){var a=n[o];r=new Qe[a.type](a.array);e.addAttribute(o,new Ze.BufferAttribute(r,a.itemSize))}var s=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==s)for(var h=0,c=s.length;h!==c;++h){var l=s[h];e.addGroup(l.start,l.count)}var u=t.data.boundingSphere;if(void 0!==u){var p=new Ze.Vector3;void 0!==u.center&&p.fromArray(u.center),e.boundingSphere=new Ze.Sphere(p,u.radius)}return e}},Ze.MaterialLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager,this.textures={}},Ze.MaterialLoader.prototype={constructor:Ze.MaterialLoader,load:function(t,e,i,r){var n=this,o=new Ze.XHRLoader(n.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},setCrossOrigin:function(t){this.crossOrigin=t},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]},parse:function(t){var e=new Ze[t.type];if(e.uuid=t.uuid,void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),t.normalScale&&(e.normalScale=new Ze.Vector2(t.normalScale,t.normalScale)),void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=Ze.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var i=0,r=t.materials.length;i<r;i++)e.materials.push(this.parse(t.materials[i]));return e}},Ze.ObjectLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager,this.texturePath=""},Ze.ObjectLoader.prototype={constructor:Ze.ObjectLoader,load:function(t,e,i,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var n=this,o=new Ze.XHRLoader(n.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){n.parse(JSON.parse(t),e)},i,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),r=this.parseImages(t.images,function(){void 0!==e&&e(a)}),n=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,n),a=this.parseObject(t.object,i,o);return void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new Ze.JSONLoader,r=new Ze.BufferGeometryLoader,n=0,o=t.length;n<o;n++){var a,s=t[n];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Ze[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new Ze.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleBufferGeometry":a=new Ze.CircleBufferGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CircleGeometry":a=new Ze.CircleGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":a=new Ze.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":a=new Ze.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"SphereBufferGeometry":a=new Ze.SphereBufferGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new Ze.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new Ze.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new Ze.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new Ze.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":a=new Ze.RingGeometry(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":a=new Ze.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new Ze.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"TextGeometry":a=new Ze.TextGeometry(s.text,s.data);break;case"BufferGeometry":a=r.parse(s);break;case"Geometry":a=i.parse(s.data,this.texturePath).geometry;break;default:console.warn(\'THREE.ObjectLoader: Unsupported geometry type "\'+s.type+\'"\');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var r=new Ze.MaterialLoader;r.setTextures(e);for(var n=0,o=t.length;n<o;n++){var a=r.parse(t[n]);i[a.uuid]=a}}return i},parseImages:function(t,e){var i=this,r={};function n(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)})}if(void 0!==t&&0<t.length){var o=new Ze.LoadingManager(e),a=new Ze.ImageLoader(o);a.setCrossOrigin(this.crossOrigin);for(var s=0,h=t.length;s<h;s++){var c=t[s],l=/^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;r[c.uuid]=n(l)}}return r},parseTextures:function(t,e){function i(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),Ze[t])}var r={};if(void 0!==t)for(var n=0,o=t.length;n<o;n++){var a=t[n];void 0===a.image&&console.warn(\'THREE.ObjectLoader: No "image" specified for\',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new Ze.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping)),void 0!==a.offset&&(s.offset=new Ze.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(s.repeat=new Ze.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(s.wrapS=i(a.wrap[0]),s.wrapT=i(a.wrap[1])),r[a.uuid]=s}return r},parseObject:(ee=new Ze.Matrix4,function(t,e,i){var r,n=function(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]},o=function(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]};switch(t.type){case"Scene":r=new Ze.Scene;break;case"PerspectiveCamera":r=new Ze.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":r=new Ze.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":r=new Ze.AmbientLight(t.color);break;case"DirectionalLight":r=new Ze.DirectionalLight(t.color,t.intensity);break;case"PointLight":r=new Ze.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":r=new Ze.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":r=new Ze.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":r=new Ze.Mesh(n(t.geometry),o(t.material));break;case"LOD":r=new Ze.LOD;break;case"Line":r=new Ze.Line(n(t.geometry),o(t.material),t.mode);break;case"PointCloud":case"Points":r=new Ze.Points(n(t.geometry),o(t.material));break;case"Sprite":r=new Ze.Sprite(o(t.material));break;case"Group":r=new Ze.Group;break;default:r=new Ze.Object3D}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(ee.fromArray(t.matrix),ee.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var a in t.children)r.add(this.parseObject(t.children[a],e,i));if("LOD"===t.type)for(var s=t.levels,h=0;h<s.length;h++){var c=s[h];void 0!==(a=r.getObjectByProperty("uuid",c.object))&&r.addLevel(a,c.distance)}return r})},Ze.TextureLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager},Ze.TextureLoader.prototype={constructor:Ze.TextureLoader,load:function(t,i,e,r){var n=new Ze.ImageLoader(this.manager);n.setCrossOrigin(this.crossOrigin),n.load(t,function(t){var e=new Ze.Texture(t);e.needsUpdate=!0,void 0!==i&&i(e)},e,r)},setCrossOrigin:function(t){this.crossOrigin=t}},Ze.DataTextureLoader=Ze.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager,this._parser=null},Ze.BinaryTextureLoader.prototype={constructor:Ze.BinaryTextureLoader,load:function(t,i,e,r){var n=this,o=new Ze.DataTexture,a=new Ze.XHRLoader(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setResponseType("arraybuffer"),a.load(t,function(t){var e=n._parser(t);e&&(void 0!==e.image?o.image=e.image:void 0!==e.data&&(o.image.width=e.width,o.image.height=e.height,o.image.data=e.data),o.wrapS=void 0!==e.wrapS?e.wrapS:Ze.ClampToEdgeWrapping,o.wrapT=void 0!==e.wrapT?e.wrapT:Ze.ClampToEdgeWrapping,o.magFilter=void 0!==e.magFilter?e.magFilter:Ze.LinearFilter,o.minFilter=void 0!==e.minFilter?e.minFilter:Ze.LinearMipMapLinearFilter,o.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(o.format=e.format),void 0!==e.type&&(o.type=e.type),void 0!==e.mipmaps&&(o.mipmaps=e.mipmaps),1===e.mipmapCount&&(o.minFilter=Ze.LinearFilter),o.needsUpdate=!0,i&&i(o,e))},e,r),o},setCrossOrigin:function(t){this.crossOrigin=t}},Ze.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:Ze.DefaultLoadingManager,this._parser=null},Ze.CompressedTextureLoader.prototype={constructor:Ze.CompressedTextureLoader,load:function(t,o,e,r){var a=this,s=[],h=new Ze.CompressedTexture;h.image=s;var n=new Ze.XHRLoader(this.manager);if(n.setCrossOrigin(this.crossOrigin),n.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,i=function(i){n.load(t[i],function(t){var e=a._parser(t,!0);s[i]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(c+=1)&&(1===e.mipmapCount&&(h.minFilter=Ze.LinearFilter),h.format=e.format,h.needsUpdate=!0,o&&o(h))},e,r)},l=0,u=t.length;l<u;++l)i(l);else n.load(t,function(t){var e=a._parser(t,!0);if(e.isCubemap)for(var i=e.mipmaps.length/e.mipmapCount,r=0;r<i;r++){s[r]={mipmaps:[]};for(var n=0;n<e.mipmapCount;n++)s[r].mipmaps.push(e.mipmaps[r*e.mipmapCount+n]),s[r].format=e.format,s[r].width=e.width,s[r].height=e.height}else h.image.width=e.width,h.image.height=e.height,h.mipmaps=e.mipmaps;1===e.mipmapCount&&(h.minFilter=Ze.LinearFilter),h.format=e.format,h.needsUpdate=!0,o&&o(h)},e,r);return h},setCrossOrigin:function(t){this.crossOrigin=t}},Ze.Material=function(){Object.defineProperty(this,"id",{value:Ze.MaterialIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.type="Material",this.side=Ze.FrontSide,this.opacity=1,this.transparent=!1,this.blending=Ze.NormalBlending,this.blendSrc=Ze.SrcAlphaFactor,this.blendDst=Ze.OneMinusSrcAlphaFactor,this.blendEquation=Ze.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ze.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},Ze.Material.prototype={constructor:Ze.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var r=this[e];void 0!==r?r instanceof Ze.Color?r.set(i):r instanceof Ze.Vector3&&i instanceof Ze.Vector3?r.copy(i):this[e]="overdraw"===e?Number(i):i:console.warn("THREE."+this.type+": \'"+e+"\' is not a property of this material.")}else console.warn("THREE.Material: \'"+e+"\' parameter is undefined.")}},toJSON:function(t){var e={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),this.color instanceof Ze.Color&&(e.color=this.color.getHex()),this.emissive instanceof Ze.Color&&(e.emissive=this.emissive.getHex()),this.specular instanceof Ze.Color&&(e.specular=this.specular.getHex()),void 0!==this.shininess&&(e.shininess=this.shininess),this.map instanceof Ze.Texture&&(e.map=this.map.toJSON(t).uuid),this.alphaMap instanceof Ze.Texture&&(e.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof Ze.Texture&&(e.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof Ze.Texture&&(e.bumpMap=this.bumpMap.toJSON(t).uuid,e.bumpScale=this.bumpScale),this.normalMap instanceof Ze.Texture&&(e.normalMap=this.normalMap.toJSON(t).uuid,e.normalScale=this.normalScale),this.displacementMap instanceof Ze.Texture&&(e.displacementMap=this.displacementMap.toJSON(t).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.specularMap instanceof Ze.Texture&&(e.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof Ze.Texture&&(e.envMap=this.envMap.toJSON(t).uuid,e.reflectivity=this.reflectivity),void 0!==this.size&&(e.size=this.size),void 0!==this.sizeAttenuation&&(e.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==Ze.NoColors&&(e.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==Ze.SmoothShading&&(e.shading=this.shading),void 0!==this.blending&&this.blending!==Ze.NormalBlending&&(e.blending=this.blending),void 0!==this.side&&this.side!==Ze.FrontSide&&(e.side=this.side),this.opacity<1&&(e.opacity=this.opacity),!0===this.transparent&&(e.transparent=this.transparent),0<this.alphaTest&&(e.alphaTest=this.alphaTest),!0===this.wireframe&&(e.wireframe=this.wireframe),1<this.wireframeLinewidth&&(e.wireframeLinewidth=this.wireframeLinewidth),e},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.overdraw=t.overdraw,this.visible=t.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set wrapAround(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new Ze.Color}},Ze.EventDispatcher.prototype.apply(Ze.Material.prototype),Ze.MaterialIdCount=0,Ze.LineBasicMaterial=function(t){Ze.Material.call(this),this.type="LineBasicMaterial",this.color=new Ze.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=Ze.NoColors,this.fog=!0,this.setValues(t)},Ze.LineBasicMaterial.prototype=Object.create(Ze.Material.prototype),Ze.LineBasicMaterial.prototype.constructor=Ze.LineBasicMaterial,Ze.LineBasicMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},Ze.LineDashedMaterial=function(t){Ze.Material.call(this),this.type="LineDashedMaterial",this.color=new Ze.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},Ze.LineDashedMaterial.prototype=Object.create(Ze.Material.prototype),Ze.LineDashedMaterial.prototype.constructor=Ze.LineDashedMaterial,Ze.LineDashedMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},Ze.MeshBasicMaterial=function(t){Ze.Material.call(this),this.type="MeshBasicMaterial",this.color=new Ze.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ze.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=Ze.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Ze.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},Ze.MeshBasicMaterial.prototype=Object.create(Ze.Material.prototype),Ze.MeshBasicMaterial.prototype.constructor=Ze.MeshBasicMaterial,Ze.MeshBasicMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Ze.MeshLambertMaterial=function(t){Ze.Material.call(this),this.type="MeshLambertMaterial",this.color=new Ze.Color(16777215),this.emissive=new Ze.Color(0),this.map=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ze.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Ze.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},Ze.MeshLambertMaterial.prototype=Object.create(Ze.Material.prototype),Ze.MeshLambertMaterial.prototype.constructor=Ze.MeshLambertMaterial,Ze.MeshLambertMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.map=t.map,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ze.MeshPhongMaterial=function(t){Ze.Material.call(this),this.type="MeshPhongMaterial",this.color=new Ze.Color(16777215),this.emissive=new Ze.Color(0),this.specular=new Ze.Color(1118481),this.shininess=30,this.metal=!1,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ze.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ze.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=Ze.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Ze.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},Ze.MeshPhongMaterial.prototype=Object.create(Ze.Material.prototype),Ze.MeshPhongMaterial.prototype.constructor=Ze.MeshPhongMaterial,Ze.MeshPhongMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.specular.copy(t.specular),this.shininess=t.shininess,this.metal=t.metal,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissiveMap=t.emissiveMap,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ze.MeshDepthMaterial=function(t){Ze.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},Ze.MeshDepthMaterial.prototype=Object.create(Ze.Material.prototype),Ze.MeshDepthMaterial.prototype.constructor=Ze.MeshDepthMaterial,Ze.MeshDepthMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ze.MeshNormalMaterial=function(t){Ze.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},Ze.MeshNormalMaterial.prototype=Object.create(Ze.Material.prototype),Ze.MeshNormalMaterial.prototype.constructor=Ze.MeshNormalMaterial,Ze.MeshNormalMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ze.MultiMaterial=function(t){this.uuid=Ze.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},Ze.MultiMaterial.prototype={constructor:Ze.MultiMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,i=this.materials.length;e<i;e++)t.materials.push(this.materials[e].toJSON());return t.visible=this.visible,t},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},Ze.MeshFaceMaterial=Ze.MultiMaterial,Ze.PointsMaterial=function(t){Ze.Material.call(this),this.type="PointsMaterial",this.color=new Ze.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=Ze.NoColors,this.fog=!0,this.setValues(t)},Ze.PointsMaterial.prototype=Object.create(Ze.Material.prototype),Ze.PointsMaterial.prototype.constructor=Ze.PointsMaterial,Ze.PointsMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},Ze.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ze.PointsMaterial(t)},Ze.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ze.PointsMaterial(t)},Ze.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ze.PointsMaterial(t)},Ze.ShaderMaterial=function(t){Ze.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}",this.fragmentShader="void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}",this.shading=Ze.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=Ze.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.derivatives=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},(this.index0AttributeName=void 0)!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))},Ze.ShaderMaterial.prototype=Object.create(Ze.Material.prototype),Ze.ShaderMaterial.prototype.constructor=Ze.ShaderMaterial,Ze.ShaderMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ze.UniformsUtils.clone(t.uniforms),this.attributes=t.attributes,this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.derivatives=t.derivatives,this},Ze.ShaderMaterial.prototype.toJSON=function(t){var e=Ze.Material.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.attributes=this.attributes,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Ze.RawShaderMaterial=function(t){Ze.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},Ze.RawShaderMaterial.prototype=Object.create(Ze.ShaderMaterial.prototype),Ze.RawShaderMaterial.prototype.constructor=Ze.RawShaderMaterial,Ze.SpriteMaterial=function(t){Ze.Material.call(this),this.type="SpriteMaterial",this.color=new Ze.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},Ze.SpriteMaterial.prototype=Object.create(Ze.Material.prototype),Ze.SpriteMaterial.prototype.constructor=Ze.SpriteMaterial,Ze.SpriteMaterial.prototype.copy=function(t){return Ze.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},Ze.Texture=function(t,e,i,r,n,o,a,s,h){Object.defineProperty(this,"id",{value:Ze.TextureIdCount++}),this.uuid=Ze.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:Ze.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Ze.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:Ze.ClampToEdgeWrapping,this.wrapT=void 0!==r?r:Ze.ClampToEdgeWrapping,this.magFilter=void 0!==n?n:Ze.LinearFilter,this.minFilter=void 0!==o?o:Ze.LinearMipMapLinearFilter,this.anisotropy=void 0!==h?h:1,this.format=void 0!==a?a:Ze.RGBAFormat,this.type=void 0!==s?s:Ze.UnsignedByteType,this.offset=new Ze.Vector2(0,0),this.repeat=new Ze.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.version=0,this.onUpdate=null},Ze.Texture.DEFAULT_IMAGE=void 0,Ze.Texture.DEFAULT_MAPPING=Ze.UVMapping,Ze.Texture.prototype={constructor:Ze.Texture,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e,i,r={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Ze.Math.generateUUID()),void 0===t.images[n.uuid]&&(t.images[n.uuid]={uuid:n.uuid,url:(e=n,void 0!==e.toDataURL?i=e:((i=document.createElement("canvas")).width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0,e.width,e.height)),2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"))}),r.image=n.uuid}return t.textures[this.uuid]=r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===Ze.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||1<t.x)switch(this.wrapS){case Ze.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case Ze.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case Ze.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case Ze.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case Ze.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case Ze.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Ze.EventDispatcher.prototype.apply(Ze.Texture.prototype),Ze.TextureIdCount=0,Ze.CanvasTexture=function(t,e,i,r,n,o,a,s,h){Ze.Texture.call(this,t,e,i,r,n,o,a,s,h),this.needsUpdate=!0},Ze.CanvasTexture.prototype=Object.create(Ze.Texture.prototype),Ze.CanvasTexture.prototype.constructor=Ze.CanvasTexture,Ze.CubeTexture=function(t,e,i,r,n,o,a,s,h){e=void 0!==e?e:Ze.CubeReflectionMapping,Ze.Texture.call(this,t,e,i,r,n,o,a,s,h),this.images=t,this.flipY=!1},Ze.CubeTexture.prototype=Object.create(Ze.Texture.prototype),Ze.CubeTexture.prototype.constructor=Ze.CubeTexture,Ze.CubeTexture.prototype.copy=function(t){return Ze.Texture.prototype.copy.call(this,t),this.images=t.images,this},Ze.CompressedTexture=function(t,e,i,r,n,o,a,s,h,c,l){Ze.Texture.call(this,null,o,a,s,h,c,r,n,l),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},Ze.CompressedTexture.prototype=Object.create(Ze.Texture.prototype),Ze.CompressedTexture.prototype.constructor=Ze.CompressedTexture,Ze.DataTexture=function(t,e,i,r,n,o,a,s,h,c,l){Ze.Texture.call(this,null,o,a,s,h,c,r,n,l),this.image={data:t,width:e,height:i},this.magFilter=void 0!==h?h:Ze.NearestFilter,this.minFilter=void 0!==c?c:Ze.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},Ze.DataTexture.prototype=Object.create(Ze.Texture.prototype),Ze.DataTexture.prototype.constructor=Ze.DataTexture,Ze.VideoTexture=function(t,e,i,r,n,o,a,s,h){Ze.Texture.call(this,t,e,i,r,n,o,a,s,h),this.generateMipmaps=!1;var c=this,l=function(){requestAnimationFrame(l),t.readyState===t.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)};l()},Ze.VideoTexture.prototype=Object.create(Ze.Texture.prototype),Ze.VideoTexture.prototype.constructor=Ze.VideoTexture,Ze.Group=function(){Ze.Object3D.call(this),this.type="Group"},Ze.Group.prototype=Object.create(Ze.Object3D.prototype),Ze.Group.prototype.constructor=Ze.Group,Ze.Points=function(t,e){Ze.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new Ze.Geometry,this.material=void 0!==e?e:new Ze.PointsMaterial({color:16777215*Math.random()})},Ze.Points.prototype=Object.create(Ze.Object3D.prototype),Ze.Points.prototype.constructor=Ze.Points,Ze.Points.prototype.raycast=(ie=new Ze.Matrix4,re=new Ze.Ray,function(o,a){var s=this,t=s.geometry,e=o.params.Points.threshold;if(ie.getInverse(this.matrixWorld),re.copy(o.ray).applyMatrix4(ie),null===t.boundingBox||!1!==re.isIntersectionBox(t.boundingBox)){var i=e/((this.scale.x+this.scale.y+this.scale.z)/3),h=i*i,r=new Ze.Vector3;if(t instanceof Ze.BufferGeometry){var n=t.index,c=t.attributes.position.array;if(null!==n)for(var l=n.array,u=0,p=l.length;u<p;u++){var d=l[u];r.fromArray(c,3*d),g(r,d)}else{u=0;for(var f=c.length/3;u<f;u++)r.fromArray(c,3*u),g(r,u)}}else{var m=t.vertices;for(u=0,f=m.length;u<f;u++)g(m[u],u)}}function g(t,e){var i=re.distanceSqToPoint(t);if(i<h){var r=re.closestPointToPoint(t);r.applyMatrix4(s.matrixWorld);var n=o.ray.origin.distanceTo(r);if(n<o.near||n>o.far)return;a.push({distance:n,distanceToRay:Math.sqrt(i),point:r.clone(),index:e,face:null,object:s})}}}),Ze.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},Ze.Points.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),e.object.geometry=this.geometry.uuid,e.object.material=this.material.uuid,e},Ze.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ze.Points(t,e)},Ze.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ze.Points(t,e)},Ze.Line=function(t,e,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ze.LineSegments(t,e);Ze.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new Ze.Geometry,this.material=void 0!==e?e:new Ze.LineBasicMaterial({color:16777215*Math.random()})},Ze.Line.prototype=Object.create(Ze.Object3D.prototype),Ze.Line.prototype.constructor=Ze.Line,Ze.Line.prototype.raycast=(ne=new Ze.Matrix4,oe=new Ze.Ray,ae=new Ze.Sphere,function(t,e){var i=t.linePrecision,r=i*i,n=this.geometry;if(null===n.boundingSphere&&n.computeBoundingSphere(),ae.copy(n.boundingSphere),ae.applyMatrix4(this.matrixWorld),!1!==t.ray.isIntersectionSphere(ae)){ne.getInverse(this.matrixWorld),oe.copy(t.ray).applyMatrix4(ne);var o=new Ze.Vector3,a=new Ze.Vector3,s=new Ze.Vector3,h=new Ze.Vector3,c=this instanceof Ze.LineSegments?2:1;if(n instanceof Ze.BufferGeometry){var l=n.index,u=n.attributes;if(null!==l)for(var p=l.array,d=u.position.array,f=0,m=p.length-1;f<m;f+=c){var g=p[f],y=p[f+1];o.fromArray(d,3*g),a.fromArray(d,3*y),r<oe.distanceSqToSegment(o,a,h,s)||(h.applyMatrix4(this.matrixWorld),(b=t.ray.origin.distanceTo(h))<t.near||b>t.far||e.push({distance:b,point:s.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else for(f=0,m=(d=u.position.array).length/3-1;f<m;f+=c)o.fromArray(d,3*f),a.fromArray(d,3*f+3),r<oe.distanceSqToSegment(o,a,h,s)||(h.applyMatrix4(this.matrixWorld),(b=t.ray.origin.distanceTo(h))<t.near||b>t.far||e.push({distance:b,point:s.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else if(n instanceof Ze.Geometry){var v=n.vertices,x=v.length;for(f=0;f<x-1;f+=c){var b;r<oe.distanceSqToSegment(v[f],v[f+1],h,s)||(h.applyMatrix4(this.matrixWorld),(b=t.ray.origin.distanceTo(h))<t.near||b>t.far||e.push({distance:b,point:s.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}}}}),Ze.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},Ze.Line.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),e.object.geometry=this.geometry.uuid,e.object.material=this.material.uuid,e},Ze.LineStrip=0,Ze.LinePieces=1,Ze.LineSegments=function(t,e){Ze.Line.call(this,t,e),this.type="LineSegments"},Ze.LineSegments.prototype=Object.create(Ze.Line.prototype),Ze.LineSegments.prototype.constructor=Ze.LineSegments,Ze.Mesh=function(t,e){Ze.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Ze.Geometry,this.material=void 0!==e?e:new Ze.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},Ze.Mesh.prototype=Object.create(Ze.Object3D.prototype),Ze.Mesh.prototype.constructor=Ze.Mesh,Ze.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},Ze.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},Ze.Mesh.prototype.raycast=function(){var P=new Ze.Matrix4,k=new Ze.Ray,R=new Ze.Sphere,D=new Ze.Vector3,F=new Ze.Vector3,O=new Ze.Vector3,B=new Ze.Vector3,U=new Ze.Vector3,V=new Ze.Vector3,N=new Ze.Vector2,z=new Ze.Vector2,I=new Ze.Vector2,s=new Ze.Vector3,G=new Ze.Vector3,j=new Ze.Vector3;function H(t,e,i,r,n,o,a){return Ze.Triangle.barycoordFromPoint(t,e,i,r,s),n.multiplyScalar(s.x),o.multiplyScalar(s.y),a.multiplyScalar(s.z),n.add(o).add(a),n.clone()}return function(t,e){var i,r,n,o=this.geometry,a=this.material;if(void 0!==a&&(null===o.boundingSphere&&o.computeBoundingSphere(),R.copy(o.boundingSphere),R.applyMatrix4(this.matrixWorld),!1!==t.ray.isIntersectionSphere(R)&&(P.getInverse(this.matrixWorld),k.copy(t.ray).applyMatrix4(P),null===o.boundingBox||!1!==k.isIntersectionBox(o.boundingBox))))if(o instanceof Ze.BufferGeometry){var s=o.index,h=o.attributes;if(null!==s)for(var c=s.array,l=h.position.array,u=0,p=c.length;u<p;u+=3){if(i=c[u],r=c[u+1],n=c[u+2],D.fromArray(l,3*i),F.fromArray(l,3*r),O.fromArray(l,3*n),a.side===Ze.BackSide){if(null===k.intersectTriangle(O,F,D,!0,G))continue}else if(null===k.intersectTriangle(D,F,O,a.side!==Ze.DoubleSide,G))continue;if(j.copy(G),j.applyMatrix4(this.matrixWorld),!((A=t.ray.origin.distanceTo(j))<t.near||A>t.far)){if(void 0!==h.uv){var d=h.uv.array;N.fromArray(d,2*i),z.fromArray(d,2*r),I.fromArray(d,2*n),L=H(G,D,F,O,N,z,I)}e.push({distance:A,point:j.clone(),uv:L,face:new Ze.Face3(i,r,n,Ze.Triangle.normal(D,F,O)),faceIndex:Math.floor(u/3),object:this})}}else for(u=0,p=(l=h.position.array).length;u<p;u+=9){if(D.fromArray(l,u),F.fromArray(l,u+3),O.fromArray(l,u+6),a.side===Ze.BackSide){if(null===k.intersectTriangle(O,F,D,!0,G))continue}else if(null===k.intersectTriangle(D,F,O,a.side!==Ze.DoubleSide,G))continue;if(j.copy(G),j.applyMatrix4(this.matrixWorld),!((A=t.ray.origin.distanceTo(j))<t.near||A>t.far)){if(void 0!==h.uv){d=h.uv.array;N.fromArray(d,u),z.fromArray(d,u+2),I.fromArray(d,u+4),L=H(G,D,F,O,N,z,I)}r=(i=u/3)+1,n=i+2,e.push({distance:A,point:j.clone(),uv:L,face:new Ze.Face3(i,r,n,Ze.Triangle.normal(D,F,O)),index:i,object:this})}}}else if(o instanceof Ze.Geometry)for(var f=a instanceof Ze.MeshFaceMaterial,m=!0===f?a.materials:null,g=o.vertices,y=o.faces,v=0,x=y.length;v<x;v++){var b=y[v],w=!0===f?m[b.materialIndex]:a;if(void 0!==w){if(i=g[b.a],r=g[b.b],n=g[b.c],!0===w.morphTargets){var M=o.morphTargets,_=this.morphTargetInfluences;D.set(0,0,0),F.set(0,0,0),O.set(0,0,0);for(var S=0,T=M.length;S<T;S++){var C=_[S];if(0!==C){var E=M[S].vertices;D.addScaledVector(B.subVectors(E[b.a],i),C),F.addScaledVector(U.subVectors(E[b.b],r),C),O.addScaledVector(V.subVectors(E[b.c],n),C)}}D.add(i),F.add(r),O.add(n),i=D,r=F,n=O}if(w.side===Ze.BackSide){if(null===k.intersectTriangle(n,r,i,!0,G))continue}else if(null===k.intersectTriangle(i,r,n,w.side!==Ze.DoubleSide,G))continue;var A;if(j.copy(G),j.applyMatrix4(this.matrixWorld),!((A=t.ray.origin.distanceTo(j))<t.near||A>t.far)){var L;if(0<o.faceVertexUvs[0].length){d=o.faceVertexUvs[0][v];N.copy(d[0]),z.copy(d[1]),I.copy(d[2]),L=H(G,i,r,n,N,z,I)}e.push({distance:A,point:j.clone(),uv:L,face:b,faceIndex:v,object:this})}}}}}(),Ze.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},Ze.Mesh.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),e.object.geometry=this.geometry.uuid,e.object.material=this.material.uuid,e},Ze.Bone=function(t){Ze.Object3D.call(this),this.type="Bone",this.skin=t},Ze.Bone.prototype=Object.create(Ze.Object3D.prototype),Ze.Bone.prototype.constructor=Ze.Bone,Ze.Bone.prototype.copy=function(t){return Ze.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},Ze.Skeleton=function(t,e,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new Ze.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var r=Math.sqrt(4*this.bones.length);r=Ze.Math.nextPowerOfTwo(Math.ceil(r)),r=Math.max(r,4),this.boneTextureWidth=r,this.boneTextureHeight=r,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new Ze.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,Ze.RGBAFormat,Ze.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var n=0,o=this.bones.length;n<o;n++)this.boneInverses.push(new Ze.Matrix4)}},Ze.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new Ze.Matrix4;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},Ze.Skeleton.prototype.pose=function(){for(var t,e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},Ze.Skeleton.prototype.update=(se=new Ze.Matrix4,function(){for(var t=0,e=this.bones.length;t<e;t++){var i=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;se.multiplyMatrices(i,this.boneInverses[t]),se.flattenToArrayOffset(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),Ze.Skeleton.prototype.clone=function(){return new Ze.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},Ze.SkinnedMesh=function(t,e,i){Ze.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ze.Matrix4,this.bindMatrixInverse=new Ze.Matrix4;var r=[];if(this.geometry&&void 0!==this.geometry.bones){for(var n,o,a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],n=new Ze.Bone(this),r.push(n),n.name=o.name,n.position.fromArray(o.pos),n.quaternion.fromArray(o.rotq),void 0!==o.scl&&n.scale.fromArray(o.scl);for(a=0,s=this.geometry.bones.length;a<s;++a)-1!==(o=this.geometry.bones[a]).parent?r[o.parent].add(r[a]):this.add(r[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new Ze.Skeleton(r,void 0,i),this.matrixWorld)},Ze.SkinnedMesh.prototype=Object.create(Ze.Mesh.prototype),Ze.SkinnedMesh.prototype.constructor=Ze.SkinnedMesh,Ze.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},Ze.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},Ze.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof Ze.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();i!==1/0?e.multiplyScalar(i):e.set(1)}},Ze.SkinnedMesh.prototype.updateMatrixWorld=function(t){Ze.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},Ze.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},Ze.MorphAnimMesh=function(t,e){Ze.Mesh.call(this,t,e),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,t.morphTargets.length-1)},Ze.MorphAnimMesh.prototype=Object.create(Ze.Mesh.prototype),Ze.MorphAnimMesh.prototype.constructor=Ze.MorphAnimMesh,Ze.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},Ze.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},Ze.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},Ze.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,i=t.animations,r=/([a-z]+)_?(\\d+)/,n=0,o=t.morphTargets.length;n<o;n++){var a=t.morphTargets[n].name.match(r);if(a&&1<a.length){var s=a[1];i[s]||(i[s]={start:1/0,end:-1/0});var h=i[s];n<h.start&&(h.start=n),n>h.end&&(h.end=n),e||(e=s)}}t.firstAnimation=e},Ze.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:i}},Ze.MorphAnimMesh.prototype.playAnimation=function(t,e){var i=this.geometry.animations[t];i?(this.setFrameRange(i.start,i.end),this.duration=(i.end-i.start)/e*1e3,this.time=0):console.warn("THREE.MorphAnimMesh: animation["+t+"] undefined in .playAnimation()")},Ze.MorphAnimMesh.prototype.updateAnimation=function(t){var e=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+Ze.Math.clamp(Math.floor(this.time/e),0,this.length-1),r=this.morphTargetInfluences;i!==this.currentKeyframe&&(r[this.lastKeyframe]=0,r[this.currentKeyframe]=1,r[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var n=this.time%e/e;this.directionBackwards&&(n=1-n),r[this.currentKeyframe]=n,r[this.lastKeyframe]=1-n},Ze.MorphAnimMesh.prototype.interpolateTargets=function(t,e,i){for(var r=this.morphTargetInfluences,n=0,o=r.length;n<o;n++)r[n]=0;-1<t&&(r[t]=1-i),-1<e&&(r[e]=i)},Ze.MorphAnimMesh.prototype.copy=function(t){return Ze.Mesh.prototype.copy.call(this,t),this.duration=t.duration,this.mirroredLoop=t.mirroredLoop,this.time=t.time,this.lastKeyframe=t.lastKeyframe,this.currentKeyframe=t.currentKeyframe,this.direction=t.direction,this.directionBackwards=t.directionBackwards,this},Ze.LOD=function(){Ze.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}})},Ze.LOD.prototype=Object.create(Ze.Object3D.prototype),Ze.LOD.prototype.constructor=Ze.LOD,Ze.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,r=0;r<i.length&&!(e<i[r].distance);r++);i.splice(r,0,{distance:e,object:t}),this.add(t)},Ze.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,i=1,r=e.length;i<r&&!(t<e[i].distance);i++);return e[i-1].object},Ze.LOD.prototype.raycast=(he=new Ze.Vector3,function(t,e){he.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(he);this.getObjectForDistance(i).raycast(t,e)}),Ze.LOD.prototype.update=(ce=new Ze.Vector3,le=new Ze.Vector3,function(t){var e=this.levels;if(1<e.length){ce.setFromMatrixPosition(t.matrixWorld),le.setFromMatrixPosition(this.matrixWorld);var i=ce.distanceTo(le);e[0].object.visible=!0;for(var r=1,n=e.length;r<n&&i>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(;r<n;r++)e[r].object.visible=!1}}),Ze.LOD.prototype.copy=function(t){Ze.Object3D.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,r=e.length;i<r;i++){var n=e[i];this.addLevel(n.object.clone(),n.distance)}return this},Ze.LOD.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,r=0,n=i.length;r<n;r++){var o=i[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e},Ze.Sprite=(ue=new Uint16Array([0,1,2,0,2,3]),pe=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),de=new Float32Array([0,0,1,0,1,1,0,1]),(fe=new Ze.BufferGeometry).setIndex(new Ze.BufferAttribute(ue,1)),fe.addAttribute("position",new Ze.BufferAttribute(pe,3)),fe.addAttribute("uv",new Ze.BufferAttribute(de,2)),function(t){Ze.Object3D.call(this),this.type="Sprite",this.geometry=fe,this.material=void 0!==t?t:new Ze.SpriteMaterial}),Ze.Sprite.prototype=Object.create(Ze.Object3D.prototype),Ze.Sprite.prototype.constructor=Ze.Sprite,Ze.Sprite.prototype.raycast=(me=new Ze.Vector3,function(t,e){me.setFromMatrixPosition(this.matrixWorld);var i=t.ray.distanceSqToPoint(me);this.scale.x*this.scale.y<i||e.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}),Ze.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},Ze.Sprite.prototype.toJSON=function(t){var e=Ze.Object3D.prototype.toJSON.call(this,t);return void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON()),e.object.material=this.material.uuid,e},Ze.Particle=Ze.Sprite,Ze.LensFlare=function(t,e,i,r,n){Ze.Object3D.call(this),this.lensFlares=[],this.positionScreen=new Ze.Vector3,(this.customUpdateCallback=void 0)!==t&&this.add(t,e,i,r,n)},Ze.LensFlare.prototype=Object.create(Ze.Object3D.prototype),Ze.LensFlare.prototype.constructor=Ze.LensFlare,Ze.LensFlare.prototype.add=function(t,e,i,r,n,o){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===n&&(n=new Ze.Color(16777215)),void 0===r&&(r=Ze.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:n,blending:r})},Ze.LensFlare.prototype.updateLensFlares=function(){var t,e,i=this.lensFlares.length,r=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(t=0;t<i;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+r*e.distance,e.y=this.positionScreen.y+n*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},Ze.LensFlare.prototype.copy=function(t){Ze.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;e<i;e++)this.lensFlares.push(t.lensFlares[e]);return this},Ze.Scene=function(){Ze.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},Ze.Scene.prototype=Object.create(Ze.Object3D.prototype),Ze.Scene.prototype.constructor=Ze.Scene,Ze.Scene.prototype.copy=function(t){return Ze.Object3D.prototype.copy.call(this,t),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},Ze.Fog=function(t,e,i){this.name="",this.color=new Ze.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},Ze.Fog.prototype.clone=function(){return new Ze.Fog(this.color.getHex(),this.near,this.far)},Ze.FogExp2=function(t,e){this.name="",this.color=new Ze.Color(t),this.density=void 0!==e?e:25e-5},Ze.FogExp2.prototype.clone=function(){return new Ze.FogExp2(this.color.getHex(),this.density)},Ze.ShaderChunk={},Ze.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\\n\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n",Ze.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\\n\\n\\tuniform sampler2D alphaMap;\\n\\n#endif\\n",Ze.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\\n\\n\\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n",Ze.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\\n\\n\\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\n#endif\\n",Ze.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\\n\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n\\n#endif",Ze.ShaderChunk.begin_vertex="\\nvec3 transformed = vec3( position );\\n",Ze.ShaderChunk.beginnormal_vertex="\\nvec3 objectNormal = vec3( normal );\\n",Ze.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\\n\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\n\\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\\tvec2 dHdxy_fwd() {\\n\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\\t\\treturn vec2( dBx, dBy );\\n\\n\\t}\\n\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\\t\\tvec3 vSigmaX = dFdx( surf_pos );\\n\\t\\tvec3 vSigmaY = dFdy( surf_pos );\\n\\t\\tvec3 vN = surf_norm;\\t\\t// normalized\\n\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\\t}\\n\\n#endif\\n",Ze.ShaderChunk.color_fragment="#ifdef USE_COLOR\\n\\n\\tdiffuseColor.rgb *= vColor;\\n\\n#endif",Ze.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\\n\\n\\tvarying vec3 vColor;\\n\\n#endif\\n",Ze.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\\n\\n\\tvarying vec3 vColor;\\n\\n#endif",Ze.ShaderChunk.color_vertex="#ifdef USE_COLOR\\n\\n\\tvColor.xyz = color.xyz;\\n\\n#endif",Ze.ShaderChunk.common="#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\n\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n\\n}\\n\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n\\n}\\n\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\n\\treturn - distance * planeNormal + point;\\n\\n}\\n\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n\\n}\\n\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n\\n}\\n\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\\n\\tif ( decayExponent > 0.0 ) {\\n\\n\\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\n\\t}\\n\\n\\treturn 1.0;\\n\\n}\\n\\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\\n\\n\\t// Original approximation by Christophe Schlick \'94\\n\\t//;float fresnel = pow( 1.0 - dotLH, 5.0 );\\n\\n\\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\\n\\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\\n\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n\\n}\\n\\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\\n\\n\\t// geometry term is (nl)(nv) / 4(nl)(nv)\\n\\n\\treturn 0.25;\\n\\n}\\n\\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\\n\\n\\t// factor of 1/PI in distribution term omitted\\n\\n\\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n\\n}\\n\\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\\n\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\n\\t//float dotNL = saturate( dot( normal, lightDir ) );\\n\\t//float dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\\n\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\n\\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\\n\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\n\\treturn F * G * D;\\n\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n\\n\\t#ifdef GAMMA_INPUT\\n\\n\\t\\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n\\n\\t#else\\n\\n\\t\\treturn a;\\n\\n\\t#endif\\n\\n}\\n\\nvec3 linearToOutput( in vec3 a ) {\\n\\n\\t#ifdef GAMMA_OUTPUT\\n\\n\\t\\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n\\n\\t#else\\n\\n\\t\\treturn a;\\n\\n\\t#endif\\n\\n}\\n",Ze.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\\n\\n\\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n",Ze.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\\n\\n\\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n\\n#endif\\n",Ze.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\\n\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n\\n#endif\\n",Ze.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\\n\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\n\\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\\n\\n\\ttotalEmissiveLight *= emissiveColor.rgb;\\n\\n#endif\\n",Ze.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\\n\\n\\tuniform sampler2D emissiveMap;\\n\\n#endif\\n",Ze.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\\n\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\\t\\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\\t\\t// Transforming Normal Vectors with the Inverse Transformation\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\\t\\t#else\\n\\n\\t\\t\\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\\t\\t#endif\\n\\n\\t#else\\n\\n\\t\\tvec3 reflectVec = vReflect;\\n\\n\\t#endif\\n\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#else\\n\\t\\tfloat flipNormal = 1.0;\\n\\t#endif\\n\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\tvec2 sampleUV;\\n\\t\\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\\t\\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\\t\\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\\t#endif\\n\\n\\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\\n\\n\\tuniform float reflectivity;\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\tuniform float flipEnvMap;\\n\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\\t\\tuniform float refractionRatio;\\n\\n\\t#else\\n\\n\\t\\tvarying vec3 vReflect;\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\\tvarying vec3 vReflect;\\n\\n\\tuniform float refractionRatio;\\n\\n#endif\\n",Ze.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\\t#else\\n\\n\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.fog_fragment="#ifdef USE_FOG\\n\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\\t\\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\\t#else\\n\\n\\t\\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\\t#endif\\n\\n\\t#ifdef FOG_EXP2\\n\\n\\t\\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\\n\\t#else\\n\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\\t#endif\\n\\t\\n\\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif",Ze.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\\n\\n\\tuniform vec3 fogColor;\\n\\n\\t#ifdef FOG_EXP2\\n\\n\\t\\tuniform float fogDensity;\\n\\n\\t#else\\n\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n\\n#endif",Ze.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\\n\\n\\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\n#endif\\n",Ze.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\\n\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n\\n#endif",Ze.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n",Ze.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\nvec3 normal = normalize( transformedNormal );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = pointLightColor[ i ];\\n\\n\\t\\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\\n\\t\\tvec3 lightDir = normalize( lVector );\\n\\n\\t\\t// attenuation\\n\\n\\t\\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat dotProduct = dot( normal, lightDir );\\n\\n\\t\\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\n\\t\\t\\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\\t\\t#endif\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = spotLightColor[ i ];\\n\\n\\t\\tvec3 lightPosition = spotLightPosition[ i ];\\n\\t\\tvec3 lVector = lightPosition - mvPosition.xyz;\\n\\t\\tvec3 lightDir = normalize( lVector );\\n\\n\\t\\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\\t\\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\\t\\t\\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\t\\t\\t// attenuation\\n\\n\\t\\t\\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\\t\\t\\tattenuation *= spotEffect;\\n\\n\\t\\t\\t// diffuse\\n\\n\\t\\t\\tfloat dotProduct = dot( normal, lightDir );\\n\\n\\t\\t\\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\\t\\t\\t#ifdef DOUBLE_SIDED\\n\\n\\t\\t\\t\\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\\t\\t\\t#endif\\n\\n\\t\\t}\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\\t\\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat dotProduct = dot( normal, lightDir );\\n\\n\\t\\tvLightFront += lightColor * saturate( dotProduct );\\n\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\n\\t\\t\\tvLightBack += lightColor * saturate( - dotProduct );\\n\\n\\t\\t#endif\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat dotProduct = dot( normal, lightDir );\\n\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\\t\\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\n\\t\\t\\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\\n\\n\\t\\t\\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\\t\\t#endif\\n\\n\\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\\tvLightBack += ambientLightColor;\\n\\n#endif\\n",Ze.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\\n\\n\\tvec3 normal = normalize( vNormal );\\n\\n\\t#ifdef DOUBLE_SIDED\\n\\n\\t\\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\\t#endif\\n\\n#else\\n\\n\\tvec3 fdx = dFdx( vViewPosition );\\n\\tvec3 fdy = dFdy( vViewPosition );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\n#ifdef USE_NORMALMAP\\n\\n\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 viewDir = normalize( vViewPosition );\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = pointLightColor[ i ];\\n\\n\\t\\tvec3 lightPosition = pointLightPosition[ i ];\\n\\t\\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\\t\\tvec3 lightDir = normalize( lVector );\\n\\n\\t\\t// attenuation\\n\\n\\t\\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\\t\\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\t\\t// specular\\n\\n\\t\\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\\t\\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = spotLightColor[ i ];\\n\\n\\t\\tvec3 lightPosition = spotLightPosition[ i ];\\n\\t\\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\\t\\tvec3 lightDir = normalize( lVector );\\n\\n\\t\\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\\t\\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\\t\\t\\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\\t\\t\\t// attenuation\\n\\n\\t\\t\\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\\t\\t\\tattenuation *= spotEffect;\\n\\n\\t\\t\\t// diffuse\\n\\n\\t\\t\\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\\t\\t\\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\\t\\t\\t// specular\\n\\n\\t\\t\\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\\t\\t\\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\t\\t}\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\\t\\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\\t\\ttotalDiffuseLight += lightColor * cosineTerm;\\n\\n\\t\\t// specular\\n\\n\\t\\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\\t\\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\\n\\n\\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\\t\\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\\t\\t// diffuse\\n\\n\\t\\tfloat dotProduct = dot( normal, lightDir );\\n\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\\t\\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\\t\\ttotalDiffuseLight += lightColor;\\n\\n\\t\\t// specular (sky term only)\\n\\n\\t\\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\\t\\ttotalSpecularLight += brdf * specularStrength * lightColor * max( dotProduct, 0.0 );\\n\\n\\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\\n\\n#else\\n\\n\\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\\n\\n#endif\\n",Ze.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\\tvarying vec3 vNormal;\\n\\n#endif\\n",Ze.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\\tvarying vec3 vWorldPosition;\\n\\n#endif\\n",Ze.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\\n",Ze.ShaderChunk.linear_to_gamma_fragment="\\n\\toutgoingLight = linearToOutput( outgoingLight );\\n",Ze.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif",Ze.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\\n\\n\\tuniform float logDepthBufFC;\\n\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\\t\\tvarying float vFragDepth;\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\\n\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\\t\\tvarying float vFragDepth;\\n\\n\\t#endif\\n\\n\\tuniform float logDepthBufFC;\\n\\n#endif",Ze.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\\n\\n\\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\\t\\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\\t#endif\\n\\n#endif",Ze.ShaderChunk.map_fragment="#ifdef USE_MAP\\n\\n\\tvec4 texelColor = texture2D( map, vUv );\\n\\n\\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\\tdiffuseColor *= texelColor;\\n\\n#endif\\n",Ze.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\\n\\n\\tuniform sampler2D map;\\n\\n#endif",Ze.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\\n\\n\\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n",Ze.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\\n\\n\\tuniform vec4 offsetRepeat;\\n\\tuniform sampler2D map;\\n\\n#endif\\n",Ze.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\\n\\n\\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n#endif\\n",Ze.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\\n\\n\\t#ifndef USE_MORPHNORMALS\\n\\n\\tuniform float morphTargetInfluences[ 8 ];\\n\\n\\t#else\\n\\n\\tuniform float morphTargetInfluences[ 4 ];\\n\\n\\t#endif\\n\\n#endif",Ze.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\\n\\n\\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\\t#ifndef USE_MORPHNORMALS\\n\\n\\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\\n\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n\\n\\t// Per-Pixel Tangent Space Normal Mapping\\n\\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\\t\\tvec3 q0 = dFdx( eye_pos.xyz );\\n\\t\\tvec3 q1 = dFdy( eye_pos.xyz );\\n\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\n\\t\\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\\t\\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\\t\\tvec3 N = normalize( surf_norm );\\n\\n\\t\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t\\tmapN.xy = normalScale * mapN.xy;\\n\\t\\tmat3 tsn = mat3( S, T, N );\\n\\t\\treturn normalize( tsn * mapN );\\n\\n\\t}\\n\\n#endif\\n",Ze.ShaderChunk.project_vertex="#ifdef USE_SKINNING\\n\\n\\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#else\\n\\n\\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n",Ze.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\\n\\n\\t#ifdef SHADOWMAP_DEBUG\\n\\n\\t\\tvec3 frustumColors[3];\\n\\t\\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\\t\\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\\t\\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\\t#endif\\n\\n\\tfloat fDepth;\\n\\tvec3 shadowColor = vec3( 1.0 );\\n\\n\\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\\t\\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\\t\\t\\t\\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\\t\\t\\t\\t// if ( all( something, something ) ) using this instead\\n\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\\t\\tbool inFrustum = all( inFrustumVec );\\n\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\\t\\tbool frustumTest = all( frustumTestVec );\\n\\n\\t\\tif ( frustumTest ) {\\n\\n\\t\\t\\tshadowCoord.z += shadowBias[ i ];\\n\\n\\t\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\\t\\t\\t\\t\\t\\t// Percentage-close filtering\\n\\t\\t\\t\\t\\t\\t// (9 pixel kernel)\\n\\t\\t\\t\\t\\t\\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\\t\\t\\t\\tfloat shadow = 0.0;\\n\\n\\t\\t/*\\n\\t\\t\\t\\t\\t\\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\\t\\t\\t\\t\\t\\t// must enroll loop manually\\n\\n\\t\\t\\t\\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\\t\\t\\t\\t\\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\\t\\t\\t\\t\\t\\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\\t\\t\\t\\t\\t\\t\\t\\t// doesn\'t seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\\t\\t\\t\\t\\t\\t\\t\\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\\t\\t\\t\\t\\t\\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\\t\\t\\t\\t\\t\\tif ( fDepth < shadowCoord.z )\\n\\t\\t\\t\\t\\t\\t\\tshadow += 1.0;\\n\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tshadow /= 9.0;\\n\\n\\t\\t*/\\n\\n\\t\\t\\t\\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\\t\\t\\t\\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\\t\\t\\t\\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\\t\\t\\t\\tfloat dx0 = -1.25 * xPixelOffset;\\n\\t\\t\\t\\tfloat dy0 = -1.25 * yPixelOffset;\\n\\t\\t\\t\\tfloat dx1 = 1.25 * xPixelOffset;\\n\\t\\t\\t\\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\\t\\t\\t\\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\\t\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\\t\\t\\t\\t\\t\\t// Percentage-close filtering\\n\\t\\t\\t\\t\\t\\t// (9 pixel kernel)\\n\\t\\t\\t\\t\\t\\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\\t\\t\\t\\tfloat shadow = 0.0;\\n\\n\\t\\t\\t\\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\\t\\t\\t\\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\\t\\t\\t\\tfloat dx0 = -1.0 * xPixelOffset;\\n\\t\\t\\t\\tfloat dy0 = -1.0 * yPixelOffset;\\n\\t\\t\\t\\tfloat dx1 = 1.0 * xPixelOffset;\\n\\t\\t\\t\\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\\t\\t\\t\\tmat3 shadowKernel;\\n\\t\\t\\t\\tmat3 depthKernel;\\n\\n\\t\\t\\t\\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\\t\\t\\t\\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\\t\\t\\t\\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\\t\\t\\t\\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\\t\\t\\t\\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\\t\\t\\t\\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\\t\\t\\t\\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\\t\\t\\t\\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\\t\\t\\t\\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\\t\\t\\t\\tvec3 shadowZ = vec3( shadowCoord.z );\\n\\t\\t\\t\\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\\t\\t\\t\\tshadowKernel[0] *= vec3(0.25);\\n\\n\\t\\t\\t\\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\\t\\t\\t\\tshadowKernel[1] *= vec3(0.25);\\n\\n\\t\\t\\t\\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\\t\\t\\t\\tshadowKernel[2] *= vec3(0.25);\\n\\n\\t\\t\\t\\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\\t\\t\\t\\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\\t\\t\\t\\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\\t\\t\\t\\tvec4 shadowValues;\\n\\t\\t\\t\\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\\t\\t\\t\\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\\t\\t\\t\\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\\t\\t\\t\\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\\t\\t\\t\\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\\t\\t\\t\\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\\t\\t\\t#else\\n\\n\\t\\t\\t\\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\\t\\t\\t\\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\\t\\t\\t\\tif ( fDepth < shadowCoord.z )\\n\\n\\t\\t// spot with multiple shadows is darker\\n\\n\\t\\t\\t\\t\\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\\t\\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\\t\\t// \\t\\t\\t\\t\\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\\t\\t\\t#endif\\n\\n\\t\\t}\\n\\n\\n\\t\\t#ifdef SHADOWMAP_DEBUG\\n\\n\\t\\t\\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\\t\\t#endif\\n\\n\\t}\\n\\n\\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n",Ze.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\\n\\n\\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\\t\\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\\t\\tfloat depth = dot( rgba_depth, bit_shift );\\n\\t\\treturn depth;\\n\\n\\t}\\n\\n#endif",Ze.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\\n\\n\\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif",Ze.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\\n\\n\\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\\t\\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\\t}\\n\\n#endif",Ze.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\\n\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif",Ze.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\\n\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\n\\t#ifdef BONE_TEXTURE\\n\\n\\t\\tuniform sampler2D boneTexture;\\n\\t\\tuniform int boneTextureWidth;\\n\\t\\tuniform int boneTextureHeight;\\n\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureWidth ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureWidth );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\\t\\t\\treturn bone;\\n\\n\\t\\t}\\n\\n\\t#else\\n\\n\\t\\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\n\\t\\t\\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\n\\t\\t}\\n\\n\\t#endif\\n\\n#endif\\n",Ze.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\\n\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n",Ze.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\\n\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\n#endif\\n",Ze.ShaderChunk.specularmap_fragment="float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\\tspecularStrength = 1.0;\\n\\n#endif",Ze.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\\n\\n\\tuniform sampler2D specularMap;\\n\\n#endif",Ze.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\\tvarying vec2 vUv2;\\n\\n#endif",Ze.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n\\n#endif",Ze.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\\tvUv2 = uv2;\\n\\n#endif",Ze.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\\tvarying vec2 vUv;\\n\\n#endif",Ze.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\\tvarying vec2 vUv;\\n\\tuniform vec4 offsetRepeat;\\n\\n#endif\\n",Ze.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif",Ze.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\\t#ifdef USE_SKINNING\\n\\n\\t\\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\\t#else\\n\\n\\t\\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\\n\\t#endif\\n\\n#endif\\n",Ze.UniformsUtils={merge:function(t){for(var e={},i=0;i<t.length;i++){var r=this.clone(t[i]);for(var n in r)e[n]=r[n]}return e},clone:function(t){var e={};for(var i in t)for(var r in e[i]={},t[i]){var n=t[i][r];n instanceof Ze.Color||n instanceof Ze.Vector2||n instanceof Ze.Vector3||n instanceof Ze.Vector4||n instanceof Ze.Matrix3||n instanceof Ze.Matrix4||n instanceof Ze.Texture?e[i][r]=n.clone():Array.isArray(n)?e[i][r]=n.slice():e[i][r]=n}return e}},Ze.UniformsLib={common:{diffuse:{type:"c",value:new Ze.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new Ze.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new Ze.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Ze.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},points:{psColor:{type:"c",value:new Ze.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new Ze.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Ze.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},Ze.ShaderLib={basic:{uniforms:Ze.UniformsUtils.merge([Ze.UniformsLib.common,Ze.UniformsLib.aomap,Ze.UniformsLib.fog,Ze.UniformsLib.shadowmap]),vertexShader:[Ze.ShaderChunk.common,Ze.ShaderChunk.uv_pars_vertex,Ze.ShaderChunk.uv2_pars_vertex,Ze.ShaderChunk.envmap_pars_vertex,Ze.ShaderChunk.color_pars_vertex,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.skinning_pars_vertex,Ze.ShaderChunk.shadowmap_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.uv_vertex,Ze.ShaderChunk.uv2_vertex,Ze.ShaderChunk.color_vertex,Ze.ShaderChunk.skinbase_vertex,"\\t#ifdef USE_ENVMAP",Ze.ShaderChunk.beginnormal_vertex,Ze.ShaderChunk.morphnormal_vertex,Ze.ShaderChunk.skinnormal_vertex,Ze.ShaderChunk.defaultnormal_vertex,"\\t#endif",Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.skinning_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,Ze.ShaderChunk.worldpos_vertex,Ze.ShaderChunk.envmap_vertex,Ze.ShaderChunk.shadowmap_vertex,"}"].join("\\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_fragment,Ze.ShaderChunk.uv_pars_fragment,Ze.ShaderChunk.uv2_pars_fragment,Ze.ShaderChunk.map_pars_fragment,Ze.ShaderChunk.alphamap_pars_fragment,Ze.ShaderChunk.aomap_pars_fragment,Ze.ShaderChunk.envmap_pars_fragment,Ze.ShaderChunk.fog_pars_fragment,Ze.ShaderChunk.shadowmap_pars_fragment,Ze.ShaderChunk.specularmap_pars_fragment,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tvec3 outgoingLight = vec3( 0.0 );","\\tvec4 diffuseColor = vec4( diffuse, opacity );","\\tvec3 totalAmbientLight = vec3( 1.0 );",Ze.ShaderChunk.logdepthbuf_fragment,Ze.ShaderChunk.map_fragment,Ze.ShaderChunk.color_fragment,Ze.ShaderChunk.alphamap_fragment,Ze.ShaderChunk.alphatest_fragment,Ze.ShaderChunk.specularmap_fragment,Ze.ShaderChunk.aomap_fragment,"\\toutgoingLight = diffuseColor.rgb * totalAmbientLight;",Ze.ShaderChunk.envmap_fragment,Ze.ShaderChunk.shadowmap_fragment,Ze.ShaderChunk.linear_to_gamma_fragment,Ze.ShaderChunk.fog_fragment,"\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\\n")},lambert:{uniforms:Ze.UniformsUtils.merge([Ze.UniformsLib.common,Ze.UniformsLib.fog,Ze.UniformsLib.lights,Ze.UniformsLib.shadowmap,{emissive:{type:"c",value:new Ze.Color(0)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\\tvarying vec3 vLightBack;","#endif",Ze.ShaderChunk.common,Ze.ShaderChunk.uv_pars_vertex,Ze.ShaderChunk.uv2_pars_vertex,Ze.ShaderChunk.envmap_pars_vertex,Ze.ShaderChunk.lights_lambert_pars_vertex,Ze.ShaderChunk.color_pars_vertex,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.skinning_pars_vertex,Ze.ShaderChunk.shadowmap_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.uv_vertex,Ze.ShaderChunk.uv2_vertex,Ze.ShaderChunk.color_vertex,Ze.ShaderChunk.beginnormal_vertex,Ze.ShaderChunk.morphnormal_vertex,Ze.ShaderChunk.skinbase_vertex,Ze.ShaderChunk.skinnormal_vertex,Ze.ShaderChunk.defaultnormal_vertex,Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.skinning_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,Ze.ShaderChunk.worldpos_vertex,Ze.ShaderChunk.envmap_vertex,Ze.ShaderChunk.lights_lambert_vertex,Ze.ShaderChunk.shadowmap_vertex,"}"].join("\\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\\tvarying vec3 vLightBack;","#endif",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_fragment,Ze.ShaderChunk.uv_pars_fragment,Ze.ShaderChunk.uv2_pars_fragment,Ze.ShaderChunk.map_pars_fragment,Ze.ShaderChunk.alphamap_pars_fragment,Ze.ShaderChunk.envmap_pars_fragment,Ze.ShaderChunk.fog_pars_fragment,Ze.ShaderChunk.shadowmap_pars_fragment,Ze.ShaderChunk.specularmap_pars_fragment,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tvec3 outgoingLight = vec3( 0.0 );","\\tvec4 diffuseColor = vec4( diffuse, opacity );",Ze.ShaderChunk.logdepthbuf_fragment,Ze.ShaderChunk.map_fragment,Ze.ShaderChunk.color_fragment,Ze.ShaderChunk.alphamap_fragment,Ze.ShaderChunk.alphatest_fragment,Ze.ShaderChunk.specularmap_fragment,"\\t#ifdef DOUBLE_SIDED","\\t\\tif ( gl_FrontFacing )","\\t\\t\\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\\t\\telse","\\t\\t\\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;","\\t#else","\\t\\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\\t#endif",Ze.ShaderChunk.envmap_fragment,Ze.ShaderChunk.shadowmap_fragment,Ze.ShaderChunk.linear_to_gamma_fragment,Ze.ShaderChunk.fog_fragment,"\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\\n")},phong:{uniforms:Ze.UniformsUtils.merge([Ze.UniformsLib.common,Ze.UniformsLib.aomap,Ze.UniformsLib.lightmap,Ze.UniformsLib.emissivemap,Ze.UniformsLib.bumpmap,Ze.UniformsLib.normalmap,Ze.UniformsLib.displacementmap,Ze.UniformsLib.fog,Ze.UniformsLib.lights,Ze.UniformsLib.shadowmap,{emissive:{type:"c",value:new Ze.Color(0)},specular:{type:"c",value:new Ze.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\\tvarying vec3 vNormal;","#endif",Ze.ShaderChunk.common,Ze.ShaderChunk.uv_pars_vertex,Ze.ShaderChunk.uv2_pars_vertex,Ze.ShaderChunk.displacementmap_pars_vertex,Ze.ShaderChunk.envmap_pars_vertex,Ze.ShaderChunk.lights_phong_pars_vertex,Ze.ShaderChunk.color_pars_vertex,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.skinning_pars_vertex,Ze.ShaderChunk.shadowmap_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.uv_vertex,Ze.ShaderChunk.uv2_vertex,Ze.ShaderChunk.color_vertex,Ze.ShaderChunk.beginnormal_vertex,Ze.ShaderChunk.morphnormal_vertex,Ze.ShaderChunk.skinbase_vertex,Ze.ShaderChunk.skinnormal_vertex,Ze.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","\\tvNormal = normalize( transformedNormal );","#endif",Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.displacementmap_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.skinning_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,"\\tvViewPosition = - mvPosition.xyz;",Ze.ShaderChunk.worldpos_vertex,Ze.ShaderChunk.envmap_vertex,Ze.ShaderChunk.lights_phong_vertex,Ze.ShaderChunk.shadowmap_vertex,"}"].join("\\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_fragment,Ze.ShaderChunk.uv_pars_fragment,Ze.ShaderChunk.uv2_pars_fragment,Ze.ShaderChunk.map_pars_fragment,Ze.ShaderChunk.alphamap_pars_fragment,Ze.ShaderChunk.aomap_pars_fragment,Ze.ShaderChunk.lightmap_pars_fragment,Ze.ShaderChunk.emissivemap_pars_fragment,Ze.ShaderChunk.envmap_pars_fragment,Ze.ShaderChunk.fog_pars_fragment,Ze.ShaderChunk.lights_phong_pars_fragment,Ze.ShaderChunk.shadowmap_pars_fragment,Ze.ShaderChunk.bumpmap_pars_fragment,Ze.ShaderChunk.normalmap_pars_fragment,Ze.ShaderChunk.specularmap_pars_fragment,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tvec3 outgoingLight = vec3( 0.0 );","\\tvec4 diffuseColor = vec4( diffuse, opacity );","\\tvec3 totalAmbientLight = ambientLightColor;","\\tvec3 totalEmissiveLight = emissive;",Ze.ShaderChunk.logdepthbuf_fragment,Ze.ShaderChunk.map_fragment,Ze.ShaderChunk.color_fragment,Ze.ShaderChunk.alphamap_fragment,Ze.ShaderChunk.alphatest_fragment,Ze.ShaderChunk.specularmap_fragment,Ze.ShaderChunk.lightmap_fragment,Ze.ShaderChunk.aomap_fragment,Ze.ShaderChunk.emissivemap_fragment,Ze.ShaderChunk.lights_phong_fragment,Ze.ShaderChunk.envmap_fragment,Ze.ShaderChunk.shadowmap_fragment,Ze.ShaderChunk.linear_to_gamma_fragment,Ze.ShaderChunk.fog_fragment,"\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\\n")},points:{uniforms:Ze.UniformsUtils.merge([Ze.UniformsLib.points,Ze.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_vertex,Ze.ShaderChunk.shadowmap_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.color_vertex,"\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\\t#ifdef USE_SIZEATTENUATION","\\t\\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );","\\t#else","\\t\\tgl_PointSize = size;","\\t#endif","\\tgl_Position = projectionMatrix * mvPosition;",Ze.ShaderChunk.logdepthbuf_vertex,Ze.ShaderChunk.worldpos_vertex,Ze.ShaderChunk.shadowmap_vertex,"}"].join("\\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_fragment,Ze.ShaderChunk.map_particle_pars_fragment,Ze.ShaderChunk.fog_pars_fragment,Ze.ShaderChunk.shadowmap_pars_fragment,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tvec3 outgoingLight = vec3( 0.0 );","\\tvec4 diffuseColor = vec4( psColor, opacity );",Ze.ShaderChunk.logdepthbuf_fragment,Ze.ShaderChunk.map_particle_fragment,Ze.ShaderChunk.color_fragment,Ze.ShaderChunk.alphatest_fragment,"\\toutgoingLight = diffuseColor.rgb;",Ze.ShaderChunk.shadowmap_fragment,Ze.ShaderChunk.fog_fragment,"\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\\n")},dashed:{uniforms:Ze.UniformsUtils.merge([Ze.UniformsLib.common,Ze.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.color_vertex,"\\tvLineDistance = scale * lineDistance;","\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\\tgl_Position = projectionMatrix * mvPosition;",Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",Ze.ShaderChunk.common,Ze.ShaderChunk.color_pars_fragment,Ze.ShaderChunk.fog_pars_fragment,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {","\\t\\tdiscard;","\\t}","\\tvec3 outgoingLight = vec3( 0.0 );","\\tvec4 diffuseColor = vec4( diffuse, opacity );",Ze.ShaderChunk.logdepthbuf_fragment,Ze.ShaderChunk.color_fragment,"\\toutgoingLight = diffuseColor.rgb;",Ze.ShaderChunk.fog_fragment,"\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[Ze.ShaderChunk.common,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",Ze.ShaderChunk.logdepthbuf_fragment,"\\t#ifdef USE_LOGDEPTHBUF_EXT","\\t\\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\\t#else","\\t\\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\\t#endif","\\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );","\\tgl_FragColor = vec4( vec3( color ), opacity );","}"].join("\\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",Ze.ShaderChunk.common,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\\tvNormal = normalize( normalMatrix * normal );",Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",Ze.ShaderChunk.logdepthbuf_fragment,"}"].join("\\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\\tvWorldPosition = transformDirection( position, modelMatrix );","\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",Ze.ShaderChunk.logdepthbuf_fragment,"}"].join("\\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\\tvWorldPosition = transformDirection( position, modelMatrix );","\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",Ze.ShaderChunk.logdepthbuf_fragment,"}"].join("\\n")},depthRGBA:{uniforms:{},vertexShader:[Ze.ShaderChunk.common,Ze.ShaderChunk.morphtarget_pars_vertex,Ze.ShaderChunk.skinning_pars_vertex,Ze.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",Ze.ShaderChunk.skinbase_vertex,Ze.ShaderChunk.begin_vertex,Ze.ShaderChunk.morphtarget_vertex,Ze.ShaderChunk.skinning_vertex,Ze.ShaderChunk.project_vertex,Ze.ShaderChunk.logdepthbuf_vertex,"}"].join("\\n"),fragmentShader:[Ze.ShaderChunk.common,Ze.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","\\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","\\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","\\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","\\tres -= res.xxyz * bit_mask;","\\treturn res;","}","void main() {",Ze.ShaderChunk.logdepthbuf_fragment,"\\t#ifdef USE_LOGDEPTHBUF_EXT","\\t\\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","\\t#else","\\t\\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","\\t#endif","}"].join("\\n")}},Ze.WebGLRenderer=function(t){console.log("THREE.WebGLRenderer",Ze.REVISION);var w=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),e=void 0!==t.context?t.context:null,r=w.width,n=w.height,_=1,i=void 0!==t.alpha&&t.alpha,o=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,h=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=new Ze.Color(0),u=0,p=[],d=[],f=-1,m=[],g=-1,y=[],v=-1,x=[],b=-1,S=new Float32Array(8),M=[],T=[];this.domElement=w,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var C,E=this,A=null,L=null,P=-1,k="",R=null,D=0,F=0,O=0,B=w.width,U=w.height,V=0,N=0,z=new Ze.Frustum,I=new Ze.Matrix4,j=new Ze.Vector3,H=new Ze.Vector3,G=!0,W={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},X={geometries:0,textures:0},q={calls:0,vertices:0,faces:0,points:0};this.info={render:q,memory:X,programs:null};try{var Y={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:h,preserveDrawingBuffer:c};if(null===(C=e||w.getContext("webgl",Y)||w.getContext("experimental-webgl",Y)))throw null!==w.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";w.addEventListener("webglcontextlost",lt,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var K=new Ze.WebGLExtensions(C);K.get("OES_texture_float"),K.get("OES_texture_float_linear"),K.get("OES_texture_half_float"),K.get("OES_texture_half_float_linear"),K.get("OES_standard_derivatives"),K.get("ANGLE_instanced_arrays"),K.get("OES_element_index_uint")&&(Ze.BufferGeometry.MaxIndex=4294967296);var Q=new Ze.WebGLCapabilities(C,K,t),Z=new Ze.WebGLState(C,K,Ot),J=new Ze.WebGLProperties,$=new Ze.WebGLObjects(C,J,this.info),tt=new Ze.WebGLPrograms(this,Q);this.info.programs=tt.programs;var et=new Ze.WebGLBufferRenderer(C,K,q),it=new Ze.WebGLIndexedBufferRenderer(C,K,q);function rt(t,e,i,r){!0===h&&(t*=r,e*=r,i*=r),C.clearColor(t,e,i,r)}function nt(){Z.init(),C.viewport(F,O,B,U),rt(l.r,l.g,l.b,u)}function ot(){R=A=null,P=-1,G=!(k=""),Z.reset()}nt(),this.context=C,this.capabilities=Q,this.extensions=K,this.state=Z;var at=new Ze.WebGLShadowMap(this,p,$);this.shadowMap=at;var st,ht=new Ze.SpritePlugin(this,M),ct=new Ze.LensFlarePlugin(this,T);function lt(t){t.preventDefault(),ot(),nt(),J.clear()}function ut(t){var e=t.target;e.removeEventListener("dispose",ut),function(t){var e=J.get(t);if(t.image&&e.__image__webglTextureCube)C.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)return;C.deleteTexture(e.__webglTexture)}J.delete(t)}(e),X.textures--}function pt(t){var e=t.target;e.removeEventListener("dispose",pt),function(t){var e=J.get(t);if(!t||void 0===e.__webglTexture)return;if(C.deleteTexture(e.__webglTexture),t instanceof Ze.WebGLRenderTargetCube)for(var i=0;i<6;i++)C.deleteFramebuffer(e.__webglFramebuffer[i]),C.deleteRenderbuffer(e.__webglRenderbuffer[i]);else C.deleteFramebuffer(e.__webglFramebuffer),C.deleteRenderbuffer(e.__webglRenderbuffer);J.delete(t)}(e),X.textures--}function dt(t){var e,i=t.target;i.removeEventListener("dispose",dt),ft(e=i),J.delete(e)}function ft(t){var e=J.get(t).program;(t.program=void 0)!==e&&tt.releaseProgram(e)}function mt(t,e){return e[0]-t[0]}function gt(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function yt(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function vt(t){var e,i;(i=t.material.transparent?(e=x,++b):(e=y,++v))<e.length?e[i]=t:e.push(t)}function xt(t,e,i,r,n){var o,a;a=i.transparent?(o=m,++g):(o=d,++f);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=i,s.z=j.z,s.group=n):(s={id:t.id,object:t,geometry:e,material:i,z:j.z,group:n},o.push(s))}function bt(t,e,i,r,n){for(var o=0,a=t.length;o<a;o++){var s=t[o],h=s.object,c=s.geometry,l=void 0===n?s.material:n,u=s.group;h.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),E.renderBufferDirect(e,i,r,c,l,h,u)}}function wt(t,e,i,r,n){for(var o=n,a=0,s=t.length;a<s;a++){var h=t[a];h.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),void 0===n&&(o=h.material),Mt(o);var c=_t(e,i,r,o,h);k="",h.render(function(t){E.renderBufferImmediate(t,c,o)})}}function Mt(t){var e;(e=t).side!==Ze.DoubleSide?Z.enable(C.CULL_FACE):Z.disable(C.CULL_FACE),Z.setFlipSided(e.side===Ze.BackSide),!0===t.transparent?Z.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha):Z.setBlending(Ze.NoBlending),Z.setDepthFunc(t.depthFunc),Z.setDepthTest(t.depthTest),Z.setDepthWrite(t.depthWrite),Z.setColorWrite(t.colorWrite),Z.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function _t(t,e,i,r,n){D=0;var o=J.get(r);!r.needsUpdate&&o.program||(!function(t,e,i,r){var n=J.get(t),o=tt.getParameters(t,e,i,r),a=tt.getProgramCode(t,o),s=n.program,h=!0;if(void 0===s)t.addEventListener("dispose",dt);else if(s.code!==a)ft(t);else{if(void 0!==o.shaderID)return;h=!1}if(h){if(o.shaderID){var c=Ze.ShaderLib[o.shaderID];n.__webglShader={name:t.type,uniforms:Ze.UniformsUtils.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else n.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=n.__webglShader,s=tt.acquireProgram(t,o,a),n.program=s,t.program=s}var l=s.getAttributes();if(t.morphTargets)for(var u=t.numSupportedMorphTargets=0;u<E.maxMorphTargets;u++)0<=l["morphTarget"+u]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(u=t.numSupportedMorphNormals=0;u<E.maxMorphNormals;u++)0<=l["morphNormal"+u]&&t.numSupportedMorphNormals++;n.uniformsList=[];var p=n.program.getUniforms();for(var d in n.__webglShader.uniforms){var f=p[d];f&&n.uniformsList.push([n.__webglShader.uniforms[d],f])}}(r,e,i,n),r.needsUpdate=!1);var a,s,h,c,l,u,p,d,f=!1,m=!1,g=!1,y=o.program,v=y.getUniforms(),x=o.__webglShader.uniforms;if(y.id!==A&&(C.useProgram(y.program),A=y.id,g=m=f=!0),r.id!==P&&(-1===P&&(g=!0),P=r.id,m=!0),(f||t!==R)&&(C.uniformMatrix4fv(v.projectionMatrix,!1,t.projectionMatrix.elements),Q.logarithmicDepthBuffer&&C.uniform1f(v.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==R&&(R=t),(r instanceof Ze.ShaderMaterial||r instanceof Ze.MeshPhongMaterial||r.envMap)&&void 0!==v.cameraPosition&&(j.setFromMatrixPosition(t.matrixWorld),C.uniform3f(v.cameraPosition,j.x,j.y,j.z)),(r instanceof Ze.MeshPhongMaterial||r instanceof Ze.MeshLambertMaterial||r instanceof Ze.MeshBasicMaterial||r instanceof Ze.ShaderMaterial||r.skinning)&&void 0!==v.viewMatrix&&C.uniformMatrix4fv(v.viewMatrix,!1,t.matrixWorldInverse.elements)),r.skinning)if(n.bindMatrix&&void 0!==v.bindMatrix&&C.uniformMatrix4fv(v.bindMatrix,!1,n.bindMatrix.elements),n.bindMatrixInverse&&void 0!==v.bindMatrixInverse&&C.uniformMatrix4fv(v.bindMatrixInverse,!1,n.bindMatrixInverse.elements),Q.floatVertexTextures&&n.skeleton&&n.skeleton.useVertexTexture){if(void 0!==v.boneTexture){var b=Ct();C.uniform1i(v.boneTexture,b),E.setTexture(n.skeleton.boneTexture,b)}void 0!==v.boneTextureWidth&&C.uniform1i(v.boneTextureWidth,n.skeleton.boneTextureWidth),void 0!==v.boneTextureHeight&&C.uniform1i(v.boneTextureHeight,n.skeleton.boneTextureHeight)}else n.skeleton&&n.skeleton.boneMatrices&&void 0!==v.boneGlobalMatrices&&C.uniformMatrix4fv(v.boneGlobalMatrices,!1,n.skeleton.boneMatrices);return m&&(i&&r.fog&&(u=i,(l=x).fogColor.value=u.color,u instanceof Ze.Fog?(l.fogNear.value=u.near,l.fogFar.value=u.far):u instanceof Ze.FogExp2&&(l.fogDensity.value=u.density)),(r instanceof Ze.MeshPhongMaterial||r instanceof Ze.MeshLambertMaterial||r.lights)&&(G&&(g=!0,function(t,e){var i,r,n,o,a,s,h,c,l=0,u=0,p=0,d=W,f=e.matrixWorldInverse,m=d.directional.colors,g=d.directional.positions,y=d.point.colors,v=d.point.positions,x=d.point.distances,b=d.point.decays,w=d.spot.colors,M=d.spot.positions,_=d.spot.distances,S=d.spot.directions,T=d.spot.anglesCos,C=d.spot.exponents,E=d.spot.decays,A=d.hemi.skyColors,L=d.hemi.groundColors,P=d.hemi.positions,k=0,R=0,D=0,F=0,O=0,B=0,U=0,V=0,N=0,z=0,I=0,G=0;for(i=0,r=t.length;i<r;i++)if(!(n=t[i]).onlyShadow)if(o=n.color,h=n.intensity,c=n.distance,n instanceof Ze.AmbientLight){if(!n.visible)continue;l+=o.r,u+=o.g,p+=o.b}else if(n instanceof Ze.DirectionalLight){if(O+=1,!n.visible)continue;H.setFromMatrixPosition(n.matrixWorld),j.setFromMatrixPosition(n.target.matrixWorld),H.sub(j),H.transformDirection(f),g[(N=3*k)+0]=H.x,g[N+1]=H.y,g[N+2]=H.z,Et(m,N,o,h),k+=1}else if(n instanceof Ze.PointLight){if(B+=1,!n.visible)continue;Et(y,z=3*R,o,h),j.setFromMatrixPosition(n.matrixWorld),j.applyMatrix4(f),v[z+0]=j.x,v[z+1]=j.y,v[z+2]=j.z,x[R]=c,b[R]=0===n.distance?0:n.decay,R+=1}else if(n instanceof Ze.SpotLight){if(U+=1,!n.visible)continue;Et(w,I=3*D,o,h),H.setFromMatrixPosition(n.matrixWorld),j.copy(H).applyMatrix4(f),M[I+0]=j.x,M[I+1]=j.y,M[I+2]=j.z,_[D]=c,j.setFromMatrixPosition(n.target.matrixWorld),H.sub(j),H.transformDirection(f),S[I+0]=H.x,S[I+1]=H.y,S[I+2]=H.z,T[D]=Math.cos(n.angle),C[D]=n.exponent,E[D]=0===n.distance?0:n.decay,D+=1}else if(n instanceof Ze.HemisphereLight){if(V+=1,!n.visible)continue;H.setFromMatrixPosition(n.matrixWorld),H.transformDirection(f),P[(G=3*F)+0]=H.x,P[G+1]=H.y,P[G+2]=H.z,a=n.color,s=n.groundColor,Et(A,G,a,h),Et(L,G,s,h),F+=1}for(i=3*k,r=Math.max(m.length,3*O);i<r;i++)m[i]=0;for(i=3*R,r=Math.max(y.length,3*B);i<r;i++)y[i]=0;for(i=3*D,r=Math.max(w.length,3*U);i<r;i++)w[i]=0;for(i=3*F,r=Math.max(A.length,3*V);i<r;i++)A[i]=0;for(i=3*F,r=Math.max(L.length,3*V);i<r;i++)L[i]=0;d.directional.length=k,d.point.length=R,d.spot.length=D,d.hemi.length=F,d.ambient[0]=l,d.ambient[1]=u,d.ambient[2]=p}(e,t),G=!1),g?(c=W,(h=x).ambientLightColor.value=c.ambient,h.directionalLightColor.value=c.directional.colors,h.directionalLightDirection.value=c.directional.positions,h.pointLightColor.value=c.point.colors,h.pointLightPosition.value=c.point.positions,h.pointLightDistance.value=c.point.distances,h.pointLightDecay.value=c.point.decays,h.spotLightColor.value=c.spot.colors,h.spotLightPosition.value=c.spot.positions,h.spotLightDistance.value=c.spot.distances,h.spotLightDirection.value=c.spot.directions,h.spotLightAngleCos.value=c.spot.anglesCos,h.spotLightExponent.value=c.spot.exponents,h.spotLightDecay.value=c.spot.decays,h.hemisphereLightSkyColor.value=c.hemi.skyColors,h.hemisphereLightGroundColor.value=c.hemi.groundColors,h.hemisphereLightDirection.value=c.hemi.positions,Tt(x,!0)):Tt(x,!1)),(r instanceof Ze.MeshBasicMaterial||r instanceof Ze.MeshLambertMaterial||r instanceof Ze.MeshPhongMaterial)&&function(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&(t.emissive.value=e.emissive);t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var i;e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap);if(void 0!==i){var r=i.offset,n=i.repeat;t.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof Ze.WebGLRenderTargetCube?1:-1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}(x,r),r instanceof Ze.LineBasicMaterial?St(x,r):r instanceof Ze.LineDashedMaterial?(St(x,r),s=r,(a=x).dashSize.value=s.dashSize,a.totalSize.value=s.dashSize+s.gapSize,a.scale.value=s.scale):r instanceof Ze.PointsMaterial?function(t,e){if(t.psColor.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size,t.scale.value=w.height/2,t.map.value=e.map,null!==e.map){var i=e.map.offset,r=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}}(x,r):r instanceof Ze.MeshPhongMaterial?function(t,e){t.specular.value=e.specular,t.shininess.value=e.shininess,e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale);e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(x,r):r instanceof Ze.MeshDepthMaterial?(x.mNear.value=t.near,x.mFar.value=t.far,x.opacity.value=r.opacity):r instanceof Ze.MeshNormalMaterial&&(x.opacity.value=r.opacity),n.receiveShadow&&!r._shadowPass&&function(t,e){if(t.shadowMatrix)for(var i=0,r=0,n=e.length;r<n;r++){var o=e[r];o.castShadow&&((o instanceof Ze.SpotLight||o instanceof Ze.DirectionalLight)&&(t.shadowMap.value[i]=o.shadowMap,t.shadowMapSize.value[i]=o.shadowMapSize,t.shadowMatrix.value[i]=o.shadowMatrix,t.shadowDarkness.value[i]=o.shadowDarkness,t.shadowBias.value[i]=o.shadowBias,i++))}}(x,e),function(t){for(var e,i,r=0,n=t.length;r<n;r++){var o=t[r][0];if(!1!==o.needsUpdate){var a=o.type,s=o.value,h=t[r][1];switch(a){case"1i":C.uniform1i(h,s);break;case"1f":C.uniform1f(h,s);break;case"2f":C.uniform2f(h,s[0],s[1]);break;case"3f":C.uniform3f(h,s[0],s[1],s[2]);break;case"4f":C.uniform4f(h,s[0],s[1],s[2],s[3]);break;case"1iv":C.uniform1iv(h,s);break;case"3iv":C.uniform3iv(h,s);break;case"1fv":C.uniform1fv(h,s);break;case"2fv":C.uniform2fv(h,s);break;case"3fv":C.uniform3fv(h,s);break;case"4fv":C.uniform4fv(h,s);break;case"Matrix3fv":C.uniformMatrix3fv(h,!1,s);break;case"Matrix4fv":C.uniformMatrix4fv(h,!1,s);break;case"i":C.uniform1i(h,s);break;case"f":C.uniform1f(h,s);break;case"v2":C.uniform2f(h,s.x,s.y);break;case"v3":C.uniform3f(h,s.x,s.y,s.z);break;case"v4":C.uniform4f(h,s.x,s.y,s.z,s.w);break;case"c":C.uniform3f(h,s.r,s.g,s.b);break;case"iv1":C.uniform1iv(h,s);break;case"iv":C.uniform3iv(h,s);break;case"fv1":C.uniform1fv(h,s);break;case"fv":C.uniform3fv(h,s);break;case"v2v":void 0===o._array&&(o._array=new Float32Array(2*s.length));for(var c=0,l=0,u=s.length;c<u;c++,l+=2)o._array[l+0]=s[c].x,o._array[l+1]=s[c].y;C.uniform2fv(h,o._array);break;case"v3v":void 0===o._array&&(o._array=new Float32Array(3*s.length));for(var c=0,p=0,u=s.length;c<u;c++,p+=3)o._array[p+0]=s[c].x,o._array[p+1]=s[c].y,o._array[p+2]=s[c].z;C.uniform3fv(h,o._array);break;case"v4v":void 0===o._array&&(o._array=new Float32Array(4*s.length));for(var c=0,d=0,u=s.length;c<u;c++,d+=4)o._array[d+0]=s[c].x,o._array[d+1]=s[c].y,o._array[d+2]=s[c].z,o._array[d+3]=s[c].w;C.uniform4fv(h,o._array);break;case"m3":C.uniformMatrix3fv(h,!1,s.elements);break;case"m3v":void 0===o._array&&(o._array=new Float32Array(9*s.length));for(var c=0,u=s.length;c<u;c++)s[c].flattenToArrayOffset(o._array,9*c);C.uniformMatrix3fv(h,!1,o._array);break;case"m4":C.uniformMatrix4fv(h,!1,s.elements);break;case"m4v":void 0===o._array&&(o._array=new Float32Array(16*s.length));for(var c=0,u=s.length;c<u;c++)s[c].flattenToArrayOffset(o._array,16*c);C.uniformMatrix4fv(h,!1,o._array);break;case"t":if(e=s,i=Ct(),C.uniform1i(h,i),!e)continue;e instanceof Ze.CubeTexture||Array.isArray(e.image)&&6===e.image.length?Pt(e,i):e instanceof Ze.WebGLRenderTargetCube?kt(e,i):E.setTexture(e,i);break;case"tv":void 0===o._array&&(o._array=[]);for(var c=0,u=o.value.length;c<u;c++)o._array[c]=Ct();C.uniform1iv(h,o._array);for(var c=0,u=o.value.length;c<u;c++)e=o.value[c],i=o._array[c],e&&E.setTexture(e,i);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+a)}}}}(o.uniformsList)),p=v,d=n,C.uniformMatrix4fv(p.modelViewMatrix,!1,d.modelViewMatrix.elements),p.normalMatrix&&C.uniformMatrix3fv(p.normalMatrix,!1,d.normalMatrix.elements),void 0!==v.modelMatrix&&C.uniformMatrix4fv(v.modelMatrix,!1,n.matrixWorld.elements),y}function St(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function Tt(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLightColor.needsUpdate=e,t.directionalLightDirection.needsUpdate=e,t.pointLightColor.needsUpdate=e,t.pointLightPosition.needsUpdate=e,t.pointLightDistance.needsUpdate=e,t.pointLightDecay.needsUpdate=e,t.spotLightColor.needsUpdate=e,t.spotLightPosition.needsUpdate=e,t.spotLightDistance.needsUpdate=e,t.spotLightDirection.needsUpdate=e,t.spotLightAngleCos.needsUpdate=e,t.spotLightExponent.needsUpdate=e,t.spotLightDecay.needsUpdate=e,t.hemisphereLightSkyColor.needsUpdate=e,t.hemisphereLightGroundColor.needsUpdate=e,t.hemisphereLightDirection.needsUpdate=e}function Ct(){var t=D;return t>=Q.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Q.maxTextures),D+=1,t}function Et(t,e,i,r){t[e+0]=i.r*r,t[e+1]=i.g*r,t[e+2]=i.b*r}function At(t,e,i){var r;if(i?(C.texParameteri(t,C.TEXTURE_WRAP_S,Ot(e.wrapS)),C.texParameteri(t,C.TEXTURE_WRAP_T,Ot(e.wrapT)),C.texParameteri(t,C.TEXTURE_MAG_FILTER,Ot(e.magFilter)),C.texParameteri(t,C.TEXTURE_MIN_FILTER,Ot(e.minFilter))):(C.texParameteri(t,C.TEXTURE_WRAP_S,C.CLAMP_TO_EDGE),C.texParameteri(t,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE),e.wrapS===Ze.ClampToEdgeWrapping&&e.wrapT===Ze.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+e.sourceFile+" )"),C.texParameteri(t,C.TEXTURE_MAG_FILTER,Ft(e.magFilter)),C.texParameteri(t,C.TEXTURE_MIN_FILTER,Ft(e.minFilter)),e.minFilter!==Ze.NearestFilter&&e.minFilter!==Ze.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+e.sourceFile+" )")),r=K.get("EXT_texture_filter_anisotropic")){if(e.type===Ze.FloatType&&null===K.get("OES_texture_float_linear"))return;if(e.type===Ze.HalfFloatType&&null===K.get("OES_texture_half_float_linear"))return;(1<e.anisotropy||J.get(e).__currentAnisotropy)&&(C.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,E.getMaxAnisotropy())),J.get(e).__currentAnisotropy=e.anisotropy)}}function Lt(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),r=document.createElement("canvas");return r.width=Math.floor(t.width*i),r.height=Math.floor(t.height*i),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function Pt(t,e){var i=J.get(t);if(6===t.image.length)if(0<t.version&&i.__version!==t.version){i.__image__webglTextureCube||(t.addEventListener("dispose",ut),i.__image__webglTextureCube=C.createTexture(),X.textures++),Z.activeTexture(C.TEXTURE0+e),Z.bindTexture(C.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var r=t instanceof Ze.CompressedTexture,n=t.image[0]instanceof Ze.DataTexture,o=[],a=0;a<6;a++)!E.autoScaleCubemaps||r||n?o[a]=n?t.image[a].image:t.image[a]:o[a]=Lt(t.image[a],Q.maxCubemapSize);var s=o[0],h=Ze.Math.isPowerOfTwo(s.width)&&Ze.Math.isPowerOfTwo(s.height),c=Ot(t.format),l=Ot(t.type);At(C.TEXTURE_CUBE_MAP,t,h);for(a=0;a<6;a++)if(r)for(var u,p=o[a].mipmaps,d=0,f=p.length;d<f;d++)u=p[d],t.format!==Ze.RGBAFormat&&t.format!==Ze.RGBFormat?-1<Z.getCompressedTextureFormats().indexOf(c)?Z.compressedTexImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,c,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):Z.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,c,u.width,u.height,0,c,l,u.data);else n?Z.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,o[a].width,o[a].height,0,c,l,o[a].data):Z.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,c,l,o[a]);t.generateMipmaps&&h&&C.generateMipmap(C.TEXTURE_CUBE_MAP),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else Z.activeTexture(C.TEXTURE0+e),Z.bindTexture(C.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)}function kt(t,e){Z.activeTexture(C.TEXTURE0+e),Z.bindTexture(C.TEXTURE_CUBE_MAP,J.get(t).__webglTexture)}function Rt(t,e,i){C.bindFramebuffer(C.FRAMEBUFFER,t),C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,i,J.get(e).__webglTexture,0)}function Dt(t,e){C.bindRenderbuffer(C.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(C.renderbufferStorage(C.RENDERBUFFER,C.DEPTH_COMPONENT16,e.width,e.height),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(C.renderbufferStorage(C.RENDERBUFFER,C.DEPTH_STENCIL,e.width,e.height),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.RENDERBUFFER,t)):C.renderbufferStorage(C.RENDERBUFFER,C.RGBA4,e.width,e.height)}function Ft(t){return t===Ze.NearestFilter||t===Ze.NearestMipMapNearestFilter||t===Ze.NearestMipMapLinearFilter?C.NEAREST:C.LINEAR}function Ot(t){var e;if(t===Ze.RepeatWrapping)return C.REPEAT;if(t===Ze.ClampToEdgeWrapping)return C.CLAMP_TO_EDGE;if(t===Ze.MirroredRepeatWrapping)return C.MIRRORED_REPEAT;if(t===Ze.NearestFilter)return C.NEAREST;if(t===Ze.NearestMipMapNearestFilter)return C.NEAREST_MIPMAP_NEAREST;if(t===Ze.NearestMipMapLinearFilter)return C.NEAREST_MIPMAP_LINEAR;if(t===Ze.LinearFilter)return C.LINEAR;if(t===Ze.LinearMipMapNearestFilter)return C.LINEAR_MIPMAP_NEAREST;if(t===Ze.LinearMipMapLinearFilter)return C.LINEAR_MIPMAP_LINEAR;if(t===Ze.UnsignedByteType)return C.UNSIGNED_BYTE;if(t===Ze.UnsignedShort4444Type)return C.UNSIGNED_SHORT_4_4_4_4;if(t===Ze.UnsignedShort5551Type)return C.UNSIGNED_SHORT_5_5_5_1;if(t===Ze.UnsignedShort565Type)return C.UNSIGNED_SHORT_5_6_5;if(t===Ze.ByteType)return C.BYTE;if(t===Ze.ShortType)return C.SHORT;if(t===Ze.UnsignedShortType)return C.UNSIGNED_SHORT;if(t===Ze.IntType)return C.INT;if(t===Ze.UnsignedIntType)return C.UNSIGNED_INT;if(t===Ze.FloatType)return C.FLOAT;if(null!==(e=K.get("OES_texture_half_float"))&&t===Ze.HalfFloatType)return e.HALF_FLOAT_OES;if(t===Ze.AlphaFormat)return C.ALPHA;if(t===Ze.RGBFormat)return C.RGB;if(t===Ze.RGBAFormat)return C.RGBA;if(t===Ze.LuminanceFormat)return C.LUMINANCE;if(t===Ze.LuminanceAlphaFormat)return C.LUMINANCE_ALPHA;if(t===Ze.AddEquation)return C.FUNC_ADD;if(t===Ze.SubtractEquation)return C.FUNC_SUBTRACT;if(t===Ze.ReverseSubtractEquation)return C.FUNC_REVERSE_SUBTRACT;if(t===Ze.ZeroFactor)return C.ZERO;if(t===Ze.OneFactor)return C.ONE;if(t===Ze.SrcColorFactor)return C.SRC_COLOR;if(t===Ze.OneMinusSrcColorFactor)return C.ONE_MINUS_SRC_COLOR;if(t===Ze.SrcAlphaFactor)return C.SRC_ALPHA;if(t===Ze.OneMinusSrcAlphaFactor)return C.ONE_MINUS_SRC_ALPHA;if(t===Ze.DstAlphaFactor)return C.DST_ALPHA;if(t===Ze.OneMinusDstAlphaFactor)return C.ONE_MINUS_DST_ALPHA;if(t===Ze.DstColorFactor)return C.DST_COLOR;if(t===Ze.OneMinusDstColorFactor)return C.ONE_MINUS_DST_COLOR;if(t===Ze.SrcAlphaSaturateFactor)return C.SRC_ALPHA_SATURATE;if(null!==(e=K.get("WEBGL_compressed_texture_s3tc"))){if(t===Ze.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Ze.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===Ze.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Ze.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=K.get("WEBGL_compressed_texture_pvrtc"))){if(t===Ze.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Ze.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===Ze.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Ze.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=K.get("EXT_blend_minmax"))){if(t===Ze.MinEquation)return e.MIN_EXT;if(t===Ze.MaxEquation)return e.MAX_EXT}return 0}this.getContext=function(){return C},this.getContextAttributes=function(){return C.getContextAttributes()},this.forceContextLoss=function(){K.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){if(void 0!==st)return st;var t=K.get("EXT_texture_filter_anisotropic");return st=null!==t?C.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPrecision=function(){return Q.precision},this.getPixelRatio=function(){return _},this.setPixelRatio=function(t){void 0!==t&&(_=t)},this.getSize=function(){return{width:r,height:n}},this.setSize=function(t,e,i){r=t,n=e,w.width=t*_,w.height=e*_,!1!==i&&(w.style.width=t+"px",w.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,r){F=t*_,O=e*_,B=i*_,U=r*_,C.viewport(F,O,B,U)},this.setScissor=function(t,e,i,r){C.scissor(t*_,e*_,i*_,r*_)},this.enableScissorTest=function(t){Z.setScissorTest(t)},this.getClearColor=function(){return l},this.setClearColor=function(t,e){l.set(t),u=void 0!==e?e:1,rt(l.r,l.g,l.b,u)},this.getClearAlpha=function(){return u},this.setClearAlpha=function(t){u=t,rt(l.r,l.g,l.b,u)},this.clear=function(t,e,i){var r=0;(void 0===t||t)&&(r|=C.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=C.DEPTH_BUFFER_BIT),(void 0===i||i)&&(r|=C.STENCIL_BUFFER_BIT),C.clear(r)},this.clearColor=function(){C.clear(C.COLOR_BUFFER_BIT)},this.clearDepth=function(){C.clear(C.DEPTH_BUFFER_BIT)},this.clearStencil=function(){C.clear(C.STENCIL_BUFFER_BIT)},this.clearTarget=function(t,e,i,r){this.setRenderTarget(t),this.clear(e,i,r)},this.resetGLState=ot,this.dispose=function(){w.removeEventListener("webglcontextlost",lt,!1)},this.renderBufferImmediate=function(t,e,i){Z.initAttributes();var r=J.get(t);t.hasPositions&&!r.position&&(r.position=C.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=C.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=C.createBuffer()),t.hasColors&&!r.color&&(r.color=C.createBuffer());var n=e.getAttributes();if(t.hasPositions&&(C.bindBuffer(C.ARRAY_BUFFER,r.position),C.bufferData(C.ARRAY_BUFFER,t.positionArray,C.DYNAMIC_DRAW),Z.enableAttribute(n.position),C.vertexAttribPointer(n.position,3,C.FLOAT,!1,0,0)),t.hasNormals){if(C.bindBuffer(C.ARRAY_BUFFER,r.normal),"MeshPhongMaterial"!==i.type&&i.shading===Ze.FlatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,h=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,l=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=h,s[o+1]=c,s[o+2]=l,s[o+3]=h,s[o+4]=c,s[o+5]=l,s[o+6]=h,s[o+7]=c,s[o+8]=l}C.bufferData(C.ARRAY_BUFFER,t.normalArray,C.DYNAMIC_DRAW),Z.enableAttribute(n.normal),C.vertexAttribPointer(n.normal,3,C.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(C.bindBuffer(C.ARRAY_BUFFER,r.uv),C.bufferData(C.ARRAY_BUFFER,t.uvArray,C.DYNAMIC_DRAW),Z.enableAttribute(n.uv),C.vertexAttribPointer(n.uv,2,C.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==Ze.NoColors&&(C.bindBuffer(C.ARRAY_BUFFER,r.color),C.bufferData(C.ARRAY_BUFFER,t.colorArray,C.DYNAMIC_DRAW),Z.enableAttribute(n.color),C.vertexAttribPointer(n.color,3,C.FLOAT,!1,0,0)),Z.disableUnusedAttributes(),C.drawArrays(C.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,r,n,o,a){Mt(n);var s=_t(t,e,i,n,o),h=!1,c=r.id+"_"+s.id+"_"+n.wireframe;c!==k&&(k=c,h=!0);var l=o.morphTargetInfluences;if(void 0!==l){for(var u=[],p=0,d=l.length;p<d;p++){var f=l[p];u.push([f,p])}u.sort(mt),8<u.length&&(u.length=8);var m=r.morphAttributes;for(p=0,d=u.length;p<d;p++){f=u[p];if(S[p]=f[0],0!==f[0]){var g=f[1];!0===n.morphTargets&&m.position&&r.addAttribute("morphTarget"+p,m.position[g]),!0===n.morphNormals&&m.normal&&r.addAttribute("morphNormal"+p,m.normal[g])}else!0===n.morphTargets&&r.removeAttribute("morphTarget"+p),!0===n.morphNormals&&r.removeAttribute("morphNormal"+p)}var y=s.getUniforms();null!==y.morphTargetInfluences&&C.uniform1fv(y.morphTargetInfluences,S),h=!0}g=r.index;var v,x=r.attributes.position;if(!0===n.wireframe&&(g=$.getWireframeAttribute(r)),null!==g?(v=it).setIndex(g):v=et,h&&(!function(t,e,i,r){var n;if(i instanceof Ze.InstancedBufferGeometry&&null===(n=K.get("ANGLE_instanced_arrays")))return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===r&&(r=0);Z.initAttributes();var o=i.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var h in a){var c=a[h];if(0<=c){var l=o[h];if(void 0!==l){Z.enableAttribute(c);var u=l.itemSize,p=$.getAttributeBuffer(l);if(l instanceof Ze.InterleavedBufferAttribute){var d=l.data,f=d.stride,m=l.offset;if(C.bindBuffer(C.ARRAY_BUFFER,p),C.vertexAttribPointer(c,u,C.FLOAT,!1,f*d.array.BYTES_PER_ELEMENT,(r*f+m)*d.array.BYTES_PER_ELEMENT),d instanceof Ze.InstancedInterleavedBuffer){if(null===n)return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");n.vertexAttribDivisorANGLE(c,d.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=d.meshPerAttribute*d.count)}}else if(C.bindBuffer(C.ARRAY_BUFFER,p),C.vertexAttribPointer(c,u,C.FLOAT,!1,0,r*u*4),l instanceof Ze.InstancedBufferAttribute){if(null===n)return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");n.vertexAttribDivisorANGLE(c,l.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=l.meshPerAttribute*l.count)}}else if(void 0!==s){var g=s[h];if(void 0!==g)switch(g.length){case 2:C.vertexAttrib2fv(c,g);break;case 3:C.vertexAttrib3fv(c,g);break;case 4:C.vertexAttrib4fv(c,g);break;default:C.vertexAttrib1fv(c,g)}}}}Z.disableUnusedAttributes()}(n,s,r),null!==g&&C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,$.getAttributeBuffer(g))),void 0===a){var b;b=null!==g?g.count:x instanceof Ze.InterleavedBufferAttribute?x.data.array.length/3:x.count;var w=r.drawRange;a={start:w.start,count:Math.min(w.count,b)}}if(o instanceof Ze.Mesh)!0===n.wireframe?(Z.setLineWidth(n.wireframeLinewidth*_),v.setMode(C.LINES)):v.setMode(C.TRIANGLES),r instanceof Ze.InstancedBufferGeometry&&0<r.maxInstancedCount?v.renderInstances(r):v.render(a.start,a.count);else if(o instanceof Ze.Line){var M=n.linewidth;void 0===M&&(M=1),Z.setLineWidth(M*_),o instanceof Ze.LineSegments?v.setMode(C.LINES):v.setMode(C.LINE_STRIP),v.render(a.start,a.count)}else o instanceof Ze.Points&&(v.setMode(C.POINTS),v.render(a.start,a.count))},this.render=function(t,e,i,r){if(e instanceof Ze.Camera!=!1){var n,o=t.fog;if(k="",P=-1,(G=!(R=null))===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),I.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),z.setFromMatrix(I),p.length=0,b=v=g=f=-1,M.length=0,T.length=0,function t(e){if(!1===e.visible)return;if(e instanceof Ze.Light)p.push(e);else if(e instanceof Ze.Sprite)M.push(e);else if(e instanceof Ze.LensFlare)T.push(e);else if(e instanceof Ze.ImmediateRenderObject)vt(e);else if((e instanceof Ze.Mesh||e instanceof Ze.Line||e instanceof Ze.Points)&&(e instanceof Ze.SkinnedMesh&&e.skeleton.update(),!1===e.frustumCulled||!0===z.intersectsObject(e))){var i=e.material;if(!0===i.visible){!0===E.sortObjects&&(j.setFromMatrixPosition(e.matrixWorld),j.applyProjection(I));var r=$.update(e);if(i instanceof Ze.MeshFaceMaterial)for(var n=r.groups,o=i.materials,a=0,s=n.length;a<s;a++){var h=n[a],c=o[h.materialIndex];!0===c.visible&&xt(e,r,c,j.z,h)}else xt(e,r,i,j.z)}}var l=e.children;for(var a=0,s=l.length;a<s;a++)t(l[a])}(t),d.length=f+1,m.length=g+1,y.length=v+1,x.length=b+1,!0===E.sortObjects&&(d.sort(gt),m.sort(yt)),at.render(t,e),q.calls=0,q.vertices=0,q.faces=0,q.points=0,this.setRenderTarget(i),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial){var a=t.overrideMaterial;bt(d,e,p,o,a),bt(m,e,p,o,a),wt(y,e,p,o,a),wt(x,e,p,o,a)}else Z.setBlending(Ze.NoBlending),bt(d,e,p,o),wt(y,e,p,o),bt(m,e,p,o),wt(x,e,p,o);ht.render(t,e),ct.render(t,e,V,N),i&&i.generateMipmaps&&i.minFilter!==Ze.NearestFilter&&i.minFilter!==Ze.LinearFilter&&((n=i)instanceof Ze.WebGLRenderTargetCube?(Z.bindTexture(C.TEXTURE_CUBE_MAP,J.get(n).__webglTexture),C.generateMipmap(C.TEXTURE_CUBE_MAP),Z.bindTexture(C.TEXTURE_CUBE_MAP,null)):(Z.bindTexture(C.TEXTURE_2D,J.get(n).__webglTexture),C.generateMipmap(C.TEXTURE_2D),Z.bindTexture(C.TEXTURE_2D,null))),Z.setDepthTest(!0),Z.setDepthWrite(!0),Z.setColorWrite(!0)}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){t===Ze.CullFaceNone?Z.disable(C.CULL_FACE):(e===Ze.FrontFaceDirectionCW?C.frontFace(C.CW):C.frontFace(C.CCW),t===Ze.CullFaceBack?C.cullFace(C.BACK):t===Ze.CullFaceFront?C.cullFace(C.FRONT):C.cullFace(C.FRONT_AND_BACK),Z.enable(C.CULL_FACE))},this.setTexture=function(t,e){var i=J.get(t);if(0<t.version&&i.__version!==t.version){var r=t.image;return void 0===r?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t):!1===r.complete?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t):void function(t,e,i){void 0===t.__webglInit&&(t.__webglInit=!0,e.__webglInit=!0,e.addEventListener("dispose",ut),t.__webglTexture=C.createTexture(),X.textures++),Z.activeTexture(C.TEXTURE0+i),Z.bindTexture(C.TEXTURE_2D,t.__webglTexture),C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,e.flipY),C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),C.pixelStorei(C.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=Lt(e.image,Q.maxTextureSize);var r=e.image,n=Ze.Math.isPowerOfTwo(r.width)&&Ze.Math.isPowerOfTwo(r.height),o=Ot(e.format),a=Ot(e.type);At(C.TEXTURE_2D,e,n);var s,h=e.mipmaps;if(e instanceof Ze.DataTexture)if(0<h.length&&n){for(var c=0,l=h.length;c<l;c++)s=h[c],Z.texImage2D(C.TEXTURE_2D,c,o,s.width,s.height,0,o,a,s.data);e.generateMipmaps=!1}else Z.texImage2D(C.TEXTURE_2D,0,o,r.width,r.height,0,o,a,r.data);else if(e instanceof Ze.CompressedTexture)for(c=0,l=h.length;c<l;c++)s=h[c],e.format!==Ze.RGBAFormat&&e.format!==Ze.RGBFormat?-1<Z.getCompressedTextureFormats().indexOf(o)?Z.compressedTexImage2D(C.TEXTURE_2D,c,o,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Z.texImage2D(C.TEXTURE_2D,c,o,s.width,s.height,0,o,a,s.data);else if(0<h.length&&n){for(c=0,l=h.length;c<l;c++)s=h[c],Z.texImage2D(C.TEXTURE_2D,c,o,o,a,s);e.generateMipmaps=!1}else Z.texImage2D(C.TEXTURE_2D,0,o,o,a,e.image);e.generateMipmaps&&n&&C.generateMipmap(C.TEXTURE_2D),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}(i,t,e)}Z.activeTexture(C.TEXTURE0+e),Z.bindTexture(C.TEXTURE_2D,i.__webglTexture)},this.setRenderTarget=function(t){var e,i,r,n,o,a=t instanceof Ze.WebGLRenderTargetCube;if(t&&void 0===J.get(t).__webglFramebuffer){var s=J.get(t);void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",pt),s.__webglTexture=C.createTexture(),X.textures++;var h=Ze.Math.isPowerOfTwo(t.width)&&Ze.Math.isPowerOfTwo(t.height),c=Ot(t.format),l=Ot(t.type);if(a){s.__webglFramebuffer=[],s.__webglRenderbuffer=[],Z.bindTexture(C.TEXTURE_CUBE_MAP,s.__webglTexture),At(C.TEXTURE_CUBE_MAP,t,h);for(var u=0;u<6;u++)s.__webglFramebuffer[u]=C.createFramebuffer(),s.__webglRenderbuffer[u]=C.createRenderbuffer(),Z.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+u,0,c,t.width,t.height,0,c,l,null),Rt(s.__webglFramebuffer[u],t,C.TEXTURE_CUBE_MAP_POSITIVE_X+u),Dt(s.__webglRenderbuffer[u],t);t.generateMipmaps&&h&&C.generateMipmap(C.TEXTURE_CUBE_MAP)}else s.__webglFramebuffer=C.createFramebuffer(),t.shareDepthFrom?s.__webglRenderbuffer=t.shareDepthFrom.__webglRenderbuffer:s.__webglRenderbuffer=C.createRenderbuffer(),Z.bindTexture(C.TEXTURE_2D,s.__webglTexture),At(C.TEXTURE_2D,t,h),Z.texImage2D(C.TEXTURE_2D,0,c,t.width,t.height,0,c,l,null),Rt(s.__webglFramebuffer,t,C.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,s.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.RENDERBUFFER,s.__webglRenderbuffer):Dt(s.__webglRenderbuffer,t),t.generateMipmaps&&h&&C.generateMipmap(C.TEXTURE_2D);a?Z.bindTexture(C.TEXTURE_CUBE_MAP,null):Z.bindTexture(C.TEXTURE_2D,null),C.bindRenderbuffer(C.RENDERBUFFER,null),C.bindFramebuffer(C.FRAMEBUFFER,null)}if(t){s=J.get(t);e=a?s.__webglFramebuffer[t.activeCubeFace]:s.__webglFramebuffer,i=t.width,r=t.height,o=n=0}else e=null,i=B,r=U,n=F,o=O;e!==L&&(C.bindFramebuffer(C.FRAMEBUFFER,e),C.viewport(n,o,i,r),L=e),V=i,N=r},this.readRenderTargetPixels=function(t,e,i,r,n,o){if(t instanceof Ze.WebGLRenderTarget){if(J.get(t).__webglFramebuffer){if(t.format!==Ze.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var a=!1;J.get(t).__webglFramebuffer!==L&&(C.bindFramebuffer(C.FRAMEBUFFER,J.get(t).__webglFramebuffer),a=!0),C.checkFramebufferStatus(C.FRAMEBUFFER)===C.FRAMEBUFFER_COMPLETE?C.readPixels(e,i,r,n,C.RGBA,C.UNSIGNED_BYTE,o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&C.bindFramebuffer(C.FRAMEBUFFER,L)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' )."),K.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' )."),K.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' )."),K.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' )."),K.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' )."),K.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' )."),K.get("EXT_blend_minmax")},this.supportsVertexTextures=function(){return Q.vertexTextures},this.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' )."),K.get("ANGLE_instanced_arrays")},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Object.defineProperties(this,{shadowMapEnabled:{get:function(){return at.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),at.enabled=t}},shadowMapType:{get:function(){return at.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),at.type=t}},shadowMapCullFace:{get:function(){return at.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),at.cullFace=t}},shadowMapDebug:{get:function(){return at.debug},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug."),at.debug=t}}})},Ze.WebGLRenderTarget=function(t,e,i){this.uuid=Ze.Math.generateUUID(),this.width=t,this.height=e,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:Ze.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:Ze.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:Ze.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:Ze.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new Ze.Vector2(0,0),this.repeat=new Ze.Vector2(1,1),this.format=void 0!==i.format?i.format:Ze.RGBAFormat,this.type=void 0!==i.type?i.type:Ze.UnsignedByteType,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==i.shareDepthFrom?i.shareDepthFrom:null},Ze.WebGLRenderTarget.prototype={constructor:Ze.WebGLRenderTarget,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose())},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.format=t.format,this.type=t.type,this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.generateMipmaps=t.generateMipmaps,this.shareDepthFrom=t.shareDepthFrom,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},Ze.EventDispatcher.prototype.apply(Ze.WebGLRenderTarget.prototype),Ze.WebGLRenderTargetCube=function(t,e,i){Ze.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0},Ze.WebGLRenderTargetCube.prototype=Object.create(Ze.WebGLRenderTarget.prototype),Ze.WebGLRenderTargetCube.prototype.constructor=Ze.WebGLRenderTargetCube,Ze.WebGLBufferRenderer=function(i,r,n){var o;this.setMode=function(t){o=t},this.render=function(t,e){i.drawArrays(o,t,e),n.calls++,n.vertices+=e,o===i.TRIANGLES&&(n.faces+=e/3)},this.renderInstances=function(t){var e=r.get("ANGLE_instanced_arrays");if(null!==e){var i=t.attributes.position;i instanceof Ze.InterleavedBufferAttribute?e.drawArraysInstancedANGLE(o,0,i.data.count,t.maxInstancedCount):e.drawArraysInstancedANGLE(o,0,i.count,t.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}},Ze.WebGLIndexedBufferRenderer=function(i,r,n){var o,a,s;this.setMode=function(t){o=t},this.setIndex=function(t){s=t.array instanceof Uint32Array&&r.get("OES_element_index_uint")?(a=i.UNSIGNED_INT,4):(a=i.UNSIGNED_SHORT,2)},this.render=function(t,e){i.drawElements(o,e,a,t*s),n.calls++,n.vertices+=e,o===i.TRIANGLES&&(n.faces+=e/3)},this.renderInstances=function(t){var e=r.get("ANGLE_instanced_arrays");if(null!==e){var i=t.index;e.drawElementsInstancedANGLE(o,i.array.length,a,0,t.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}},Ze.WebGLExtensions=function(i){var r={};this.get=function(t){if(void 0!==r[t])return r[t];var e;switch(t){case"EXT_texture_filter_anisotropic":e=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=i.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),r[t]=e}},Ze.WebGLCapabilities=function(e,t,i){function r(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=r,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer&&i.logarithmicDepthBuffer,this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxCubemapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=e.getParameter(e.MAX_VARYING_VECTORS),this.maxFragmentUniforms=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!t.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var n=r(this.precision);n!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",n,"instead."),this.precision=n),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!t.get("EXT_frag_depth"))},Ze.WebGLGeometries=function(n,o,r){var a={};function s(t){var e=t.target;!function(t){for(var e in t)h(t[e])}(a[e.id].attributes),e.removeEventListener("dispose",s),delete a[e.id];var i=o.get(e);i.wireframe&&h(i.wireframe),r.memory.geometries--}function h(t){var e,i,r=(e=t)instanceof Ze.InterleavedBufferAttribute?o.get(e.data).__webglBuffer:o.get(e).__webglBuffer;void 0!==r&&(n.deleteBuffer(r),(i=t)instanceof Ze.InterleavedBufferAttribute?o.delete(i.data):o.delete(i))}this.get=function(t){var e,i=t.geometry;return void 0!==a[i.id]?a[i.id]:(i.addEventListener("dispose",s),i instanceof Ze.BufferGeometry?e=i:i instanceof Ze.Geometry&&(void 0===i._bufferGeometry&&(i._bufferGeometry=(new Ze.BufferGeometry).setFromObject(t)),e=i._bufferGeometry),a[i.id]=e,r.memory.geometries++,e)}},Ze.WebGLObjects=function(m,g,t){var c=new Ze.WebGLGeometries(m,g,t);function y(t,e){var i=t instanceof Ze.InterleavedBufferAttribute?t.data:t,r=g.get(i);void 0===r.__webglBuffer?function(t,e,i){t.__webglBuffer=m.createBuffer(),m.bindBuffer(i,t.__webglBuffer);var r=e.dynamic?m.DYNAMIC_DRAW:m.STATIC_DRAW;m.bufferData(i,e.array,r),t.version=e.version}(r,i,e):r.version!==i.version&&function(t,e,i){m.bindBuffer(i,t.__webglBuffer),!1===e.dynamic||-1===e.updateRange.count?m.bufferSubData(i,0,e.array):0===e.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(m.bufferSubData(i,e.updateRange.offset*e.array.BYTES_PER_ELEMENT,e.array.subarray(e.updateRange.offset,e.updateRange.offset+e.updateRange.count)),e.updateRange.count=0);t.version=e.version}(r,i,e)}function v(t,e,i){if(i<e){var r=e;e=i,i=r}var n=t[e];return void 0===n?(t[e]=[i],!0):-1===n.indexOf(i)&&(n.push(i),!0)}this.getAttributeBuffer=function(t){return t instanceof Ze.InterleavedBufferAttribute?g.get(t.data).__webglBuffer:g.get(t).__webglBuffer},this.getWireframeAttribute=function(t){var e=g.get(t);if(void 0!==e.wireframe)return e.wireframe;var i,r=[],n=t.index,o=t.attributes,a=o.position;if(null!==n)for(var s={},h=0,c=(i=n.array).length;h<c;h+=3){var l=i[h+0],u=i[h+1],p=i[h+2];v(s,l,u)&&r.push(l,u),v(s,u,p)&&r.push(u,p),v(s,p,l)&&r.push(p,l)}else for(h=0,c=(i=o.position.array).length/3-1;h<c;h+=3)l=h+0,u=h+1,p=h+2,r.push(l,u,u,p,p,l);var d=65535<a.count?Uint32Array:Uint16Array,f=new Ze.BufferAttribute(new d(r),1);return y(f,m.ELEMENT_ARRAY_BUFFER),e.wireframe=f},this.update=function(t){var e=c.get(t);t.geometry instanceof Ze.Geometry&&e.updateFromObject(t);var i=e.index,r=e.attributes;for(var n in null!==i&&y(i,m.ELEMENT_ARRAY_BUFFER),r)y(r[n],m.ARRAY_BUFFER);var o=e.morphAttributes;for(var n in o)for(var a=o[n],s=0,h=a.length;s<h;s++)y(a[s],m.ARRAY_BUFFER);return e}},Ze.WebGLProgram=function(){var A=0;function L(t){return""!==t}return function(t,e,i,r){var n=t.context,o=i.defines,a=i.__webglShader.vertexShader,s=i.__webglShader.fragmentShader,h="SHADOWMAP_TYPE_BASIC";r.shadowMapType===Ze.PCFShadowMap?h="SHADOWMAP_TYPE_PCF":r.shadowMapType===Ze.PCFSoftShadowMap&&(h="SHADOWMAP_TYPE_PCF_SOFT");var c="ENVMAP_TYPE_CUBE",l="ENVMAP_MODE_REFLECTION",u="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(i.envMap.mapping){case Ze.CubeReflectionMapping:case Ze.CubeRefractionMapping:c="ENVMAP_TYPE_CUBE";break;case Ze.EquirectangularReflectionMapping:case Ze.EquirectangularRefractionMapping:c="ENVMAP_TYPE_EQUIREC";break;case Ze.SphericalReflectionMapping:c="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case Ze.CubeRefractionMapping:case Ze.EquirectangularRefractionMapping:l="ENVMAP_MODE_REFRACTION"}switch(i.combine){case Ze.MultiplyOperation:u="ENVMAP_BLENDING_MULTIPLY";break;case Ze.MixOperation:u="ENVMAP_BLENDING_MIX";break;case Ze.AddOperation:u="ENVMAP_BLENDING_ADD"}}var p,d,f=0<t.gammaFactor?t.gammaFactor:1,m=function(t){var e=[];for(var i in t){var r=t[i];!1!==r&&e.push("#define "+i+" "+r)}return e.join("\\n")}(o),g=n.createProgram();d=i instanceof Ze.RawShaderMaterial?p="":(p=["precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,m,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.gammaInput?"#define GAMMA_INPUT":"",t.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+f,"#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,"#define MAX_BONES "+r.maxBones,r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+l:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\\tattribute vec3 morphTarget0;","\\tattribute vec3 morphTarget1;","\\tattribute vec3 morphTarget2;","\\tattribute vec3 morphTarget3;","\\t#ifdef USE_MORPHNORMALS","\\t\\tattribute vec3 morphNormal0;","\\t\\tattribute vec3 morphNormal1;","\\t\\tattribute vec3 morphNormal2;","\\t\\tattribute vec3 morphNormal3;","\\t#else","\\t\\tattribute vec3 morphTarget4;","\\t\\tattribute vec3 morphTarget5;","\\t\\tattribute vec3 morphTarget6;","\\t\\tattribute vec3 morphTarget7;","\\t#endif","#endif","#ifdef USE_SKINNING","\\tattribute vec4 skinIndex;","\\tattribute vec4 skinWeight;","#endif","\\n"].filter(L).join("\\n"),[r.bumpMap||r.normalMap||r.flatShading||i.derivatives?"#extension GL_OES_standard_derivatives : enable":"",r.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"","precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,m,"#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"",t.gammaInput?"#define GAMMA_INPUT":"",t.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+f,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+l:"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.metal?"#define METAL":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\\n"].filter(L).join("\\n"));var y=p+a,v=d+s,x=Ze.WebGLShader(n,n.VERTEX_SHADER,y),b=Ze.WebGLShader(n,n.FRAGMENT_SHADER,v);n.attachShader(g,x),n.attachShader(g,b),void 0!==i.index0AttributeName?n.bindAttribLocation(g,0,i.index0AttributeName):!0===r.morphTargets&&n.bindAttribLocation(g,0,"position"),n.linkProgram(g);var w,M,_=n.getProgramInfoLog(g),S=n.getShaderInfoLog(x),T=n.getShaderInfoLog(b),C=!0,E=!0;return!1===n.getProgramParameter(g,n.LINK_STATUS)?(C=!1,console.error("THREE.WebGLProgram: shader error: ",n.getError(),"gl.VALIDATE_STATUS",n.getProgramParameter(g,n.VALIDATE_STATUS),"gl.getProgramInfoLog",_,S,T)):""!==_?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",_):""!==S&&""!==T||(E=!1),E&&(this.diagnostics={runnable:C,material:i,programLog:_,vertexShader:{log:S,prefix:p},fragmentShader:{log:T,prefix:d}}),n.deleteShader(x),n.deleteShader(b),this.getUniforms=function(){return void 0===w&&(w=function(t,e,i){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<n;o++){var a=t.getActiveUniform(e,o).name,s=t.getUniformLocation(e,a),h=a.lastIndexOf("[0]");-1!==h&&h===a.length-3&&(r[a.substr(0,h)]=s),r[a]=s}return r}(n,g)),w},this.getAttributes=function(){return void 0===M&&(M=function(t,e,i){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var a=t.getActiveAttrib(e,o).name;r[a]=t.getAttribLocation(e,a)}return r}(n,g)),M},this.destroy=function(){n.deleteProgram(g),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=A++,this.code=e,this.usedTimes=1,this.program=g,this.vertexShader=x,this.fragmentShader=b,this}}(),Ze.WebGLPrograms=function(c,l){var s=[],u={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","envMap","envMapMode","lightMap","aoMap","emissiveMap","bumpMap","normalMap","specularMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","maxShadows","shadowMapEnabled","shadowMapType","shadowMapDebug","alphaTest","metal","doubleSided","flipSided"];this.getParameters=function(t,e,i,r){var n=u[t.type],o=function(t){for(var e=0,i=0,r=0,n=0,o=0,a=t.length;o<a;o++){var s=t[o];s.onlyShadow||!1===s.visible||(s instanceof Ze.DirectionalLight&&e++,s instanceof Ze.PointLight&&i++,s instanceof Ze.SpotLight&&r++,s instanceof Ze.HemisphereLight&&n++)}return{directional:e,point:i,spot:r,hemi:n}}(e),a=function(t){for(var e=0,i=0,r=t.length;i<r;i++){var n=t[i];n.castShadow&&(n instanceof Ze.SpotLight&&e++,n instanceof Ze.DirectionalLight&&e++)}return e}(e),s=function(t){if(l.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var e=l.maxVertexUniforms,i=Math.floor((e-20)/4);return void 0!==t&&t instanceof Ze.SkinnedMesh&&(i=Math.min(t.skeleton.bones.length,i))<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)"),i}(r),h=c.getPrecision();return null!==t.precision&&(h=l.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLRenderer.initMaterial:",t.precision,"not supported, using",h,"instead."),{shaderID:n,precision:h,supportsVertexTextures:l.vertexTextures,map:!!t.map,envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,combine:t.combine,vertexColors:t.vertexColors,fog:i,useFog:t.fog,fogExp:i instanceof Ze.FogExp2,flatShading:t.shading===Ze.FlatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:l.logarithmicDepthBuffer,skinning:t.skinning,maxBones:s,useVertexTexture:l.floatVertexTextures&&r&&r.skeleton&&r.skeleton.useVertexTexture,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:c.maxMorphTargets,maxMorphNormals:c.maxMorphNormals,maxDirLights:o.directional,maxPointLights:o.point,maxSpotLights:o.spot,maxHemiLights:o.hemi,maxShadows:a,shadowMapEnabled:c.shadowMap.enabled&&r.receiveShadow&&0<a,shadowMapType:c.shadowMap.type,shadowMapDebug:c.shadowMap.debug,alphaTest:t.alphaTest,metal:t.metal,doubleSided:t.side===Ze.DoubleSide,flipSided:t.side===Ze.BackSide}},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)i.push(r),i.push(t.defines[r]);for(var n=0;n<a.length;n++){var o=a[n];i.push(o),i.push(e[o])}return i.join()},this.acquireProgram=function(t,e,i){for(var r,n=0,o=s.length;n<o;n++){var a=s[n];if(a.code===i){++(r=a).usedTimes;break}}return void 0===r&&(r=new Ze.WebGLProgram(c,i,t,e),s.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=s.indexOf(t);s[e]=s[s.length-1],s.pop(),t.destroy()}},this.programs=s},Ze.WebGLProperties=function(){var r={};this.get=function(t){var e=t.uuid,i=r[e];return void 0===i&&(i={},r[e]=i),i},this.delete=function(t){delete r[t.uuid]},this.clear=function(){r={}}},Ze.WebGLShader=function(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn\'t compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){for(var e=t.split("\\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\\n")}(i)),r},Ze.WebGLShadowMap=function(_,S,T){var C=_.context,E=_.state,A=new Ze.Frustum,L=new Ze.Matrix4,P=(new Ze.Vector3,new Ze.Vector3,new Ze.Vector3),k=[],t=Ze.ShaderLib.depthRGBA,e=Ze.UniformsUtils.clone(t.uniforms),a=new Ze.ShaderMaterial({uniforms:e,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),s=new Ze.ShaderMaterial({uniforms:e,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,morphTargets:!0}),h=new Ze.ShaderMaterial({uniforms:e,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,skinning:!0}),c=new Ze.ShaderMaterial({uniforms:e,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,morphTargets:!0,skinning:!0});a._shadowPass=!0,s._shadowPass=!0,h._shadowPass=!0,c._shadowPass=!0;var R=this;function D(t,e){var i,r=t.geometry,n=void 0!==r.morphTargets&&0<r.morphTargets.length&&e.morphTargets,o=t instanceof Ze.SkinnedMesh&&e.skinning;return(i=t.customDepthMaterial?t.customDepthMaterial:o?n?c:h:n?s:a).visible=e.visible,i.wireframe=e.wireframe,i.wireframeLinewidth=e.wireframeLinewidth,i}function F(t,e){if(!1!==t.visible){if(t instanceof Ze.Mesh||t instanceof Ze.Line||t instanceof Ze.Points)if(t.castShadow&&(!1===t.frustumCulled||!0===A.intersectsObject(t)))!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),k.push(t));for(var i=t.children,r=0,n=i.length;r<n;r++)F(i[r],e)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ze.PCFShadowMap,this.cullFace=Ze.CullFaceFront,this.render=function(t,e){if(!1!==R.enabled&&(!1!==R.autoUpdate||!1!==R.needsUpdate)){C.clearColor(1,1,1,1),E.disable(C.BLEND),E.enable(C.CULL_FACE),C.frontFace(C.CCW),R.cullFace===Ze.CullFaceFront?C.cullFace(C.FRONT):C.cullFace(C.BACK),E.setDepthTest(!0);for(var i=0,r=S.length;i<r;i++){var n=S[i];if(n.castShadow){if(!n.shadowMap){var o=Ze.LinearFilter;R.type===Ze.PCFSoftShadowMap&&(o=Ze.NearestFilter);var a={minFilter:o,magFilter:o,format:Ze.RGBAFormat};n.shadowMap=new Ze.WebGLRenderTarget(n.shadowMapWidth,n.shadowMapHeight,a),n.shadowMapSize=new Ze.Vector2(n.shadowMapWidth,n.shadowMapHeight),n.shadowMatrix=new Ze.Matrix4}if(!n.shadowCamera){if(n instanceof Ze.SpotLight)n.shadowCamera=new Ze.PerspectiveCamera(n.shadowCameraFov,n.shadowMapWidth/n.shadowMapHeight,n.shadowCameraNear,n.shadowCameraFar);else{if(!(n instanceof Ze.DirectionalLight)){console.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",n);continue}n.shadowCamera=new Ze.OrthographicCamera(n.shadowCameraLeft,n.shadowCameraRight,n.shadowCameraTop,n.shadowCameraBottom,n.shadowCameraNear,n.shadowCameraFar)}t.add(n.shadowCamera),!0===t.autoUpdate&&t.updateMatrixWorld()}n.shadowCameraVisible&&!n.cameraHelper&&(n.cameraHelper=new Ze.CameraHelper(n.shadowCamera),t.add(n.cameraHelper));var s=n.shadowMap,h=n.shadowMatrix,c=n.shadowCamera;c.position.setFromMatrixPosition(n.matrixWorld),P.setFromMatrixPosition(n.target.matrixWorld),c.lookAt(P),c.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld),n.cameraHelper&&(n.cameraHelper.visible=n.shadowCameraVisible),n.shadowCameraVisible&&n.cameraHelper.update(),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(c.projectionMatrix),h.multiply(c.matrixWorldInverse),L.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),A.setFromMatrix(L),_.setRenderTarget(s),_.clear(),k.length=0,F(t,c);for(var l=0,u=k.length;l<u;l++){var p=k[l],d=T.update(p),f=p.material;if(f instanceof Ze.MeshFaceMaterial)for(var m=d.groups,g=f.materials,y=0,v=m.length;y<v;y++){var x=m[y],b=g[x.materialIndex];!0===b.visible&&_.renderBufferDirect(c,S,null,d,D(p,b),p,x)}else _.renderBufferDirect(c,S,null,d,D(p,f),p)}}}var w=_.getClearColor(),M=_.getClearAlpha();_.setClearColor(w,M),E.enable(C.BLEND),R.cullFace===Ze.CullFaceFront&&C.cullFace(C.BACK),_.resetGLState(),R.needsUpdate=!1}}},Ze.WebGLState=function(s,i,h){var r=this,n=new Uint8Array(16),o=new Uint8Array(16),e={},a=null,c=null,l=null,u=null,p=null,d=null,f=null,m=null,g=null,y=null,v=null,x=null,b=null,w=null,M=null,_=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),S=void 0,T={};this.init=function(){s.clearColor(0,0,0,1),s.clearDepth(1),s.clearStencil(0),this.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL),s.frontFace(s.CCW),s.cullFace(s.BACK),this.enable(s.CULL_FACE),this.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=n.length;t<e;t++)n[t]=0},this.enableAttribute=function(t){n[t]=1,0===o[t]&&(s.enableVertexAttribArray(t),o[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,e=o.length;t<e;t++)o[t]!==n[t]&&(s.disableVertexAttribArray(t),o[t]=0)},this.enable=function(t){!0!==e[t]&&(s.enable(t),e[t]=!0)},this.disable=function(t){!1!==e[t]&&(s.disable(t),e[t]=!1)},this.getCompressedTextureFormats=function(){if(null===a&&(a=[],i.get("WEBGL_compressed_texture_pvrtc")||i.get("WEBGL_compressed_texture_s3tc")))for(var t=s.getParameter(s.COMPRESSED_TEXTURE_FORMATS),e=0;e<t.length;e++)a.push(t[e]);return a},this.setBlending=function(t,e,i,r,n,o,a){t!==c&&(t===Ze.NoBlending?this.disable(s.BLEND):t===Ze.AdditiveBlending?(this.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.SRC_ALPHA,s.ONE)):t===Ze.SubtractiveBlending?(this.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ZERO,s.ONE_MINUS_SRC_COLOR)):t===Ze.MultiplyBlending?(this.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ZERO,s.SRC_COLOR)):t===Ze.CustomBlending?this.enable(s.BLEND):(this.enable(s.BLEND),s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA)),c=t),t===Ze.CustomBlending?(n=n||e,o=o||i,a=a||r,e===l&&n===d||(s.blendEquationSeparate(h(e),h(n)),l=e,d=n),i===u&&r===p&&o===f&&a===m||(s.blendFuncSeparate(h(i),h(r),h(o),h(a)),u=i,p=r,f=o,m=a)):m=f=d=p=u=l=null},this.setDepthFunc=function(t){if(g!==t){if(t)switch(t){case Ze.NeverDepth:s.depthFunc(s.NEVER);break;case Ze.AlwaysDepth:s.depthFunc(s.ALWAYS);break;case Ze.LessDepth:s.depthFunc(s.LESS);break;case Ze.LessEqualDepth:s.depthFunc(s.LEQUAL);break;case Ze.EqualDepth:s.depthFunc(s.EQUAL);break;case Ze.GreaterEqualDepth:s.depthFunc(s.GEQUAL);break;case Ze.GreaterDepth:s.depthFunc(s.GREATER);break;case Ze.NotEqualDepth:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}else s.depthFunc(s.LEQUAL);g=t}},this.setDepthTest=function(t){t?this.enable(s.DEPTH_TEST):this.disable(s.DEPTH_TEST)},this.setDepthWrite=function(t){y!==t&&(s.depthMask(t),y=t)},this.setColorWrite=function(t){v!==t&&(s.colorMask(t,t,t,t),v=t)},this.setFlipSided=function(t){x!==t&&(t?s.frontFace(s.CW):s.frontFace(s.CCW),x=t)},this.setLineWidth=function(t){t!==b&&(s.lineWidth(t),b=t)},this.setPolygonOffset=function(t,e,i){t?this.enable(s.POLYGON_OFFSET_FILL):this.disable(s.POLYGON_OFFSET_FILL),!t||w===e&&M===i||(s.polygonOffset(e,i),w=e,M=i)},this.setScissorTest=function(t){t?this.enable(s.SCISSOR_TEST):this.disable(s.SCISSOR_TEST)},this.activeTexture=function(t){void 0===t&&(t=s.TEXTURE0+_-1),S!==t&&(s.activeTexture(t),S=t)},this.bindTexture=function(t,e){void 0===S&&r.activeTexture();var i=T[S];void 0===i&&(i={type:void 0,texture:void 0},T[S]=i),i.type===t&&i.texture===e||(s.bindTexture(t,e),i.type=t,i.texture=e)},this.compressedTexImage2D=function(){try{s.compressedTexImage2D.apply(s,arguments)}catch(t){console.error(t)}},this.texImage2D=function(){try{s.texImage2D.apply(s,arguments)}catch(t){console.error(t)}},this.reset=function(){for(var t=0;t<o.length;t++)1===o[t]&&(s.disableVertexAttribArray(t),o[t]=0);e={},x=v=y=c=a=null}},Ze.LensFlarePlugin=function(v,x){var b,w,M,_,S,T,C,E,A=v.context,L=v.state,P=function(){var t,e,i,r,n,o,a=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),s=new Uint16Array([0,1,2,0,2,3]);b=A.createBuffer(),w=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,b),A.bufferData(A.ARRAY_BUFFER,a,A.STATIC_DRAW),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,w),A.bufferData(A.ELEMENT_ARRAY_BUFFER,s,A.STATIC_DRAW),C=A.createTexture(),E=A.createTexture(),L.bindTexture(A.TEXTURE_2D,C),A.texImage2D(A.TEXTURE_2D,0,A.RGB,16,16,0,A.RGB,A.UNSIGNED_BYTE,null),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.NEAREST),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.NEAREST),L.bindTexture(A.TEXTURE_2D,E),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,16,16,0,A.RGBA,A.UNSIGNED_BYTE,null),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.NEAREST),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.NEAREST),t=(T=0<A.getParameter(A.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\\n")},e=t,i=A.createProgram(),r=A.createShader(A.FRAGMENT_SHADER),n=A.createShader(A.VERTEX_SHADER),o="precision "+v.getPrecision()+" float;\\n",A.shaderSource(r,o+e.fragmentShader),A.shaderSource(n,o+e.vertexShader),A.compileShader(r),A.compileShader(n),A.attachShader(i,r),A.attachShader(i,n),A.linkProgram(i),M=i,_={vertex:A.getAttribLocation(M,"position"),uv:A.getAttribLocation(M,"uv")},S={renderType:A.getUniformLocation(M,"renderType"),map:A.getUniformLocation(M,"map"),occlusionMap:A.getUniformLocation(M,"occlusionMap"),opacity:A.getUniformLocation(M,"opacity"),color:A.getUniformLocation(M,"color"),scale:A.getUniformLocation(M,"scale"),rotation:A.getUniformLocation(M,"rotation"),screenPosition:A.getUniformLocation(M,"screenPosition")}};this.render=function(t,e,i,r){if(0!==x.length){var n=new Ze.Vector3,o=r/i,a=.5*i,s=.5*r,h=16/r,c=new Ze.Vector2(h*o,h),l=new Ze.Vector3(1,1,0),u=new Ze.Vector2(1,1);void 0===M&&P(),A.useProgram(M),L.initAttributes(),L.enableAttribute(_.vertex),L.enableAttribute(_.uv),L.disableUnusedAttributes(),A.uniform1i(S.occlusionMap,0),A.uniform1i(S.map,1),A.bindBuffer(A.ARRAY_BUFFER,b),A.vertexAttribPointer(_.vertex,2,A.FLOAT,!1,16,0),A.vertexAttribPointer(_.uv,2,A.FLOAT,!1,16,8),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,w),L.disable(A.CULL_FACE),A.depthMask(!1);for(var p=0,d=x.length;p<d;p++){h=16/r,c.set(h*o,h);var f=x[p];if(n.set(f.matrixWorld.elements[12],f.matrixWorld.elements[13],f.matrixWorld.elements[14]),n.applyMatrix4(e.matrixWorldInverse),n.applyProjection(e.projectionMatrix),l.copy(n),u.x=l.x*a+a,u.y=l.y*s+s,T||0<u.x&&u.x<i&&0<u.y&&u.y<r){L.activeTexture(A.TEXTURE0),L.bindTexture(A.TEXTURE_2D,null),L.activeTexture(A.TEXTURE1),L.bindTexture(A.TEXTURE_2D,C),A.copyTexImage2D(A.TEXTURE_2D,0,A.RGB,u.x-8,u.y-8,16,16,0),A.uniform1i(S.renderType,0),A.uniform2f(S.scale,c.x,c.y),A.uniform3f(S.screenPosition,l.x,l.y,l.z),L.disable(A.BLEND),L.enable(A.DEPTH_TEST),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0),L.activeTexture(A.TEXTURE0),L.bindTexture(A.TEXTURE_2D,E),A.copyTexImage2D(A.TEXTURE_2D,0,A.RGBA,u.x-8,u.y-8,16,16,0),A.uniform1i(S.renderType,1),L.disable(A.DEPTH_TEST),L.activeTexture(A.TEXTURE1),L.bindTexture(A.TEXTURE_2D,C),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0),f.positionScreen.copy(l),f.customUpdateCallback?f.customUpdateCallback(f):f.updateLensFlares(),A.uniform1i(S.renderType,2),L.enable(A.BLEND);for(var m=0,g=f.lensFlares.length;m<g;m++){var y=f.lensFlares[m];.001<y.opacity&&.001<y.scale&&(l.x=y.x,l.y=y.y,l.z=y.z,h=y.size*y.scale/r,c.x=h*o,c.y=h,A.uniform3f(S.screenPosition,l.x,l.y,l.z),A.uniform2f(S.scale,c.x,c.y),A.uniform1f(S.rotation,y.rotation),A.uniform1f(S.opacity,y.opacity),A.uniform3f(S.color,y.color.r,y.color.g,y.color.b),L.setBlending(y.blending,y.blendEquation,y.blendSrc,y.blendDst),v.setTexture(y.texture,1),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0))}}}L.enable(A.CULL_FACE),L.enable(A.DEPTH_TEST),A.depthMask(!0),v.resetGLState()}}},Ze.SpritePlugin=function(u,p){var d,f,m,g,y,v,x=u.context,b=u.state,w=new Ze.Vector3,M=new Ze.Quaternion,_=new Ze.Vector3,S=function(){var t,e,i,r=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);d=x.createBuffer(),f=x.createBuffer(),x.bindBuffer(x.ARRAY_BUFFER,d),x.bufferData(x.ARRAY_BUFFER,r,x.STATIC_DRAW),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,f),x.bufferData(x.ELEMENT_ARRAY_BUFFER,n,x.STATIC_DRAW),t=x.createProgram(),e=x.createShader(x.VERTEX_SHADER),i=x.createShader(x.FRAGMENT_SHADER),x.shaderSource(e,["precision "+u.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\\n")),x.shaderSource(i,["precision "+u.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\\n")),x.compileShader(e),x.compileShader(i),x.attachShader(t,e),x.attachShader(t,i),x.linkProgram(t),m=t,g={position:x.getAttribLocation(m,"position"),uv:x.getAttribLocation(m,"uv")},y={uvOffset:x.getUniformLocation(m,"uvOffset"),uvScale:x.getUniformLocation(m,"uvScale"),rotation:x.getUniformLocation(m,"rotation"),scale:x.getUniformLocation(m,"scale"),color:x.getUniformLocation(m,"color"),map:x.getUniformLocation(m,"map"),opacity:x.getUniformLocation(m,"opacity"),modelViewMatrix:x.getUniformLocation(m,"modelViewMatrix"),projectionMatrix:x.getUniformLocation(m,"projectionMatrix"),fogType:x.getUniformLocation(m,"fogType"),fogDensity:x.getUniformLocation(m,"fogDensity"),fogNear:x.getUniformLocation(m,"fogNear"),fogFar:x.getUniformLocation(m,"fogFar"),fogColor:x.getUniformLocation(m,"fogColor"),alphaTest:x.getUniformLocation(m,"alphaTest")};var o=document.createElement("canvas");o.width=8,o.height=8;var a=o.getContext("2d");a.fillStyle="white",a.fillRect(0,0,8,8),(v=new Ze.Texture(o)).needsUpdate=!0};function T(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(t,e){if(0!==p.length){void 0===m&&S(),x.useProgram(m),b.initAttributes(),b.enableAttribute(g.position),b.enableAttribute(g.uv),b.disableUnusedAttributes(),b.disable(x.CULL_FACE),b.enable(x.BLEND),x.bindBuffer(x.ARRAY_BUFFER,d),x.vertexAttribPointer(g.position,2,x.FLOAT,!1,16,0),x.vertexAttribPointer(g.uv,2,x.FLOAT,!1,16,8),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,f),x.uniformMatrix4fv(y.projectionMatrix,!1,e.projectionMatrix.elements),b.activeTexture(x.TEXTURE0),x.uniform1i(y.map,0);var i=0,r=0,n=t.fog;n?(x.uniform3f(y.fogColor,n.color.r,n.color.g,n.color.b),n instanceof Ze.Fog?(x.uniform1f(y.fogNear,n.near),x.uniform1f(y.fogFar,n.far),x.uniform1i(y.fogType,1),r=i=1):n instanceof Ze.FogExp2&&(x.uniform1f(y.fogDensity,n.density),x.uniform1i(y.fogType,2),r=i=2)):(x.uniform1i(y.fogType,0),r=i=0);for(var o=0,a=p.length;o<a;o++){(h=p[o]).modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.z=-h.modelViewMatrix.elements[14]}p.sort(T);var s=[];for(o=0,a=p.length;o<a;o++){var h,c=(h=p[o]).material;x.uniform1f(y.alphaTest,c.alphaTest),x.uniformMatrix4fv(y.modelViewMatrix,!1,h.modelViewMatrix.elements),h.matrixWorld.decompose(w,M,_),s[0]=_.x,s[1]=_.y;var l=0;t.fog&&c.fog&&(l=r),i!==l&&(x.uniform1i(y.fogType,l),i=l),null!==c.map?(x.uniform2f(y.uvOffset,c.map.offset.x,c.map.offset.y),x.uniform2f(y.uvScale,c.map.repeat.x,c.map.repeat.y)):(x.uniform2f(y.uvOffset,0,0),x.uniform2f(y.uvScale,1,1)),x.uniform1f(y.opacity,c.opacity),x.uniform3f(y.color,c.color.r,c.color.g,c.color.b),x.uniform1f(y.rotation,c.rotation),x.uniform2fv(y.scale,s),b.setBlending(c.blending,c.blendEquation,c.blendSrc,c.blendDst),b.setDepthTest(c.depthTest),b.setDepthWrite(c.depthWrite),c.map&&c.map.image&&c.map.image.width?u.setTexture(c.map,0):u.setTexture(v,0),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0)}b.enable(x.CULL_FACE),u.resetGLState()}}},Ze.GeometryUtils={merge:function(t,e,i){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e instanceof Ze.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},Ze.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,r){var n=new Ze.ImageLoader;n.crossOrigin=this.crossOrigin;var o=new Ze.Texture(void 0,e);return n.load(t,function(t){o.image=t,o.needsUpdate=!0,i&&i(o)},void 0,function(t){r&&r(t)}),o.sourceFile=t,o},loadTextureCube:function(t,e,i,r){var n=new Ze.ImageLoader;n.crossOrigin=this.crossOrigin;for(var o=new Ze.CubeTexture([],e),a=0,s=function(e){n.load(t[e],function(t){o.images[e]=t,6===(a+=1)&&(o.needsUpdate=!0,i&&i(o))},void 0,r)},h=0,c=t.length;h<c;++h)s(h);return o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(t,e){var i=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]};e|=1;var r=t.width,n=t.height,o=document.createElement("canvas");o.width=r,o.height=n;var a=o.getContext("2d");a.drawImage(t,0,0);for(var s,h,c,l,u=a.getImageData(0,0,r,n).data,p=a.createImageData(r,n),d=p.data,f=0;f<r;f++)for(var m=0;m<n;m++){var g=m-1<0?0:m-1,y=n-1<m+1?n-1:m+1,v=f-1<0?0:f-1,x=r-1<f+1?r-1:f+1,b=[],w=[0,0,u[4*(m*r+f)]/255*e];b.push([-1,0,u[4*(m*r+v)]/255*e]),b.push([-1,-1,u[4*(g*r+v)]/255*e]),b.push([0,-1,u[4*(g*r+f)]/255*e]),b.push([1,-1,u[4*(g*r+x)]/255*e]),b.push([1,0,u[4*(m*r+x)]/255*e]),b.push([1,1,u[4*(y*r+x)]/255*e]),b.push([0,1,u[4*(y*r+f)]/255*e]),b.push([-1,1,u[4*(y*r+v)]/255*e]);for(var M=[],_=b.length,S=0;S<_;S++){var T=b[S],C=b[(S+1)%_];T=i(T,w),C=i(C,w),M.push((l=C,s=[(c=T)[1]*l[2]-c[2]*l[1],c[2]*l[0]-c[0]*l[2],c[0]*l[1]-c[1]*l[0]],void 0,h=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),[s[0]/h,s[1]/h,s[2]/h]))}var E=[0,0,0];for(S=0;S<M.length;S++)E[0]+=M[S][0],E[1]+=M[S][1],E[2]+=M[S][2];E[0]/=M.length,E[1]/=M.length,E[2]/=M.length;var A=4*(m*r+f);d[A]=(E[0]+1)/2*255|0,d[A+1]=(E[1]+1)/2*255|0,d[A+2]=255*E[2]|0,d[A+3]=255}return a.putImageData(p,0,0),o},generateDataTexture:function(t,e,i){for(var r=t*e,n=new Uint8Array(3*r),o=Math.floor(255*i.r),a=Math.floor(255*i.g),s=Math.floor(255*i.b),h=0;h<r;h++)n[3*h]=o,n[3*h+1]=a,n[3*h+2]=s;var c=new Ze.DataTexture(n,t,e,Ze.RGBFormat);return c.needsUpdate=!0,c}},Ze.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new Ze.Group,r=0,n=e.length;r<n;r++)i.add(new Ze.Mesh(t,e[r]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var r=new Ze.Matrix4;r.getInverse(i.matrixWorld),t.applyMatrix(r),e.remove(t),i.add(t)}},Ze.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face.toLowerCase()][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(t){var e=t.familyName.toLowerCase();return this.faces[e]=this.faces[e]||{},this.faces[e][t.cssFontWeight]=this.faces[e][t.cssFontWeight]||{},this.faces[e][t.cssFontWeight][t.cssFontStyle]=t,this.faces[e][t.cssFontWeight][t.cssFontStyle]=t},drawText:function(t){var e,i=this.getFace(),r=this.size/i.resolution,n=0,o=String(t).split(""),a=o.length,s=[];for(e=0;e<a;e++){var h=new Ze.Path,c=this.extractGlyphPoints(o[e],i,r,n,h);n+=c.offset,s.push(c.path)}return{paths:s,offset:n/2}},extractGlyphPoints:function(t,e,i,r,n){var o,a,s,h,c,l,u,p,d,f,m,g,y,v,x,b,w,M,_=[],S=e.glyphs[t]||e.glyphs["?"];if(S){if(S.o)for(c=(h=S._cachedOutline||(S._cachedOutline=S.o.split(" "))).length,u=l=i,o=0;o<c;)switch(h[o++]){case"m":p=h[o++]*l+r,d=h[o++]*u,n.moveTo(p,d);break;case"l":p=h[o++]*l+r,d=h[o++]*u,n.lineTo(p,d);break;case"q":if(f=h[o++]*l+r,m=h[o++]*u,v=h[o++]*l+r,x=h[o++]*u,n.quadraticCurveTo(v,x,f,m),M=_[_.length-1])for(g=M.x,y=M.y,a=1,s=this.divisions;a<=s;a++){var T=a/s;Ze.Shape.Utils.b2(T,g,v,f),Ze.Shape.Utils.b2(T,y,x,m)}break;case"b":if(f=h[o++]*l+r,m=h[o++]*u,v=h[o++]*l+r,x=h[o++]*u,b=h[o++]*l+r,w=h[o++]*u,n.bezierCurveTo(v,x,b,w,f,m),M=_[_.length-1])for(g=M.x,y=M.y,a=1,s=this.divisions;a<=s;a++){T=a/s;Ze.Shape.Utils.b3(T,g,v,b,f),Ze.Shape.Utils.b3(T,y,x,w,m)}}return{offset:S.ha*i,path:n}}}},Ze.FontUtils.generateShapes=function(t,e){var i=void 0!==(e=e||{}).size?e.size:100,r=void 0!==e.curveSegments?e.curveSegments:4,n=void 0!==e.font?e.font:"helvetiker",o=void 0!==e.weight?e.weight:"normal",a=void 0!==e.style?e.style:"normal";Ze.FontUtils.size=i,Ze.FontUtils.divisions=r,Ze.FontUtils.face=n,Ze.FontUtils.weight=o,Ze.FontUtils.style=a;for(var s=Ze.FontUtils.drawText(t).paths,h=[],c=0,l=s.length;c<l;c++)Array.prototype.push.apply(h,s[c].toShapes());return h},ge=Ze.FontUtils,ye=function(t){for(var e=t.length,i=0,r=e-1,n=0;n<e;r=n++)i+=t[r].x*t[n].y-t[n].x*t[r].y;return.5*i},ve=function(t,e,i,r,n,o){var a,s,h,c,l,u,p,d,f,m,g,y,v,x,b;if(s=t[o[e]].x,h=t[o[e]].y,c=t[o[i]].x,l=t[o[i]].y,u=t[o[r]].x,(c-s)*((p=t[o[r]].y)-h)-(l-h)*(u-s)<1e-10)return!1;for(m=u-c,g=p-l,y=s-u,v=h-p,x=c-s,b=l-h,a=0;a<n;a++)if(d=t[o[a]].x,f=t[o[a]].y,!(d===s&&f===h||d===c&&f===l||d===u&&f===p)&&-1e-10<=m*(f-l)-g*(d-c)&&-1e-10<=y*(f-p)-v*(d-u)&&-1e-10<=x*(f-h)-b*(d-s))return!1;return!0},ge.Triangulate=function(t,e){var i=t.length;if(i<3)return null;var r,n,o,a=[],s=[],h=[];if(0<ye(t))for(n=0;n<i;n++)s[n]=n;else for(n=0;n<i;n++)s[n]=i-1-n;var c=i,l=2*c;for(n=c-1;2<c;){if(l--<=0)return console.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),e?h:a;if(c<=(r=n)&&(r=0),c<=(n=r+1)&&(n=0),c<=(o=n+1)&&(o=0),ve(t,r,n,o,c,s)){var u,p,d,f,m;for(u=s[r],p=s[n],d=s[o],a.push([t[u],t[p],t[d]]),h.push([s[r],s[n],s[o]]),m=(f=n)+1;m<c;f++,m++)s[f]=s[m];l=2*--c}}return e?h:a},ge.Triangulate.area=ye,Ze.typeface_js={faces:Ze.FontUtils.faces,loadFace:Ze.FontUtils.loadFace},void 0!==Qe&&(Qe._typeface_js=Ze.typeface_js),Ze.Audio=function(t){Ze.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1},Ze.Audio.prototype=Object.create(Ze.Object3D.prototype),Ze.Audio.prototype.constructor=Ze.Audio,Ze.Audio.prototype.load=function(t){var e=this,i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(t){e.context.decodeAudioData(this.response,function(t){e.source.buffer=t,e.autoplay&&e.play()})},i.send(),this},Ze.Audio.prototype.play=function(){if(!0!==this.isPlaying){var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}else console.warn("THREE.Audio: Audio is already playing.")},Ze.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},Ze.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},Ze.Audio.prototype.connect=function(){void 0!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.panner)):this.source.connect(this.panner)},Ze.Audio.prototype.disconnect=function(){void 0!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.panner)):this.source.disconnect(this.panner)},Ze.Audio.prototype.setFilter=function(t){!0===this.isPlaying?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},Ze.Audio.prototype.getFilter=function(){return this.filter},Ze.Audio.prototype.setPlaybackRate=function(t){this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate)},Ze.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},Ze.Audio.prototype.onEnded=function(){this.isPlaying=!1},Ze.Audio.prototype.setLoop=function(t){this.source.loop=t},Ze.Audio.prototype.getLoop=function(){return this.source.loop},Ze.Audio.prototype.setRefDistance=function(t){this.panner.refDistance=t},Ze.Audio.prototype.getRefDistance=function(){return this.panner.refDistance},Ze.Audio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},Ze.Audio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},Ze.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},Ze.Audio.prototype.getVolume=function(){return this.gain.gain.value},Ze.Audio.prototype.updateMatrixWorld=(xe=new Ze.Vector3,function(t){Ze.Object3D.prototype.updateMatrixWorld.call(this,t),xe.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(xe.x,xe.y,xe.z)}),Ze.AudioListener=function(){Ze.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},Ze.AudioListener.prototype=Object.create(Ze.Object3D.prototype),Ze.AudioListener.prototype.constructor=Ze.AudioListener,Ze.AudioListener.prototype.updateMatrixWorld=(be=new Ze.Vector3,we=new Ze.Quaternion,Me=new Ze.Vector3,_e=new Ze.Vector3,function(t){Ze.Object3D.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,i=this.up;this.matrixWorld.decompose(be,we,Me),_e.set(0,0,-1).applyQuaternion(we),e.setPosition(be.x,be.y,be.z),e.setOrientation(_e.x,_e.y,_e.z,i.x,i.y,i.z)}),Ze.Curve=function(){},Ze.Curve.prototype.getPoint=function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},Ze.Curve.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},Ze.Curve.prototype.getPoints=function(t){t||(t=5);var e,i=[];for(e=0;e<=t;e++)i.push(this.getPoint(e/t));return i},Ze.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,i=[];for(e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i},Ze.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},Ze.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,r=[],n=this.getPoint(0),o=0;for(r.push(0),i=1;i<=t;i++)o+=(e=this.getPoint(i/t)).distanceTo(n),r.push(o),n=e;return this.cacheArcLengths=r},Ze.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},Ze.Curve.prototype.getUtoTmapping=function(t,e){var i,r=this.getLengths(),n=0,o=r.length;i=e||t*r[o-1];for(var a,s=0,h=o-1;s<=h;)if((a=r[n=Math.floor(s+(h-s)/2)]-i)<0)s=n+1;else{if(!(0<a)){h=n;break}h=n-1}if(r[n=h]===i)return n/(o-1);var c=r[n];return(n+(i-c)/(r[n+1]-c))/(o-1)},Ze.Curve.prototype.getTangent=function(t){var e=t-1e-4,i=t+1e-4;e<0&&(e=0),1<i&&(i=1);var r=this.getPoint(e);return this.getPoint(i).clone().sub(r).normalize()},Ze.Curve.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},Ze.Curve.Utils={tangentQuadraticBezier:function(t,e,i,r){return 2*(1-t)*(i-e)+2*t*(r-i)},tangentCubicBezier:function(t,e,i,r,n){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*r*(1-t)-3*t*t*r+3*t*t*n},tangentSpline:function(t,e,i,r,n){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,i,r,n){var o=.5*(i-t),a=.5*(r-e),s=n*n;return(2*e-2*i+o+a)*(n*s)+(-3*e+3*i-2*o-a)*s+o*n+e}},Ze.Curve.create=function(t,e){return t.prototype=Object.create(Ze.Curve.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Ze.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},Ze.CurvePath.prototype=Object.create(Ze.Curve.prototype),Ze.CurvePath.prototype.constructor=Ze.CurvePath,Ze.CurvePath.prototype.add=function(t){this.curves.push(t)},Ze.CurvePath.prototype.checkConnection=function(){},Ze.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ze.LineCurve(e,t))},Ze.CurvePath.prototype.getPoint=function(t){for(var e,i=t*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=i){var o=1-(r[n]-i)/(e=this.curves[n]).getLength();return e.getPointAt(o)}n++}return null},Ze.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},Ze.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var t,e=[],i=0,r=this.curves.length;for(t=0;t<r;t++)i+=this.curves[t].getLength(),e.push(i);return this.cacheLengths=e},Ze.CurvePath.prototype.getBoundingBox=function(){var t,e,i,r,n,o,a,s,h,c,l=this.getPoints();t=e=Number.NEGATIVE_INFINITY,r=n=Number.POSITIVE_INFINITY;var u=l[0]instanceof Ze.Vector3;for(c=u?new Ze.Vector3:new Ze.Vector2,s=0,h=l.length;s<h;s++)(a=l[s]).x>t?t=a.x:a.x<r&&(r=a.x),a.y>e?e=a.y:a.y<n&&(n=a.y),u&&(a.z>i?i=a.z:a.z<o&&(o=a.z)),c.add(a);var p={minX:r,minY:n,maxX:t,maxY:e};return u&&(p.maxZ=i,p.minZ=o),p},Ze.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t,!0);return this.createGeometry(e)},Ze.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t,!0);return this.createGeometry(e)},Ze.CurvePath.prototype.createGeometry=function(t){for(var e=new Ze.Geometry,i=0;i<t.length;i++)e.vertices.push(new Ze.Vector3(t[i].x,t[i].y,t[i].z||0));return e},Ze.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},Ze.CurvePath.prototype.getTransformedPoints=function(t,e){var i,r,n=this.getPoints(t);for(e||(e=this.bends),i=0,r=e.length;i<r;i++)n=this.getWrapPoints(n,e[i]);return n},Ze.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var i,r,n=this.getSpacedPoints(t);for(e||(e=this.bends),i=0,r=e.length;i<r;i++)n=this.getWrapPoints(n,e[i]);return n},Ze.CurvePath.prototype.getWrapPoints=function(t,e){var i,r,n,o,a,s,h=this.getBoundingBox();for(i=0,r=t.length;i<r;i++){o=(n=t[i]).x,a=n.y,s=o/h.maxX,s=e.getUtoTmapping(s,o);var c=e.getPoint(s),l=e.getTangent(s);l.set(-l.y,l.x).multiplyScalar(a),n.x=c.x+l.x,n.y=c.y+l.y}return t},Ze.Path=function(t){Ze.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},Ze.Path.prototype=Object.create(Ze.CurvePath.prototype),Ze.Path.prototype.constructor=Ze.Path,Ze.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},Ze.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},Ze.Path.prototype.moveTo=function(t,e){var i=Array.prototype.slice.call(arguments);this.actions.push({action:Ze.PathActions.MOVE_TO,args:i})},Ze.Path.prototype.lineTo=function(t,e){var i=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,n=r[r.length-2],o=r[r.length-1],a=new Ze.LineCurve(new Ze.Vector2(n,o),new Ze.Vector2(t,e));this.curves.push(a),this.actions.push({action:Ze.PathActions.LINE_TO,args:i})},Ze.Path.prototype.quadraticCurveTo=function(t,e,i,r){var n=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],h=new Ze.QuadraticBezierCurve(new Ze.Vector2(a,s),new Ze.Vector2(t,e),new Ze.Vector2(i,r));this.curves.push(h),this.actions.push({action:Ze.PathActions.QUADRATIC_CURVE_TO,args:n})},Ze.Path.prototype.bezierCurveTo=function(t,e,i,r,n,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,h=s[s.length-2],c=s[s.length-1],l=new Ze.CubicBezierCurve(new Ze.Vector2(h,c),new Ze.Vector2(t,e),new Ze.Vector2(i,r),new Ze.Vector2(n,o));this.curves.push(l),this.actions.push({action:Ze.PathActions.BEZIER_CURVE_TO,args:a})},Ze.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,r=i[i.length-2],n=i[i.length-1],o=[new Ze.Vector2(r,n)];Array.prototype.push.apply(o,t);var a=new Ze.SplineCurve(o);this.curves.push(a),this.actions.push({action:Ze.PathActions.CSPLINE_THRU,args:e})},Ze.Path.prototype.arc=function(t,e,i,r,n,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],h=a[a.length-1];this.absarc(t+s,e+h,i,r,n,o)},Ze.Path.prototype.absarc=function(t,e,i,r,n,o){this.absellipse(t,e,i,i,r,n,o)},Ze.Path.prototype.ellipse=function(t,e,i,r,n,o,a,s){var h=this.actions[this.actions.length-1].args,c=h[h.length-2],l=h[h.length-1];this.absellipse(t+c,e+l,i,r,n,o,a,s)},Ze.Path.prototype.absellipse=function(t,e,i,r,n,o,a,s){var h=[t,e,i,r,n,o,a,s||0],c=new Ze.EllipseCurve(t,e,i,r,n,o,a,s);this.curves.push(c);var l=c.getPoint(1);h.push(l.x),h.push(l.y),this.actions.push({action:Ze.PathActions.ELLIPSE,args:h})},Ze.Path.prototype.getSpacedPoints=function(t,e){t||(t=40);for(var i=[],r=0;r<t;r++)i.push(this.getPoint(r/t));return i},Ze.Path.prototype.getPoints=function(t,e){if(this.useSpacedPoints)return this.getSpacedPoints(t,e);t=t||12;var i,r,n,o,a,s,h,c,l,u,p,d,f,m,g,y,v,x,b=[];for(i=0,r=this.actions.length;i<r;i++)switch(o=(n=this.actions[i]).action,a=n.args,o){case Ze.PathActions.MOVE_TO:case Ze.PathActions.LINE_TO:b.push(new Ze.Vector2(a[0],a[1]));break;case Ze.PathActions.QUADRATIC_CURVE_TO:for(s=a[2],h=a[3],u=a[0],p=a[1],f=0<b.length?(d=(m=b[b.length-1]).x,m.y):(d=(m=this.actions[i-1].args)[m.length-2],m[m.length-1]),g=1;g<=t;g++)y=g/t,v=Ze.Shape.Utils.b2(y,d,u,s),x=Ze.Shape.Utils.b2(y,f,p,h),b.push(new Ze.Vector2(v,x));break;case Ze.PathActions.BEZIER_CURVE_TO:for(s=a[4],h=a[5],u=a[0],p=a[1],c=a[2],l=a[3],f=0<b.length?(d=(m=b[b.length-1]).x,m.y):(d=(m=this.actions[i-1].args)[m.length-2],m[m.length-1]),g=1;g<=t;g++)y=g/t,v=Ze.Shape.Utils.b3(y,d,u,c,s),x=Ze.Shape.Utils.b3(y,f,p,l,h),b.push(new Ze.Vector2(v,x));break;case Ze.PathActions.CSPLINE_THRU:m=this.actions[i-1].args;var w=[new Ze.Vector2(m[m.length-2],m[m.length-1])],M=t*a[0].length;w=w.concat(a[0]);var _=new Ze.SplineCurve(w);for(g=1;g<=M;g++)b.push(_.getPointAt(g/M));break;case Ze.PathActions.ARC:var S=a[0],T=a[1],C=a[2],E=a[3],A=a[4],L=!!a[5],P=A-E,k=2*t;for(g=1;g<=k;g++)y=g/k,L||(y=1-y),R=E+y*P,v=S+C*Math.cos(R),x=T+C*Math.sin(R),b.push(new Ze.Vector2(v,x));break;case Ze.PathActions.ELLIPSE:S=a[0],T=a[1];var R,D,F,O=a[2],B=a[3],U=(E=a[4],A=a[5],L=!!a[6],a[7]);P=A-E,k=2*t;for(0!==U&&(D=Math.cos(U),F=Math.sin(U)),g=1;g<=k;g++){if(y=g/k,L||(y=1-y),R=E+y*P,v=S+O*Math.cos(R),x=T+B*Math.sin(R),0!==U){var V=v;v=(V-S)*D-(x-T)*F+S,x=(V-S)*F+(x-T)*D+T}b.push(new Ze.Vector2(v,x))}}var N=b[b.length-1];return Math.abs(N.x-b[0].x)<1e-10&&Math.abs(N.y-b[0].y)<1e-10&&b.splice(b.length-1,1),e&&b.push(b[0]),b},Ze.Path.prototype.toShapes=function(t,e){function i(t){for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i],o=new Ze.Shape;o.actions=n.actions,o.curves=n.curves,e.push(o)}return e}function r(t,e){for(var i=e.length,r=!1,n=i-1,o=0;o<i;n=o++){var a=e[n],s=e[o],h=s.x-a.x,c=s.y-a.y;if(1e-10<Math.abs(c)){if(c<0&&(a=e[o],h=-h,s=e[n],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=c*(t.x-a.x)-h*(t.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var n=function(t){var e,i,r,n,o,a=[],s=new Ze.Path;for(e=0,i=t.length;e<i;e++)o=(r=t[e]).args,(n=r.action)===Ze.PathActions.MOVE_TO&&0!==s.actions.length&&(a.push(s),s=new Ze.Path),s[n].apply(s,o);return 0!==s.actions.length&&a.push(s),a}(this.actions);if(0===n.length)return[];if(!0===e)return i(n);var o,a,s,h=[];if(1===n.length)return a=n[0],(s=new Ze.Shape).actions=a.actions,s.curves=a.curves,h.push(s),h;var c=!Ze.Shape.Utils.isClockWise(n[0].getPoints());c=t?!c:c;var l,u,p,d,f,m,g=[],y=[],v=[],x=0;for(y[x]=void 0,v[x]=[],u=0,p=n.length;u<p;u++)l=(a=n[u]).getPoints(),o=Ze.Shape.Utils.isClockWise(l),(o=t?!o:o)?(!c&&y[x]&&x++,y[x]={s:new Ze.Shape,p:l},y[x].s.actions=a.actions,y[x].s.curves=a.curves,c&&x++,v[x]=[]):v[x].push({h:a,p:l[0]});if(!y[0])return i(n);if(1<y.length){for(var b=!1,w=[],M=0,_=y.length;M<_;M++)g[M]=[];for(M=0,_=y.length;M<_;M++)for(var S=v[M],T=0;T<S.length;T++){for(var C=S[T],E=!0,A=0;A<y.length;A++)r(C.p,y[A].p)&&(M!==A&&w.push({froms:M,tos:A,hole:T}),E?(E=!1,g[A].push(C)):b=!0);E&&g[M].push(C)}0<w.length&&(b||(v=g))}for(u=0,p=y.length;u<p;u++)for(s=y[u].s,h.push(s),f=0,m=(d=v[u]).length;f<m;f++)s.holes.push(d[f].h);return h},Ze.Shape=function(){Ze.Path.apply(this,arguments),this.holes=[]},Ze.Shape.prototype=Object.create(Ze.Path.prototype),Ze.Shape.prototype.constructor=Ze.Shape,Ze.Shape.prototype.extrude=function(t){return new Ze.ExtrudeGeometry(this,t)},Ze.Shape.prototype.makeGeometry=function(t){return new Ze.ShapeGeometry(this,t)},Ze.Shape.prototype.getPointsHoles=function(t){var e,i=this.holes.length,r=[];for(e=0;e<i;e++)r[e]=this.holes[e].getTransformedPoints(t,this.bends);return r},Ze.Shape.prototype.getSpacedPointsHoles=function(t){var e,i=this.holes.length,r=[];for(e=0;e<i;e++)r[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return r},Ze.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},Ze.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},Ze.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},Ze.Shape.Utils={triangulateShape:function(t,e){function T(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function S(t,e,i,r,n){var o=e.x-t.x,a=e.y-t.y,s=r.x-i.x,h=r.y-i.y,c=t.x-i.x,l=t.y-i.y,u=a*s-o*h,p=a*c-o*l;if(1e-10<Math.abs(u)){var d;if(0<u){if(p<0||u<p)return[];if((d=h*c-s*l)<0||u<d)return[]}else{if(0<p||p<u)return[];if(0<(d=h*c-s*l)||d<u)return[]}if(0===d)return!n||0!==p&&p!==u?[t]:[];if(d===u)return!n||0!==p&&p!==u?[e]:[];if(0===p)return[i];if(p===u)return[r];var f=d/u;return[{x:t.x+f*o,y:t.y+f*a}]}if(0!==p||h*c!=s*l)return[];var m,g,y,v,x,b,w,M,_=0===o&&0===a,S=0===s&&0===h;return _&&S?t.x!==i.x||t.y!==i.y?[]:[t]:_?T(i,r,t)?[t]:[]:S?T(t,e,i)?[i]:[]:(M=0!==o?(v=t.x<e.x?(y=(m=t).x,(g=e).x):(y=(m=e).x,(g=t).x),i.x<r.x?(w=(x=i).x,(b=r).x):(w=(x=r).x,(b=i).x)):(v=t.y<e.y?(y=(m=t).y,(g=e).y):(y=(m=e).y,(g=t).y),i.y<r.y?(w=(x=i).y,(b=r).y):(w=(x=r).y,(b=i).y)),y<=w?v<w?[]:v===w?n?[]:[x]:v<=M?[x,g]:[x,b]:M<y?[]:y===M?n?[]:[m]:v<=M?[m,g]:[m,b])}function C(t,e,i,r){var n=e.x-t.x,o=e.y-t.y,a=i.x-t.x,s=i.y-t.y,h=r.x-t.x,c=r.y-t.y,l=n*s-o*a,u=n*c-o*h;if(1e-10<Math.abs(l)){var p=h*s-c*a;return 0<l?0<=u&&0<=p:0<=u||0<=p}return 0<u}for(var i,r,n,o,a,s,h={},c=t.concat(),l=0,u=e.length;l<u;l++)Array.prototype.push.apply(c,e[l]);for(i=0,r=c.length;i<r;i++)void 0!==h[a=c[i].x+":"+c[i].y]&&console.warn("THREE.Shape: Duplicate point",a),h[a]=i;var p=function(t,a){var c,l=t.concat();function e(t,e){var i=l.length-1,r=t-1;r<0&&(r=i);var n=t+1;i<n&&(n=0);var o=C(l[t],l[r],l[n],c[e]);if(!o)return!1;var a=c.length-1,s=e-1;s<0&&(s=a);var h=e+1;return a<h&&(h=0),!!(o=C(c[e],c[s],c[h],l[t]))}function i(t,e){var i,r;for(i=0;i<l.length;i++)if(r=i+1,r%=l.length,0<S(t,e,l[i],l[r],!0).length)return!0;return!1}var s=[];function r(t,e){var i,r,n,o;for(i=0;i<s.length;i++)for(r=a[s[i]],n=0;n<r.length;n++)if(o=n+1,o%=r.length,0<S(t,e,r[n],r[o],!0).length)return!0;return!1}for(var n,o,h,u,p,d,f,m,g,y,v=[],x=0,b=a.length;x<b;x++)s.push(x);for(var w=0,M=2*s.length;0<s.length;){if(--M<0){console.log("Infinite Loop! Holes left:"+s.length+", Probably Hole outside Shape!");break}for(o=w;o<l.length;o++){for(h=l[o],n=-1,x=0;x<s.length;x++)if(p=s[x],void 0===v[d=h.x+":"+h.y+":"+p]){c=a[p];for(var _=0;_<c.length;_++)if(u=c[_],e(o,_)&&!i(h,u)&&!r(h,u)){n=_,s.splice(x,1),f=l.slice(0,o+1),m=l.slice(o),g=c.slice(n),y=c.slice(0,n+1),l=f.concat(g).concat(y).concat(m),w=o;break}if(0<=n)break;v[d]=!0}if(0<=n)break}}return l}(t,e),d=Ze.FontUtils.Triangulate(p,!1);for(i=0,r=d.length;i<r;i++)for(o=d[i],n=0;n<3;n++)void 0!==(s=h[a=o[n].x+":"+o[n].y])&&(o[n]=s);return d.concat()},isClockWise:function(t){return Ze.FontUtils.Triangulate.area(t)<0},b2p0:function(t,e){var i=1-t;return i*i*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,i,r){return this.b2p0(t,e)+this.b2p1(t,i)+this.b2p2(t,r)},b3p0:function(t,e){var i=1-t;return i*i*i*e},b3p1:function(t,e){var i=1-t;return 3*i*i*t*e},b3p2:function(t,e){return 3*(1-t)*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,i,r,n){return this.b3p0(t,e)+this.b3p1(t,i)+this.b3p2(t,r)+this.b3p3(t,n)}},Ze.LineCurve=function(t,e){this.v1=t,this.v2=e},Ze.LineCurve.prototype=Object.create(Ze.Curve.prototype),Ze.LineCurve.prototype.constructor=Ze.LineCurve,Ze.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},Ze.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},Ze.LineCurve.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},Ze.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},Ze.QuadraticBezierCurve.prototype=Object.create(Ze.Curve.prototype),Ze.QuadraticBezierCurve.prototype.constructor=Ze.QuadraticBezierCurve,Ze.QuadraticBezierCurve.prototype.getPoint=function(t){var e=new Ze.Vector2;return e.x=Ze.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=Ze.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e},Ze.QuadraticBezierCurve.prototype.getTangent=function(t){var e=new Ze.Vector2;return e.x=Ze.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),e.y=Ze.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y),e.normalize()},Ze.CubicBezierCurve=function(t,e,i,r){this.v0=t,this.v1=e,this.v2=i,this.v3=r},Ze.CubicBezierCurve.prototype=Object.create(Ze.Curve.prototype),Ze.CubicBezierCurve.prototype.constructor=Ze.CubicBezierCurve,Ze.CubicBezierCurve.prototype.getPoint=function(t){var e,i;return e=Ze.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=Ze.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ze.Vector2(e,i)},Ze.CubicBezierCurve.prototype.getTangent=function(t){var e,i;e=Ze.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=Ze.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var r=new Ze.Vector2(e,i);return r.normalize(),r},Ze.SplineCurve=function(t){this.points=null==t?[]:t},Ze.SplineCurve.prototype=Object.create(Ze.Curve.prototype),Ze.SplineCurve.prototype.constructor=Ze.SplineCurve,Ze.SplineCurve.prototype.getPoint=function(t){var e=this.points,i=(e.length-1)*t,r=Math.floor(i),n=i-r,o=e[0===r?r:r-1],a=e[r],s=e[r>e.length-2?e.length-1:r+1],h=e[r>e.length-3?e.length-1:r+2],c=new Ze.Vector2;return c.x=Ze.Curve.Utils.interpolate(o.x,a.x,s.x,h.x,n),c.y=Ze.Curve.Utils.interpolate(o.y,a.y,s.y,h.y,n),c},Ze.EllipseCurve=function(t,e,i,r,n,o,a,s){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0},Ze.EllipseCurve.prototype=Object.create(Ze.Curve.prototype),Ze.EllipseCurve.prototype.constructor=Ze.EllipseCurve,Ze.EllipseCurve.prototype.getPoint=function(t){var e,i=this.aEndAngle-this.aStartAngle;i<0&&(i+=2*Math.PI),i>2*Math.PI&&(i-=2*Math.PI),e=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-i):this.aStartAngle+t*i;var r=this.aX+this.xRadius*Math.cos(e),n=this.aY+this.yRadius*Math.sin(e);if(0!==this.aRotation){var o=Math.cos(this.aRotation),a=Math.sin(this.aRotation),s=r,h=n;r=(s-this.aX)*o-(h-this.aY)*a+this.aX,n=(s-this.aX)*a+(h-this.aY)*o+this.aY}return new Ze.Vector2(r,n)},Ze.ArcCurve=function(t,e,i,r,n,o){Ze.EllipseCurve.call(this,t,e,i,i,r,n,o)},Ze.ArcCurve.prototype=Object.create(Ze.EllipseCurve.prototype),Ze.ArcCurve.prototype.constructor=Ze.ArcCurve,Ze.LineCurve3=Ze.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new Ze.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),Ze.QuadraticBezierCurve3=Ze.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=new Ze.Vector3;return e.x=Ze.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=Ze.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e.z=Ze.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),e}),Ze.CubicBezierCurve3=Ze.Curve.create(function(t,e,i,r){this.v0=t,this.v1=e,this.v2=i,this.v3=r},function(t){var e=new Ze.Vector3;return e.x=Ze.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e.y=Ze.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e.z=Ze.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),e}),Ze.SplineCurve3=Ze.Curve.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=null==t?[]:t},function(t){var e=this.points,i=(e.length-1)*t,r=Math.floor(i),n=i-r,o=e[0==r?r:r-1],a=e[r],s=e[r>e.length-2?e.length-1:r+1],h=e[r>e.length-3?e.length-1:r+2],c=new Ze.Vector3;return c.x=Ze.Curve.Utils.interpolate(o.x,a.x,s.x,h.x,n),c.y=Ze.Curve.Utils.interpolate(o.y,a.y,s.y,h.y,n),c.z=Ze.Curve.Utils.interpolate(o.z,a.z,s.z,h.z,n),c}),Ze.CatmullRomCurve3=function(){var m=new Ze.Vector3,g=new t,y=new t,v=new t;function t(){}return t.prototype.init=function(t,e,i,r){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-r,this.c3=2*t-2*e+i+r},t.prototype.initNonuniformCatmullRom=function(t,e,i,r,n,o,a){var s=(e-t)/n-(i-t)/(n+o)+(i-e)/o,h=(i-e)/o-(r-e)/(o+a)+(r-i)/a;s*=o,h*=o,this.init(e,i,s,h)},t.prototype.initCatmullRom=function(t,e,i,r,n){this.init(e,i,n*(i-t),n*(r-e))},t.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},Ze.Curve.create(function(t){this.points=t||[]},function(t){var e,i,r,n,o,a,s,h,c=this.points;if((n=c.length)<2&&console.log("duh, you need at least 2 points"),0===(r=(e=(n-1)*t)-(i=Math.floor(e)))&&i===n-1&&(i=n-2,r=1),o=0===i?(m.subVectors(c[0],c[1]).add(c[0]),m):c[i-1],a=c[i],s=c[i+1],h=i+2<n?c[i+2]:(m.subVectors(c[n-1],c[n-2]).add(c[n-2]),m),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var l="chordal"===this.type?.5:.25,u=Math.pow(o.distanceToSquared(a),l),p=Math.pow(a.distanceToSquared(s),l),d=Math.pow(s.distanceToSquared(h),l);p<1e-4&&(p=1),u<1e-4&&(u=p),d<1e-4&&(d=p),g.initNonuniformCatmullRom(o.x,a.x,s.x,h.x,u,p,d),y.initNonuniformCatmullRom(o.y,a.y,s.y,h.y,u,p,d),v.initNonuniformCatmullRom(o.z,a.z,s.z,h.z,u,p,d)}else if("catmullrom"===this.type){var f=void 0!==this.tension?this.tension:.5;g.initCatmullRom(o.x,a.x,s.x,h.x,f),y.initCatmullRom(o.y,a.y,s.y,h.y,f),v.initCatmullRom(o.z,a.z,s.z,h.z,f)}return new Ze.Vector3(g.calc(r),y.calc(r),v.calc(r))})}(),Ze.ClosedSplineCurve3=Ze.Curve.create(function(t){this.points=null==t?[]:t},function(t){var e=this.points,i=(e.length-0)*t,r=Math.floor(i),n=i-r,o=e[((r+=0<r?0:(Math.floor(Math.abs(r)/e.length)+1)*e.length)-1)%e.length],a=e[r%e.length],s=e[(r+1)%e.length],h=e[(r+2)%e.length],c=new Ze.Vector3;return c.x=Ze.Curve.Utils.interpolate(o.x,a.x,s.x,h.x,n),c.y=Ze.Curve.Utils.interpolate(o.y,a.y,s.y,h.y,n),c.z=Ze.Curve.Utils.interpolate(o.z,a.z,s.z,h.z,n),c}),Ze.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(t){if(!0===t.initialized)return t;for(var e=0;e<t.hierarchy.length;e++){for(var i=0;i<t.hierarchy[e].keys.length;i++)if(t.hierarchy[e].keys[i].time<0&&(t.hierarchy[e].keys[i].time=0),void 0!==t.hierarchy[e].keys[i].rot&&!(t.hierarchy[e].keys[i].rot instanceof Ze.Quaternion)){var r=t.hierarchy[e].keys[i].rot;t.hierarchy[e].keys[i].rot=(new Ze.Quaternion).fromArray(r)}if(t.hierarchy[e].keys.length&&void 0!==t.hierarchy[e].keys[0].morphTargets){var n={};for(i=0;i<t.hierarchy[e].keys.length;i++)for(var o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++){n[s=t.hierarchy[e].keys[i].morphTargets[o]]=-1}t.hierarchy[e].usedMorphTargets=n;for(i=0;i<t.hierarchy[e].keys.length;i++){var a={};for(var s in n){for(o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++)if(t.hierarchy[e].keys[i].morphTargets[o]===s){a[s]=t.hierarchy[e].keys[i].morphTargetsInfluences[o];break}o===t.hierarchy[e].keys[i].morphTargets.length&&(a[s]=0)}t.hierarchy[e].keys[i].morphTargetsInfluences=a}}for(i=1;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].time===t.hierarchy[e].keys[i-1].time&&(t.hierarchy[e].keys.splice(i,1),i--);for(i=0;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].index=i}return t.initialized=!0,t},parse:function(t){var r=function(t,e){e.push(t);for(var i=0;i<t.children.length;i++)r(t.children[i],e)},e=[];if(t instanceof Ze.SkinnedMesh)for(var i=0;i<t.skeleton.bones.length;i++)e.push(t.skeleton.bones[i]);else r(t,e);return e},play:function(t){-1===this.animations.indexOf(t)&&this.animations.push(t)},stop:function(t){var e=this.animations.indexOf(t);-1!==e&&this.animations.splice(e,1)},update:function(t){for(var e=0;e<this.animations.length;e++)this.animations[e].resetBlendWeights();for(e=0;e<this.animations.length;e++)this.animations[e].update(t)}},Ze.Animation=function(t,e){this.root=t,this.data=Ze.AnimationHandler.init(e),this.hierarchy=Ze.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=Ze.AnimationHandler.LINEAR},Ze.Animation.prototype={constructor:Ze.Animation,keyTypes:["pos","rot","scl"],play:function(t,e){this.currentTime=void 0!==t?t:0,this.weight=void 0!==e?e:1,this.isPlaying=!0,this.reset(),Ze.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,Ze.AnimationHandler.stop(this)},reset:function(){for(var t=0,e=this.hierarchy.length;t<e;t++){var i=this.hierarchy[t];void 0===i.animationCache&&(i.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var r=this.data.name,n=i.animationCache.animations,o=n[r];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:i.matrix},n[r]=o);for(var a=0;a<3;a++){for(var s=this.keyTypes[a],h=this.data.hierarchy[t].keys[0],c=this.getNextKeyWith(s,t,1);c.time<this.currentTime&&c.index>h.index;)h=c,c=this.getNextKeyWith(s,t,c.index+1);o.prevKey[s]=h,o.nextKey[s]=c}}},resetBlendWeights:function(){for(var t=0,e=this.hierarchy.length;t<e;t++){var i=this.hierarchy[t].animationCache;if(void 0!==i){var r=i.blending;r.positionWeight=0,r.quaternionWeight=0,r.scaleWeight=0}}},update:(Se=[],Te=new Ze.Vector3,Ce=new Ze.Vector3,Ee=new Ze.Quaternion,Ae=function(t,e){var i,r,n,o,a,s,h,c,l,u=[],p=[];return n=(i=(t.length-1)*e)-(r=Math.floor(i)),u[0]=0===r?r:r-1,u[1]=r,u[2]=r>t.length-2?r:r+1,u[3]=r>t.length-3?r:r+2,s=t[u[0]],h=t[u[1]],c=t[u[2]],l=t[u[3]],a=n*(o=n*n),p[0]=Le(s[0],h[0],c[0],l[0],n,o,a),p[1]=Le(s[1],h[1],c[1],l[1],n,o,a),p[2]=Le(s[2],h[2],c[2],l[2],n,o,a),p},Le=function(t,e,i,r,n,o,a){var s=.5*(i-t),h=.5*(r-e);return(2*(e-i)+s+h)*a+(-3*(e-i)-2*s-h)*o+s*n+e},function(t){if(!1!==this.isPlaying&&(this.currentTime+=t*this.timeScale,0!==this.weight)){var e=this.data.length;(this.currentTime>e||this.currentTime<0)&&(this.loop?(this.currentTime%=e,this.currentTime<0&&(this.currentTime+=e),this.reset()):this.stop());for(var i=0,r=this.hierarchy.length;i<r;i++)for(var n=this.hierarchy[i],o=n.animationCache.animations[this.data.name],a=n.animationCache.blending,s=0;s<3;s++){var h=this.keyTypes[s],c=o.prevKey[h],l=o.nextKey[h];if(0<this.timeScale&&l.time<=this.currentTime||this.timeScale<0&&c.time>=this.currentTime){for(c=this.data.hierarchy[i].keys[0],l=this.getNextKeyWith(h,i,1);l.time<this.currentTime&&l.index>c.index;)c=l,l=this.getNextKeyWith(h,i,l.index+1);o.prevKey[h]=c,o.nextKey[h]=l}var u=(this.currentTime-c.time)/(l.time-c.time),p=c[h],d=l[h];if(u<0&&(u=0),1<u&&(u=1),"pos"===h){if(this.interpolationType===Ze.AnimationHandler.LINEAR){Ce.x=p[0]+(d[0]-p[0])*u,Ce.y=p[1]+(d[1]-p[1])*u,Ce.z=p[2]+(d[2]-p[2])*u;var f=this.weight/(this.weight+a.positionWeight);n.position.lerp(Ce,f),a.positionWeight+=this.weight}else if(this.interpolationType===Ze.AnimationHandler.CATMULLROM||this.interpolationType===Ze.AnimationHandler.CATMULLROM_FORWARD){Se[0]=this.getPrevKeyWith("pos",i,c.index-1).pos,Se[1]=p,Se[2]=d,Se[3]=this.getNextKeyWith("pos",i,l.index+1).pos;var m=Ae(Se,u=.33*u+.33);f=this.weight/(this.weight+a.positionWeight),a.positionWeight+=this.weight;var g=n.position;if(g.x=g.x+(m[0]-g.x)*f,g.y=g.y+(m[1]-g.y)*f,g.z=g.z+(m[2]-g.z)*f,this.interpolationType===Ze.AnimationHandler.CATMULLROM_FORWARD){var y=Ae(Se,1.01*u);Te.set(y[0],y[1],y[2]),Te.sub(g),Te.y=0,Te.normalize();var v=Math.atan2(Te.x,Te.z);n.rotation.set(0,v,0)}}}else"rot"===h?(Ze.Quaternion.slerp(p,d,Ee,u),0===a.quaternionWeight?(n.quaternion.copy(Ee),a.quaternionWeight=this.weight):(f=this.weight/(this.weight+a.quaternionWeight),Ze.Quaternion.slerp(n.quaternion,Ee,n.quaternion,f),a.quaternionWeight+=this.weight)):"scl"===h&&(Ce.x=p[0]+(d[0]-p[0])*u,Ce.y=p[1]+(d[1]-p[1])*u,Ce.z=p[2]+(d[2]-p[2])*u,f=this.weight/(this.weight+a.scaleWeight),n.scale.lerp(Ce,f),a.scaleWeight+=this.weight)}return!0}}),getNextKeyWith:function(t,e,i){var r=this.data.hierarchy[e].keys;for(this.interpolationType===Ze.AnimationHandler.CATMULLROM||this.interpolationType===Ze.AnimationHandler.CATMULLROM_FORWARD?i=i<r.length-1?i:r.length-1:i%=r.length;i<r.length;i++)if(void 0!==r[i][t])return r[i];return this.data.hierarchy[e].keys[0]},getPrevKeyWith:function(t,e,i){var r=this.data.hierarchy[e].keys;for(i=this.interpolationType===Ze.AnimationHandler.CATMULLROM||this.interpolationType===Ze.AnimationHandler.CATMULLROM_FORWARD?0<i?i:0:0<=i?i:i+r.length;0<=i;i--)if(void 0!==r[i][t])return r[i];return this.data.hierarchy[e].keys[r.length-1]}},Ze.KeyFrameAnimation=function(t){this.root=t.node,this.data=Ze.AnimationHandler.init(t),this.hierarchy=Ze.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var e=0,i=this.hierarchy.length;e<i;e++){var r=this.data.hierarchy[e].keys,n=this.data.hierarchy[e].sids,o=this.hierarchy[e];if(r.length&&n){for(var a=0;a<n.length;a++){var s=n[a],h=this.getNextKeyWith(s,e,0);h&&h.apply(s)}o.matrixAutoUpdate=!1,this.data.hierarchy[e].node.updateMatrix(),o.matrixWorldNeedsUpdate=!0}}},Ze.KeyFrameAnimation.prototype={constructor:Ze.KeyFrameAnimation,play:function(t){if(this.currentTime=void 0!==t?t:0,!1===this.isPlaying){this.isPlaying=!0;var e,i,r,n=this.hierarchy.length;for(e=0;e<n;e++){i=this.hierarchy[e],void 0===(r=this.data.hierarchy[e]).animationCache&&(r.animationCache={},r.animationCache.prevKey=null,r.animationCache.nextKey=null,r.animationCache.originalMatrix=i.matrix);var o=this.data.hierarchy[e].keys;o.length&&(r.animationCache.prevKey=o[0],r.animationCache.nextKey=o[1],this.startTime=Math.min(o[0].time,this.startTime),this.endTime=Math.max(o[o.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,Ze.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,Ze.AnimationHandler.stop(this);for(var t=0;t<this.data.hierarchy.length;t++){var e=this.hierarchy[t],i=this.data.hierarchy[t];if(void 0!==i.animationCache){var r=i.animationCache.originalMatrix;r.copy(e.matrix),e.matrix=r,delete i.animationCache}}},update:function(t){if(!1!==this.isPlaying){this.currentTime+=t*this.timeScale;var e=this.data.length;!0===this.loop&&this.currentTime>e&&(this.currentTime%=e),this.currentTime=Math.min(this.currentTime,e);for(var i=0,r=this.hierarchy.length;i<r;i++){var n=this.hierarchy[i],o=this.data.hierarchy[i],a=o.keys,s=o.animationCache;if(a.length){var h=s.prevKey,c=s.nextKey;if(c.time<=this.currentTime){for(;c.time<this.currentTime&&c.index>h.index;)c=a[(h=c).index+1];s.prevKey=h,s.nextKey=c}c.time>=this.currentTime?h.interpolate(c,this.currentTime):h.interpolate(c,c.time),this.data.hierarchy[i].node.updateMatrix(),n.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(t,e,i){var r=this.data.hierarchy[e].keys;for(i%=r.length;i<r.length;i++)if(r[i].hasTarget(t))return r[i];return r[0]},getPrevKeyWith:function(t,e,i){var r=this.data.hierarchy[e].keys;for(i=0<=i?i:i+r.length;0<=i;i--)if(r[i].hasTarget(t))return r[i];return r[r.length-1]}},Ze.MorphAnimation=function(t){this.mesh=t,this.frames=t.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},Ze.MorphAnimation.prototype={constructor:Ze.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(t){if(!1!==this.isPlaying){this.currentTime+=t,!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var e=this.duration/this.frames,i=Math.floor(this.currentTime/e),r=this.mesh.morphTargetInfluences;i!==this.currentFrame&&(r[this.lastFrame]=0,r[this.currentFrame]=1,r[i]=0,this.lastFrame=this.currentFrame,this.currentFrame=i);var n=this.currentTime%e/e;r[i]=n,r[this.lastFrame]=1-n}}},Ze.BoxGeometry=function(t,e,i,r,n,o){Ze.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:o},this.widthSegments=r||1,this.heightSegments=n||1,this.depthSegments=o||1;var k=this,a=t/2,s=e/2,h=i/2;function c(t,e,i,r,n,o,a,s){var h,c,l,u=k.widthSegments,p=k.heightSegments,d=n/2,f=o/2,m=k.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?h="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(h="y",p=k.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(h="x",u=k.depthSegments);var g=u+1,y=p+1,v=n/u,x=o/p,b=new Ze.Vector3;for(b[h]=0<a?1:-1,l=0;l<y;l++)for(c=0;c<g;c++){var w=new Ze.Vector3;w[t]=(c*v-d)*i,w[e]=(l*x-f)*r,w[h]=a,k.vertices.push(w)}for(l=0;l<p;l++)for(c=0;c<u;c++){var M=c+g*l,_=c+g*(l+1),S=c+1+g*(l+1),T=c+1+g*l,C=new Ze.Vector2(c/u,1-l/p),E=new Ze.Vector2(c/u,1-(l+1)/p),A=new Ze.Vector2((c+1)/u,1-(l+1)/p),L=new Ze.Vector2((c+1)/u,1-l/p),P=new Ze.Face3(M+m,_+m,T+m);P.normal.copy(b),P.vertexNormals.push(b.clone(),b.clone(),b.clone()),P.materialIndex=s,k.faces.push(P),k.faceVertexUvs[0].push([C,E,L]),(P=new Ze.Face3(_+m,S+m,T+m)).normal.copy(b),P.vertexNormals.push(b.clone(),b.clone(),b.clone()),P.materialIndex=s,k.faces.push(P),k.faceVertexUvs[0].push([E.clone(),A,L.clone()])}}c("z","y",-1,-1,i,e,a,0),c("z","y",1,-1,i,e,-a,1),c("x","z",1,1,t,i,s,2),c("x","z",1,-1,t,i,-s,3),c("x","y",1,-1,t,e,h,4),c("x","y",-1,-1,t,e,-h,5),this.mergeVertices()},Ze.BoxGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.BoxGeometry.prototype.constructor=Ze.BoxGeometry,Ze.BoxGeometry.prototype.clone=function(){return new Ze.BoxGeometry(this.parameters.width,this.parameters.height,this.parameters.depth,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.depthSegments)},Ze.CubeGeometry=Ze.BoxGeometry,Ze.CircleGeometry=function(t,e,i,r){Ze.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var n,o=[],a=new Ze.Vector3,s=new Ze.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),n=0;n<=e;n++){var h=new Ze.Vector3,c=i+n/e*r;h.x=t*Math.cos(c),h.y=t*Math.sin(c),this.vertices.push(h),o.push(new Ze.Vector2((h.x/t+1)/2,(h.y/t+1)/2))}var l=new Ze.Vector3(0,0,1);for(n=1;n<=e;n++)this.faces.push(new Ze.Face3(n,n+1,0,[l.clone(),l.clone(),l.clone()])),this.faceVertexUvs[0].push([o[n].clone(),o[n+1].clone(),s.clone()]);this.computeFaceNormals(),this.boundingSphere=new Ze.Sphere(new Ze.Vector3,t)},Ze.CircleGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.CircleGeometry.prototype.constructor=Ze.CircleGeometry,Ze.CircleGeometry.prototype.clone=function(){return new Ze.CircleGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength)},Ze.CircleBufferGeometry=function(t,e,i,r){Ze.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var n=e+2,o=new Float32Array(3*n),a=new Float32Array(3*n),s=new Float32Array(2*n);a[3]=1,s[0]=.5,s[1]=.5;for(var h=0,c=3,l=2;h<=e;h++,c+=3,l+=2){var u=i+h/e*r;o[c]=t*Math.cos(u),o[c+1]=t*Math.sin(u),a[c+2]=1,s[l]=(o[c]/t+1)/2,s[l+1]=(o[c+1]/t+1)/2}var p=[];for(c=1;c<=e;c++)p.push(c),p.push(c+1),p.push(0);this.setIndex(new Ze.BufferAttribute(new Uint16Array(p),1)),this.addAttribute("position",new Ze.BufferAttribute(o,3)),this.addAttribute("normal",new Ze.BufferAttribute(a,3)),this.addAttribute("uv",new Ze.BufferAttribute(s,2)),this.boundingSphere=new Ze.Sphere(new Ze.Vector3,t)},Ze.CircleBufferGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.CircleBufferGeometry.prototype.constructor=Ze.CircleBufferGeometry,Ze.CircleBufferGeometry.prototype.clone=function(){var t=new Ze.CircleBufferGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return t.copy(this),t},Ze.CylinderGeometry=function(t,e,i,r,n,o,a,s){Ze.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:n,openEnded:o,thetaStart:a,thetaLength:s},t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,r=r||8,n=n||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var h,c,l=i/2,u=[],p=[];for(c=0;c<=n;c++){var d=[],f=[],m=c/n,g=m*(e-t)+t;for(h=0;h<=r;h++){var y=h/r,v=new Ze.Vector3;v.x=g*Math.sin(y*s+a),v.y=-m*i+l,v.z=g*Math.cos(y*s+a),this.vertices.push(v),d.push(this.vertices.length-1),f.push(new Ze.Vector2(y,1-m))}u.push(d),p.push(f)}var x,b,w=(e-t)/i;for(h=0;h<r;h++)for(b=0!==t?(x=this.vertices[u[0][h]].clone(),this.vertices[u[0][h+1]].clone()):(x=this.vertices[u[1][h]].clone(),this.vertices[u[1][h+1]].clone()),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*w).normalize(),b.setY(Math.sqrt(b.x*b.x+b.z*b.z)*w).normalize(),c=0;c<n;c++){var M=u[c][h],_=u[c+1][h],S=u[c+1][h+1],T=u[c][h+1],C=x.clone(),E=x.clone(),A=b.clone(),L=b.clone(),P=p[c][h].clone(),k=p[c+1][h].clone(),R=p[c+1][h+1].clone(),D=p[c][h+1].clone();this.faces.push(new Ze.Face3(M,_,T,[C,E,L])),this.faceVertexUvs[0].push([P,k,D]),this.faces.push(new Ze.Face3(_,S,T,[E.clone(),A,L.clone()])),this.faceVertexUvs[0].push([k.clone(),R,D.clone()])}if(!1===o&&0<t)for(this.vertices.push(new Ze.Vector3(0,l,0)),h=0;h<r;h++){M=u[0][h],_=u[0][h+1],S=this.vertices.length-1,C=new Ze.Vector3(0,1,0),E=new Ze.Vector3(0,1,0),A=new Ze.Vector3(0,1,0),P=p[0][h].clone(),k=p[0][h+1].clone(),R=new Ze.Vector2(k.x,0);this.faces.push(new Ze.Face3(M,_,S,[C,E,A],void 0,1)),this.faceVertexUvs[0].push([P,k,R])}if(!1===o&&0<e)for(this.vertices.push(new Ze.Vector3(0,-l,0)),h=0;h<r;h++){M=u[n][h+1],_=u[n][h],S=this.vertices.length-1,C=new Ze.Vector3(0,-1,0),E=new Ze.Vector3(0,-1,0),A=new Ze.Vector3(0,-1,0),P=p[n][h+1].clone(),k=p[n][h].clone(),R=new Ze.Vector2(k.x,1);this.faces.push(new Ze.Face3(M,_,S,[C,E,A],void 0,2)),this.faceVertexUvs[0].push([P,k,R])}this.computeFaceNormals()},Ze.CylinderGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.CylinderGeometry.prototype.constructor=Ze.CylinderGeometry,Ze.CylinderGeometry.prototype.clone=function(){return new Ze.CylinderGeometry(this.parameters.radiusTop,this.parameters.radiusBottom,this.parameters.height,this.parameters.radialSegments,this.parameters.heightSegments,this.parameters.openEnded,this.parameters.thetaStart,this.parameters.thetaLength)},Ze.EdgesGeometry=function(t,e){Ze.BufferGeometry.call(this),e=void 0!==e?e:1;var i,r=Math.cos(Ze.Math.degToRad(e)),n=[0,0],o={},a=function(t,e){return t-e},s=["a","b","c"];t instanceof Ze.BufferGeometry?(i=new Ze.Geometry).fromBufferGeometry(t):i=t.clone(),i.mergeVertices(),i.computeFaceNormals();for(var h=i.vertices,c=i.faces,l=0,u=c.length;l<u;l++)for(var p=c[l],d=0;d<3;d++){n[0]=p[s[d]],n[1]=p[s[(d+1)%3]],n.sort(a),void 0===o[m=n.toString()]?o[m]={vert1:n[0],vert2:n[1],face1:l,face2:void 0}:o[m].face2=l}var f=[];for(var m in o){var g=o[m];if(void 0===g.face2||c[g.face1].normal.dot(c[g.face2].normal)<=r){var y=h[g.vert1];f.push(y.x),f.push(y.y),f.push(y.z),y=h[g.vert2],f.push(y.x),f.push(y.y),f.push(y.z)}}this.addAttribute("position",new Ze.BufferAttribute(new Float32Array(f),3))},Ze.EdgesGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.EdgesGeometry.prototype.constructor=Ze.EdgesGeometry,Ze.ExtrudeGeometry=function(t,e){void 0!==t?(Ze.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals()):t=[]},Ze.ExtrudeGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.ExtrudeGeometry.prototype.constructor=Ze.ExtrudeGeometry,Ze.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,r=0;r<i;r++){var n=t[r];this.addShape(n,e)}},Ze.ExtrudeGeometry.prototype.addShape=function(t,e){var i,r,n,o,a,s,h,c,l=void 0!==e.amount?e.amount:100,u=void 0!==e.bevelThickness?e.bevelThickness:6,p=void 0!==e.bevelSize?e.bevelSize:u-2,d=void 0!==e.bevelSegments?e.bevelSegments:3,f=void 0===e.bevelEnabled||e.bevelEnabled,m=void 0!==e.curveSegments?e.curveSegments:12,g=void 0!==e.steps?e.steps:1,y=e.extrudePath,v=!1,x=void 0!==e.UVGenerator?e.UVGenerator:Ze.ExtrudeGeometry.WorldUVGenerator;y&&(i=y.getSpacedPoints(g),f=!(v=!0),r=void 0!==e.frames?e.frames:new Ze.TubeGeometry.FrenetFrames(y,g,!1),n=new Ze.Vector3,o=new Ze.Vector3,a=new Ze.Vector3),f||(p=u=d=0);var b=this,w=this.vertices.length,M=t.extractPoints(m),_=M.shape,S=M.holes,T=!Ze.Shape.Utils.isClockWise(_);if(T){for(_=_.reverse(),h=0,c=S.length;h<c;h++)s=S[h],Ze.Shape.Utils.isClockWise(s)&&(S[h]=s.reverse());T=!1}var C=Ze.Shape.Utils.triangulateShape(_,S),E=_;for(h=0,c=S.length;h<c;h++)s=S[h],_=_.concat(s);function A(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}var L,P,k,R,D,F,O=_.length,B=C.length;function U(t,e,i){var r,n,o=1,a=t.x-e.x,s=t.y-e.y,h=i.x-t.x,c=i.y-t.y,l=a*a+s*s,u=a*c-s*h;if(1e-10<Math.abs(u)){var p=Math.sqrt(l),d=Math.sqrt(h*h+c*c),f=e.x-s/p,m=e.y+a/p,g=((i.x-c/d-f)*c-(i.y+h/d-m)*h)/(a*c-s*h),y=(r=f+a*g-t.x)*r+(n=m+s*g-t.y)*n;if(y<=2)return new Ze.Vector2(r,n);o=Math.sqrt(y/2)}else{var v=!1;1e-10<a?1e-10<h&&(v=!0):a<-1e-10?h<-1e-10&&(v=!0):Math.sign(s)===Math.sign(c)&&(v=!0),o=v?(r=-s,n=a,Math.sqrt(l)):(r=a,n=s,Math.sqrt(l/2))}return new Ze.Vector2(r/o,n/o)}for(var V=[],N=0,z=E.length,I=z-1,G=N+1;N<z;N++,I++,G++)I===z&&(I=0),G===z&&(G=0),V[N]=U(E[N],E[I],E[G]);var j,H,W=[],X=V.concat();for(h=0,c=S.length;h<c;h++){for(s=S[h],j=[],N=0,I=(z=s.length)-1,G=N+1;N<z;N++,I++,G++)I===z&&(I=0),G===z&&(G=0),j[N]=U(s[N],s[I],s[G]);W.push(j),X=X.concat(j)}for(L=0;L<d;L++){for(R=u*(1-(k=L/d)),P=p*Math.sin(k*Math.PI/2),N=0,z=E.length;N<z;N++)Y((D=A(E[N],V[N],P)).x,D.y,-R);for(h=0,c=S.length;h<c;h++)for(s=S[h],j=W[h],N=0,z=s.length;N<z;N++)Y((D=A(s[N],j[N],P)).x,D.y,-R)}for(P=p,N=0;N<O;N++)D=f?A(_[N],X[N],P):_[N],v?(o.copy(r.normals[0]).multiplyScalar(D.x),n.copy(r.binormals[0]).multiplyScalar(D.y),a.copy(i[0]).add(o).add(n),Y(a.x,a.y,a.z)):Y(D.x,D.y,0);for(H=1;H<=g;H++)for(N=0;N<O;N++)D=f?A(_[N],X[N],P):_[N],v?(o.copy(r.normals[H]).multiplyScalar(D.x),n.copy(r.binormals[H]).multiplyScalar(D.y),a.copy(i[H]).add(o).add(n),Y(a.x,a.y,a.z)):Y(D.x,D.y,l/g*H);for(L=d-1;0<=L;L--){for(R=u*(1-(k=L/d)),P=p*Math.sin(k*Math.PI/2),N=0,z=E.length;N<z;N++)Y((D=A(E[N],V[N],P)).x,D.y,l+R);for(h=0,c=S.length;h<c;h++)for(s=S[h],j=W[h],N=0,z=s.length;N<z;N++)D=A(s[N],j[N],P),v?Y(D.x,D.y+i[g-1].y,i[g-1].x+R):Y(D.x,D.y,l+R)}function q(t,e){var i,r;for(N=t.length;0<=--N;){(r=(i=N)-1)<0&&(r=t.length-1);var n=0,o=g+2*d;for(n=0;n<o;n++){var a=O*n,s=O*(n+1);Q(e+i+a,e+r+a,e+r+s,e+i+s,t,n,o,i,r)}}}function Y(t,e,i){b.vertices.push(new Ze.Vector3(t,e,i))}function K(t,e,i){t+=w,e+=w,i+=w,b.faces.push(new Ze.Face3(t,e,i));var r=x.generateTopUV(b,t,e,i);b.faceVertexUvs[0].push(r)}function Q(t,e,i,r,n,o,a,s,h){t+=w,e+=w,i+=w,r+=w,b.faces.push(new Ze.Face3(t,e,r)),b.faces.push(new Ze.Face3(e,i,r));var c=x.generateSideWallUV(b,t,e,i,r);b.faceVertexUvs[0].push([c[0],c[1],c[3]]),b.faceVertexUvs[0].push([c[1],c[2],c[3]])}!function(){if(f){var t=0,e=O*t;for(N=0;N<B;N++)K((F=C[N])[2]+e,F[1]+e,F[0]+e);for(e=O*(t=g+2*d),N=0;N<B;N++)K((F=C[N])[0]+e,F[1]+e,F[2]+e)}else{for(N=0;N<B;N++)K((F=C[N])[2],F[1],F[0]);for(N=0;N<B;N++)K((F=C[N])[0]+O*g,F[1]+O*g,F[2]+O*g)}}(),function(){var t=0;for(q(E,t),t+=E.length,h=0,c=S.length;h<c;h++)q(s=S[h],t),t+=s.length}()},Ze.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,r){var n=t.vertices,o=n[e],a=n[i],s=n[r];return[new Ze.Vector2(o.x,o.y),new Ze.Vector2(a.x,a.y),new Ze.Vector2(s.x,s.y)]},generateSideWallUV:function(t,e,i,r,n){var o=t.vertices,a=o[e],s=o[i],h=o[r],c=o[n];return Math.abs(a.y-s.y)<.01?[new Ze.Vector2(a.x,1-a.z),new Ze.Vector2(s.x,1-s.z),new Ze.Vector2(h.x,1-h.z),new Ze.Vector2(c.x,1-c.z)]:[new Ze.Vector2(a.y,1-a.z),new Ze.Vector2(s.y,1-s.z),new Ze.Vector2(h.y,1-h.z),new Ze.Vector2(c.y,1-c.z)]}},Ze.ShapeGeometry=function(t,e){Ze.Geometry.call(this),!(this.type="ShapeGeometry")===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},Ze.ShapeGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.ShapeGeometry.prototype.constructor=Ze.ShapeGeometry,Ze.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,r=t.length;i<r;i++)this.addShape(t[i],e);return this},Ze.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i,r,n,o=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,s=void 0===e.UVGenerator?Ze.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,h=this.vertices.length,c=t.extractPoints(o),l=c.shape,u=c.holes,p=!Ze.Shape.Utils.isClockWise(l);if(p){for(l=l.reverse(),i=0,r=u.length;i<r;i++)n=u[i],Ze.Shape.Utils.isClockWise(n)&&(u[i]=n.reverse());p=!1}var d=Ze.Shape.Utils.triangulateShape(l,u);for(i=0,r=u.length;i<r;i++)n=u[i],l=l.concat(n);var f,m,g=l.length,y=d.length;for(i=0;i<g;i++)f=l[i],this.vertices.push(new Ze.Vector3(f.x,f.y,0));for(i=0;i<y;i++){var v=(m=d[i])[0]+h,x=m[1]+h,b=m[2]+h;this.faces.push(new Ze.Face3(v,x,b,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,v,x,b))}},Ze.LatheGeometry=function(t,e,i,r){Ze.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=e||12,i=i||0,r=r||2*Math.PI;for(var n=1/(t.length-1),o=1/e,a=0,s=e;a<=s;a++)for(var h=i+a*o*r,c=Math.cos(h),l=Math.sin(h),u=0,p=t.length;u<p;u++){var d=t[u],f=new Ze.Vector3;f.x=c*d.x-l*d.y,f.y=l*d.x+c*d.y,f.z=d.z,this.vertices.push(f)}var m=t.length;for(a=0,s=e;a<s;a++)for(u=0,p=t.length-1;u<p;u++){var g=u+m*a,y=g,v=g+m,x=(c=g+1+m,g+1),b=a*o,w=u*n,M=b+o,_=w+n;this.faces.push(new Ze.Face3(y,v,x)),this.faceVertexUvs[0].push([new Ze.Vector2(b,w),new Ze.Vector2(M,w),new Ze.Vector2(b,_)]),this.faces.push(new Ze.Face3(v,c,x)),this.faceVertexUvs[0].push([new Ze.Vector2(M,w),new Ze.Vector2(M,_),new Ze.Vector2(b,_)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},Ze.LatheGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.LatheGeometry.prototype.constructor=Ze.LatheGeometry,Ze.PlaneGeometry=function(t,e,i,r){Ze.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r},this.fromBufferGeometry(new Ze.PlaneBufferGeometry(t,e,i,r))},Ze.PlaneGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.PlaneGeometry.prototype.constructor=Ze.PlaneGeometry,Ze.PlaneGeometry.prototype.clone=function(){return new Ze.PlaneGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments)},Ze.PlaneBufferGeometry=function(t,e,i,r){Ze.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r};for(var n=t/2,o=e/2,a=Math.floor(i)||1,s=Math.floor(r)||1,h=a+1,c=s+1,l=t/a,u=e/s,p=new Float32Array(h*c*3),d=new Float32Array(h*c*3),f=new Float32Array(h*c*2),m=0,g=0,y=0;y<c;y++)for(var v=y*u-o,x=0;x<h;x++){var b=x*l-n;p[m]=b,p[m+1]=-v,d[m+2]=1,f[g]=x/a,f[g+1]=1-y/s,m+=3,g+=2}m=0;var w=new(65535<p.length/3?Uint32Array:Uint16Array)(a*s*6);for(y=0;y<s;y++)for(x=0;x<a;x++){var M=x+h*y,_=x+h*(y+1),S=x+1+h*(y+1),T=x+1+h*y;w[m]=M,w[m+1]=_,w[m+2]=T,w[m+3]=_,w[m+4]=S,w[m+5]=T,m+=6}this.setIndex(new Ze.BufferAttribute(w,1)),this.addAttribute("position",new Ze.BufferAttribute(p,3)),this.addAttribute("normal",new Ze.BufferAttribute(d,3)),this.addAttribute("uv",new Ze.BufferAttribute(f,2))},Ze.PlaneBufferGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.PlaneBufferGeometry.prototype.constructor=Ze.PlaneBufferGeometry,Ze.PlaneBufferGeometry.prototype.clone=function(){var t=new Ze.PlaneBufferGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return t.copy(this),t},Ze.RingGeometry=function(t,e,i,r,n,o){Ze.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:o},t=t||0,e=e||50,n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var a,s,h=[],c=t,l=(e-t)/(r=void 0!==r?Math.max(1,r):8);for(a=0;a<r+1;a++){for(s=0;s<i+1;s++){var u=new Ze.Vector3,p=n+s/i*o;u.x=c*Math.cos(p),u.y=c*Math.sin(p),this.vertices.push(u),h.push(new Ze.Vector2((u.x/e+1)/2,(u.y/e+1)/2))}c+=l}var d=new Ze.Vector3(0,0,1);for(a=0;a<r;a++){var f=a*(i+1);for(s=0;s<i;s++){var m=p=s+f,g=p+i+1,y=p+i+2;this.faces.push(new Ze.Face3(m,g,y,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([h[m].clone(),h[g].clone(),h[y].clone()]),g=(m=p)+i+2,y=p+1,this.faces.push(new Ze.Face3(m,g,y,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([h[m].clone(),h[g].clone(),h[y].clone()])}}this.computeFaceNormals(),this.boundingSphere=new Ze.Sphere(new Ze.Vector3,c)},Ze.RingGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.RingGeometry.prototype.constructor=Ze.RingGeometry,Ze.RingGeometry.prototype.clone=function(){return new Ze.RingGeometry(this.parameters.innerRadius,this.parameters.outerRadius,this.parameters.thetaSegments,this.parameters.phiSegments,this.parameters.thetaStart,this.parameters.thetaLength)},Ze.SphereGeometry=function(t,e,i,r,n,o,a){Ze.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Ze.SphereBufferGeometry(t,e,i,r,n,o,a))},Ze.SphereGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.SphereGeometry.prototype.constructor=Ze.SphereGeometry,Ze.SphereGeometry.prototype.clone=function(){return new Ze.SphereGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength)},Ze.SphereBufferGeometry=function(t,e,i,r,n,o,a){Ze.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;for(var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),h=(e+1)*(i+1),c=new Ze.BufferAttribute(new Float32Array(3*h),3),l=new Ze.BufferAttribute(new Float32Array(3*h),3),u=new Ze.BufferAttribute(new Float32Array(2*h),2),p=0,d=[],f=new Ze.Vector3,m=0;m<=i;m++){for(var g=[],y=m/i,v=0;v<=e;v++){var x=v/e,b=-t*Math.cos(r+x*n)*Math.sin(o+y*a),w=t*Math.cos(o+y*a),M=t*Math.sin(r+x*n)*Math.sin(o+y*a);f.set(b,w,M).normalize(),c.setXYZ(p,b,w,M),l.setXYZ(p,f.x,f.y,f.z),u.setXY(p,x,1-y),g.push(p),p++}d.push(g)}var _=[];for(m=0;m<i;m++)for(v=0;v<e;v++){var S=d[m][v+1],T=d[m][v],C=d[m+1][v],E=d[m+1][v+1];(0!==m||0<o)&&_.push(S,T,E),(m!==i-1||s<Math.PI)&&_.push(T,C,E)}this.setIndex(new Ze.BufferAttribute(new Uint16Array(_),1)),this.addAttribute("position",c),this.addAttribute("normal",l),this.addAttribute("uv",u),this.boundingSphere=new Ze.Sphere(new Ze.Vector3,t)},Ze.SphereBufferGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.SphereBufferGeometry.prototype.constructor=Ze.SphereBufferGeometry,Ze.SphereBufferGeometry.prototype.clone=function(){var t=new Ze.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return t.copy(this),t},Ze.TextGeometry=function(t,e){e=e||{};var i=Ze.FontUtils.generateShapes(t,e);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ze.ExtrudeGeometry.call(this,i,e),this.type="TextGeometry"},Ze.TextGeometry.prototype=Object.create(Ze.ExtrudeGeometry.prototype),Ze.TextGeometry.prototype.constructor=Ze.TextGeometry,Ze.TorusGeometry=function(t,e,i,r,n){Ze.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},t=t||100,e=e||40,i=i||8,r=r||6,n=n||2*Math.PI;for(var o=new Ze.Vector3,a=[],s=[],h=0;h<=i;h++)for(var c=0;c<=r;c++){var l=c/r*n,u=h/i*Math.PI*2;o.x=t*Math.cos(l),o.y=t*Math.sin(l);var p=new Ze.Vector3;p.x=(t+e*Math.cos(u))*Math.cos(l),p.y=(t+e*Math.cos(u))*Math.sin(l),p.z=e*Math.sin(u),this.vertices.push(p),a.push(new Ze.Vector2(c/r,h/i)),s.push(p.clone().sub(o).normalize())}for(h=1;h<=i;h++)for(c=1;c<=r;c++){var d=(r+1)*h+c-1,f=(r+1)*(h-1)+c-1,m=(r+1)*(h-1)+c,g=(r+1)*h+c,y=new Ze.Face3(d,f,g,[s[d].clone(),s[f].clone(),s[g].clone()]);this.faces.push(y),this.faceVertexUvs[0].push([a[d].clone(),a[f].clone(),a[g].clone()]),y=new Ze.Face3(f,m,g,[s[f].clone(),s[m].clone(),s[g].clone()]),this.faces.push(y),this.faceVertexUvs[0].push([a[f].clone(),a[m].clone(),a[g].clone()])}this.computeFaceNormals()},Ze.TorusGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.TorusGeometry.prototype.constructor=Ze.TorusGeometry,Ze.TorusGeometry.prototype.clone=function(){return new Ze.TorusGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.arc)},Ze.TorusKnotGeometry=function(t,e,i,r,n,o,a){Ze.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,p:n,q:o,heightScale:a},t=t||100,e=e||40,i=i||64,r=r||8,n=n||2,o=o||3,a=a||1;for(var s=new Array(i),h=new Ze.Vector3,c=new Ze.Vector3,l=new Ze.Vector3,u=0;u<i;++u){s[u]=new Array(r);var p=u/i*2*n*Math.PI,d=P(p,o,n,t,a),f=P(p+.01,o,n,t,a);h.subVectors(f,d),c.addVectors(f,d),l.crossVectors(h,c),c.crossVectors(l,h),l.normalize(),c.normalize();for(var m=0;m<r;++m){var g=m/r*2*Math.PI,y=-e*Math.cos(g),v=e*Math.sin(g),x=new Ze.Vector3;x.x=d.x+y*c.x+v*l.x,x.y=d.y+y*c.y+v*l.y,x.z=d.z+y*c.z+v*l.z,s[u][m]=this.vertices.push(x)-1}}for(u=0;u<i;++u)for(m=0;m<r;++m){var b=(u+1)%i,w=(m+1)%r,M=s[u][m],_=s[b][m],S=s[b][w],T=s[u][w],C=new Ze.Vector2(u/i,m/r),E=new Ze.Vector2((u+1)/i,m/r),A=new Ze.Vector2((u+1)/i,(m+1)/r),L=new Ze.Vector2(u/i,(m+1)/r);this.faces.push(new Ze.Face3(M,_,T)),this.faceVertexUvs[0].push([C,E,L]),this.faces.push(new Ze.Face3(_,S,T)),this.faceVertexUvs[0].push([E.clone(),A,L.clone()])}function P(t,e,i,r,n){var o=Math.cos(t),a=Math.sin(t),s=e/i*t,h=Math.cos(s),c=r*(2+h)*.5*o,l=r*(2+h)*a*.5,u=n*r*Math.sin(s)*.5;return new Ze.Vector3(c,l,u)}this.computeFaceNormals(),this.computeVertexNormals()},Ze.TorusKnotGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.TorusKnotGeometry.prototype.constructor=Ze.TorusKnotGeometry,Ze.TorusKnotGeometry.prototype.clone=function(){return new Ze.TorusKnotGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.p,this.parameters.q,this.parameters.heightScale)},Ze.TubeGeometry=function(t,e,i,r,n,o){Ze.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:i,radialSegments:r,closed:n},e=e||64,i=i||1,r=r||8,n=n||!1,o=o||Ze.TubeGeometry.NoTaper;var a,s,h,c,l,u,p,d,f,m,g,y,v,x,b,w,M,_,S,T,C,E,A,L=[],P=this,k=e+1,R=new Ze.Vector3,D=new Ze.TubeGeometry.FrenetFrames(t,e,n),F=D.tangents,O=D.normals,B=D.binormals;for(this.tangents=F,this.normals=O,this.binormals=B,f=0;f<k;f++)for(L[f]=[],h=f/(k-1),d=t.getPointAt(h),F[f],a=O[f],s=B[f],l=i*o(h),m=0;m<r;m++)c=m/r*2*Math.PI,u=-l*Math.cos(c),p=l*Math.sin(c),R.copy(d),R.x+=u*a.x+p*s.x,R.y+=u*a.y+p*s.y,R.z+=u*a.z+p*s.z,L[f][m]=(C=R.x,E=R.y,A=R.z,P.vertices.push(new Ze.Vector3(C,E,A))-1);for(f=0;f<e;f++)for(m=0;m<r;m++)g=n?(f+1)%e:f+1,y=(m+1)%r,v=L[f][m],x=L[g][m],b=L[g][y],w=L[f][y],M=new Ze.Vector2(f/e,m/r),_=new Ze.Vector2((f+1)/e,m/r),S=new Ze.Vector2((f+1)/e,(m+1)/r),T=new Ze.Vector2(f/e,(m+1)/r),this.faces.push(new Ze.Face3(v,x,w)),this.faceVertexUvs[0].push([M,_,T]),this.faces.push(new Ze.Face3(x,b,w)),this.faceVertexUvs[0].push([_.clone(),S,T.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},Ze.TubeGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.TubeGeometry.prototype.constructor=Ze.TubeGeometry,Ze.TubeGeometry.NoTaper=function(t){return 1},Ze.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},Ze.TubeGeometry.FrenetFrames=function(t,e,i){var r,n,o,a,s,h,c,l=new Ze.Vector3,u=[],p=[],d=[],f=new Ze.Vector3,m=new Ze.Matrix4,g=e+1;for(this.tangents=u,this.normals=p,this.binormals=d,h=0;h<g;h++)c=h/(g-1),u[h]=t.getTangentAt(c),u[h].normalize();for(function(){p[0]=new Ze.Vector3,d[0]=new Ze.Vector3,n=Number.MAX_VALUE,o=Math.abs(u[0].x),a=Math.abs(u[0].y),s=Math.abs(u[0].z),o<=n&&(n=o,l.set(1,0,0));a<=n&&(n=a,l.set(0,1,0));s<=n&&l.set(0,0,1);f.crossVectors(u[0],l).normalize(),p[0].crossVectors(u[0],f),d[0].crossVectors(u[0],p[0])}(),h=1;h<g;h++)p[h]=p[h-1].clone(),d[h]=d[h-1].clone(),f.crossVectors(u[h-1],u[h]),1e-4<f.length()&&(f.normalize(),r=Math.acos(Ze.Math.clamp(u[h-1].dot(u[h]),-1,1)),p[h].applyMatrix4(m.makeRotationAxis(f,r))),d[h].crossVectors(u[h],p[h]);if(i)for(r=Math.acos(Ze.Math.clamp(p[0].dot(p[g-1]),-1,1)),r/=g-1,0<u[0].dot(f.crossVectors(p[0],p[g-1]))&&(r=-r),h=1;h<g;h++)p[h].applyMatrix4(m.makeRotationAxis(u[h],r*h)),d[h].crossVectors(u[h],p[h])},Ze.PolyhedronGeometry=function(t,e,i,r){Ze.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},i=i||1,r=r||0;for(var f=this,n=0,o=t.length;n<o;n+=3)b(new Ze.Vector3(t[n],t[n+1],t[n+2]));var a=this.vertices,s=[],h=(n=0,0);for(o=e.length;n<o;n+=3,h++){var c=a[e[n]],l=a[e[n+1]],u=a[e[n+2]];s[h]=new Ze.Face3(c.index,l.index,u.index,[c.clone(),l.clone(),u.clone()],void 0,h)}var p=new Ze.Vector3;for(n=0,o=s.length;n<o;n++)M(s[n],r);for(n=0,o=this.faceVertexUvs[0].length;n<o;n++){var d=this.faceVertexUvs[0][n],m=d[0].x,g=d[1].x,y=d[2].x,v=Math.max(m,Math.max(g,y)),x=Math.min(m,Math.min(g,y));.9<v&&x<.1&&(m<.2&&(d[0].x+=1),g<.2&&(d[1].x+=1),y<.2&&(d[2].x+=1))}for(n=0,o=this.vertices.length;n<o;n++)this.vertices[n].multiplyScalar(i);function b(t){var e=t.normalize().clone();e.index=f.vertices.push(e)-1;var i,r=_(t)/2/Math.PI+.5,n=(i=t,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);return e.uv=new Ze.Vector2(r,1-n),e}function w(t,e,i,r){var n=new Ze.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()],void 0,r);f.faces.push(n),p.copy(t).add(e).add(i).divideScalar(3);var o=_(p);f.faceVertexUvs[0].push([S(t.uv,t,o),S(e.uv,e,o),S(i.uv,i,o)])}function M(t,e){for(var i=Math.pow(2,e),r=b(f.vertices[t.a]),n=b(f.vertices[t.b]),o=b(f.vertices[t.c]),a=[],s=t.materialIndex,h=0;h<=i;h++){a[h]=[];for(var c=b(r.clone().lerp(o,h/i)),l=b(n.clone().lerp(o,h/i)),u=i-h,p=0;p<=u;p++)a[h][p]=0===p&&h===i?c:b(c.clone().lerp(l,p/u))}for(h=0;h<i;h++)for(p=0;p<2*(i-h)-1;p++){var d=Math.floor(p/2);p%2==0?w(a[h][d+1],a[h+1][d],a[h][d],s):w(a[h][d+1],a[h+1][d+1],a[h+1][d],s)}}function _(t){return Math.atan2(t.z,-t.x)}function S(t,e,i){return i<0&&1===t.x&&(t=new Ze.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new Ze.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new Ze.Sphere(new Ze.Vector3,i)},Ze.PolyhedronGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.PolyhedronGeometry.prototype.constructor=Ze.PolyhedronGeometry,Ze.PolyhedronGeometry.prototype.clone=function(){return new Ze.PolyhedronGeometry(this.parameters.vertices,this.parameters.indices,this.parameters.radius,this.parameters.detail).copy(this)},Ze.PolyhedronGeometry.prototype.copy=function(t){return Ze.Geometry.prototype.copy.call(this,t),this},Ze.DodecahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r];Ze.PolyhedronGeometry.call(this,n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}},Ze.DodecahedronGeometry.prototype=Object.create(Ze.PolyhedronGeometry.prototype),Ze.DodecahedronGeometry.prototype.constructor=Ze.DodecahedronGeometry,Ze.DodecahedronGeometry.prototype.clone=function(){var t=new Ze.DodecahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},Ze.IcosahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];Ze.PolyhedronGeometry.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},Ze.IcosahedronGeometry.prototype=Object.create(Ze.PolyhedronGeometry.prototype),Ze.IcosahedronGeometry.prototype.constructor=Ze.IcosahedronGeometry,Ze.IcosahedronGeometry.prototype.clone=function(){var t=new Ze.IcosahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},Ze.OctahedronGeometry=function(t,e){Ze.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},Ze.OctahedronGeometry.prototype=Object.create(Ze.PolyhedronGeometry.prototype),Ze.OctahedronGeometry.prototype.constructor=Ze.OctahedronGeometry,Ze.OctahedronGeometry.prototype.clone=function(){var t=new Ze.OctahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},Ze.TetrahedronGeometry=function(t,e){Ze.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},Ze.TetrahedronGeometry.prototype=Object.create(Ze.PolyhedronGeometry.prototype),Ze.TetrahedronGeometry.prototype.constructor=Ze.TetrahedronGeometry,Ze.TetrahedronGeometry.prototype.clone=function(){var t=new Ze.TetrahedronGeometry(this.parameters.radius,this.parameters.detail);return t.copy(this),t},Ze.ParametricGeometry=function(t,e,i){Ze.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};var r,n,o,a,s,h,c,l,u,p,d,f,m=this.vertices,g=this.faces,y=this.faceVertexUvs[0],v=e+1;for(r=0;r<=i;r++)for(a=r/i,n=0;n<=e;n++)o=t(n/e,a),m.push(o);for(r=0;r<i;r++)for(n=0;n<e;n++)h=(s=r*v+n)+1,c=(r+1)*v+n+1,l=(r+1)*v+n,u=new Ze.Vector2(n/e,r/i),p=new Ze.Vector2((n+1)/e,r/i),d=new Ze.Vector2((n+1)/e,(r+1)/i),f=new Ze.Vector2(n/e,(r+1)/i),g.push(new Ze.Face3(s,h,l)),y.push([u,p,f]),g.push(new Ze.Face3(h,c,l)),y.push([p.clone(),d,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},Ze.ParametricGeometry.prototype=Object.create(Ze.Geometry.prototype),Ze.ParametricGeometry.prototype.constructor=Ze.ParametricGeometry,Ze.WireframeGeometry=function(t){Ze.BufferGeometry.call(this);var e=[0,0],i={},r=function(t,e){return t-e},n=["a","b","c"];if(t instanceof Ze.Geometry){for(var o=t.vertices,a=t.faces,s=0,h=new Uint32Array(6*a.length),c=0,l=a.length;c<l;c++)for(var u=a[c],p=0;p<3;p++){e[0]=u[n[p]],e[1]=u[n[(p+1)%3]],e.sort(r),void 0===i[M=e.toString()]&&(h[2*s]=e[0],h[2*s+1]=e[1],i[M]=!0,s++)}var d=new Float32Array(2*s*3);for(c=0,l=s;c<l;c++)for(p=0;p<2;p++){var f=o[h[2*c+p]];d[(_=6*c+3*p)+0]=f.x,d[_+1]=f.y,d[_+2]=f.z}this.addAttribute("position",new Ze.BufferAttribute(d,3))}else if(t instanceof Ze.BufferGeometry)if(null!==t.index){var m=t.index.array,g=(o=t.attributes.position,t.drawcalls);s=0;0===g.length&&t.addDrawCall(0,m.length);h=new Uint32Array(2*m.length);for(var y=0,v=g.length;y<v;++y)for(var x=g[y],b=x.start,w=(c=b,b+x.count);c<w;c+=3)for(p=0;p<3;p++){var M;e[0]=m[c+p],e[1]=m[c+(p+1)%3],e.sort(r),void 0===i[M=e.toString()]&&(h[2*s]=e[0],h[2*s+1]=e[1],i[M]=!0,s++)}for(d=new Float32Array(2*s*3),c=0,l=s;c<l;c++)for(p=0;p<2;p++){var _=6*c+3*p,S=h[2*c+p];d[_+0]=o.getX(S),d[_+1]=o.getY(S),d[_+2]=o.getZ(S)}this.addAttribute("position",new Ze.BufferAttribute(d,3))}else{var T=(s=(o=t.attributes.position.array).length/3)/3;for(d=new Float32Array(2*s*3),c=0,l=T;c<l;c++)for(p=0;p<3;p++){var C=9*c+3*p;d[(_=18*c+6*p)+0]=o[C],d[_+1]=o[C+1],d[_+2]=o[C+2];S=9*c+(p+1)%3*3;d[_+3]=o[S],d[_+4]=o[S+1],d[_+5]=o[S+2]}this.addAttribute("position",new Ze.BufferAttribute(d,3))}},Ze.WireframeGeometry.prototype=Object.create(Ze.BufferGeometry.prototype),Ze.WireframeGeometry.prototype.constructor=Ze.WireframeGeometry,Ze.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),r=new Ze.BufferGeometry;r.addAttribute("position",new Ze.BufferAttribute(e,3)),r.addAttribute("color",new Ze.BufferAttribute(i,3));var n=new Ze.LineBasicMaterial({vertexColors:Ze.VertexColors});Ze.LineSegments.call(this,r,n)},Ze.AxisHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.AxisHelper.prototype.constructor=Ze.AxisHelper,Ze.ArrowHelper=function(){var a=new Ze.Geometry;a.vertices.push(new Ze.Vector3(0,0,0),new Ze.Vector3(0,1,0));var s=new Ze.CylinderGeometry(0,.5,1,5,1);return s.translate(0,-.5,0),function(t,e,i,r,n,o){Ze.Object3D.call(this),void 0===r&&(r=16776960),void 0===i&&(i=1),void 0===n&&(n=.2*i),void 0===o&&(o=.2*n),this.position.copy(e),n<i&&(this.line=new Ze.Line(a,new Ze.LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line)),this.cone=new Ze.Mesh(s,new Ze.MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,n,o)}}(),Ze.ArrowHelper.prototype=Object.create(Ze.Object3D.prototype),Ze.ArrowHelper.prototype.constructor=Ze.ArrowHelper,Ze.ArrowHelper.prototype.setDirection=(ke=new Ze.Vector3,function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(ke.set(t.z,0,-t.x).normalize(),Pe=Math.acos(t.y),this.quaternion.setFromAxisAngle(ke,Pe))}),Ze.ArrowHelper.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),e<t&&(this.line.scale.set(1,t-e,1),this.line.updateMatrix()),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},Ze.ArrowHelper.prototype.setColor=function(t){void 0!==this.line&&this.line.material.color.set(t),this.cone.material.color.set(t)},Ze.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Ze.BufferGeometry;r.setIndex(new Ze.BufferAttribute(e,1)),r.addAttribute("position",new Ze.BufferAttribute(i,3)),Ze.LineSegments.call(this,r,new Ze.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},Ze.BoxHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.BoxHelper.prototype.constructor=Ze.BoxHelper,Ze.BoxHelper.prototype.update=(Re=new Ze.Box3,function(t){if(Re.setFromObject(t),!Re.empty()){var e=Re.min,i=Re.max,r=this.geometry.attributes.position,n=r.array;n[0]=i.x,n[1]=i.y,n[2]=i.z,n[3]=e.x,n[4]=i.y,n[5]=i.z,n[6]=e.x,n[7]=e.y,n[8]=i.z,n[9]=i.x,n[10]=e.y,n[11]=i.z,n[12]=i.x,n[13]=i.y,n[14]=e.z,n[15]=e.x,n[16]=i.y,n[17]=e.z,n[18]=e.x,n[19]=e.y,n[20]=e.z,n[21]=i.x,n[22]=e.y,n[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),Ze.BoundingBoxHelper=function(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new Ze.Box3,Ze.Mesh.call(this,new Ze.BoxGeometry(1,1,1),new Ze.MeshBasicMaterial({color:i,wireframe:!0}))},Ze.BoundingBoxHelper.prototype=Object.create(Ze.Mesh.prototype),Ze.BoundingBoxHelper.prototype.constructor=Ze.BoundingBoxHelper,Ze.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},Ze.CameraHelper=function(t){var i=new Ze.Geometry,e=new Ze.LineBasicMaterial({color:16777215,vertexColors:Ze.FaceColors}),r={},n=16755200,o=16711680,a=3355443;function s(t,e,i){h(t,i),h(e,i)}function h(t,e){i.vertices.push(new Ze.Vector3),i.colors.push(new Ze.Color(e)),void 0===r[t]&&(r[t]=[]),r[t].push(i.vertices.length-1)}s("n1","n2",n),s("n2","n4",n),s("n4","n3",n),s("n3","n1",n),s("f1","f2",n),s("f2","f4",n),s("f4","f3",n),s("f3","f1",n),s("n1","f1",n),s("n2","f2",n),s("n3","f3",n),s("n4","f4",n),s("p","n1",o),s("p","n2",o),s("p","n3",o),s("p","n4",o),s("u1","u2",43775),s("u2","u3",43775),s("u3","u1",43775),s("c","t",16777215),s("p","c",a),s("cn1","cn2",a),s("cn3","cn4",a),s("cf1","cf2",a),s("cf3","cf4",a),Ze.LineSegments.call(this,i,e),this.camera=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update()},Ze.CameraHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.CameraHelper.prototype.constructor=Ze.CameraHelper,Ze.CameraHelper.prototype.update=(Oe=new Ze.Vector3,Be=new Ze.Camera,Ue=function(t,e,i,r){Oe.set(e,i,r).unproject(Be);var n=Fe[t];if(void 0!==n)for(var o=0,a=n.length;o<a;o++)De.vertices[n[o]].copy(Oe)},function(){De=this.geometry,Fe=this.pointMap,Be.projectionMatrix.copy(this.camera.projectionMatrix),Ue("c",0,0,-1),Ue("t",0,0,1),Ue("n1",-1,-1,-1),Ue("n2",1,-1,-1),Ue("n3",-1,1,-1),Ue("n4",1,1,-1),Ue("f1",-1,-1,1),Ue("f2",1,-1,1),Ue("f3",-1,1,1),Ue("f4",1,1,1),Ue("u1",.7,1.1,-1),Ue("u2",-.7,1.1,-1),Ue("u3",0,2,-1),Ue("cf1",-1,0,1),Ue("cf2",1,0,1),Ue("cf3",0,-1,1),Ue("cf4",0,1,1),Ue("cn1",-1,0,-1),Ue("cn2",1,0,-1),Ue("cn3",0,-1,-1),Ue("cn4",0,1,-1),De.verticesNeedUpdate=!0}),Ze.DirectionalLightHelper=function(t,e){Ze.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var i=new Ze.Geometry;i.vertices.push(new Ze.Vector3(-e,e,0),new Ze.Vector3(e,e,0),new Ze.Vector3(e,-e,0),new Ze.Vector3(-e,-e,0),new Ze.Vector3(-e,e,0));var r=new Ze.LineBasicMaterial({fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new Ze.Line(i,r),this.add(this.lightPlane),(i=new Ze.Geometry).vertices.push(new Ze.Vector3,new Ze.Vector3),(r=new Ze.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new Ze.Line(i,r),this.add(this.targetLine),this.update()},Ze.DirectionalLightHelper.prototype=Object.create(Ze.Object3D.prototype),Ze.DirectionalLightHelper.prototype.constructor=Ze.DirectionalLightHelper,Ze.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ze.DirectionalLightHelper.prototype.update=(Ve=new Ze.Vector3,Ne=new Ze.Vector3,ze=new Ze.Vector3,function(){Ve.setFromMatrixPosition(this.light.matrixWorld),Ne.setFromMatrixPosition(this.light.target.matrixWorld),ze.subVectors(Ne,Ve),this.lightPlane.lookAt(ze),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(ze),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}),Ze.EdgesHelper=function(t,e,i){var r=void 0!==e?e:16777215;Ze.LineSegments.call(this,new Ze.EdgesGeometry(t.geometry,i),new Ze.LineBasicMaterial({color:r})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},Ze.EdgesHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.EdgesHelper.prototype.constructor=Ze.EdgesHelper,Ze.FaceNormalsHelper=function(t,e,i,r){this.object=t,this.size=void 0!==e?e:1;var n=void 0!==i?i:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s instanceof Ze.Geometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var h=new Ze.BufferGeometry,c=new Ze.Float32Attribute(2*a*3,3);h.addAttribute("position",c),Ze.LineSegments.call(this,h,new Ze.LineBasicMaterial({color:n,linewidth:o})),this.matrixAutoUpdate=!1,this.update()},Ze.FaceNormalsHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.FaceNormalsHelper.prototype.constructor=Ze.FaceNormalsHelper,Ze.FaceNormalsHelper.prototype.update=(Ie=new Ze.Vector3,Ge=new Ze.Vector3,je=new Ze.Matrix3,function(){this.object.updateMatrixWorld(!0),je.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry,r=i.vertices,n=i.faces,o=0,a=0,s=n.length;a<s;a++){var h=n[a],c=h.normal;Ie.copy(r[h.a]).add(r[h.b]).add(r[h.c]).divideScalar(3).applyMatrix4(t),Ge.copy(c).applyMatrix3(je).normalize().multiplyScalar(this.size).add(Ie),e.setXYZ(o,Ie.x,Ie.y,Ie.z),o+=1,e.setXYZ(o,Ge.x,Ge.y,Ge.z),o+=1}return e.needsUpdate=!0,this}),Ze.GridHelper=function(t,e){var i=new Ze.Geometry,r=new Ze.LineBasicMaterial({vertexColors:Ze.VertexColors});this.color1=new Ze.Color(4473924),this.color2=new Ze.Color(8947848);for(var n=-t;n<=t;n+=e){i.vertices.push(new Ze.Vector3(-t,0,n),new Ze.Vector3(t,0,n),new Ze.Vector3(n,0,-t),new Ze.Vector3(n,0,t));var o=0===n?this.color1:this.color2;i.colors.push(o,o,o,o)}Ze.LineSegments.call(this,i,r)},Ze.GridHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.GridHelper.prototype.constructor=Ze.GridHelper,Ze.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},Ze.HemisphereLightHelper=function(t,e){Ze.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new Ze.Color,new Ze.Color];var i=new Ze.SphereGeometry(e,4,2);i.rotateX(-Math.PI/2);for(var r=0;r<8;r++)i.faces[r].color=this.colors[r<4?0:1];var n=new Ze.MeshBasicMaterial({vertexColors:Ze.FaceColors,wireframe:!0});this.lightSphere=new Ze.Mesh(i,n),this.add(this.lightSphere),this.update()},Ze.HemisphereLightHelper.prototype=Object.create(Ze.Object3D.prototype),Ze.HemisphereLightHelper.prototype.constructor=Ze.HemisphereLightHelper,Ze.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},Ze.HemisphereLightHelper.prototype.update=(He=new Ze.Vector3,function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(He.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}),Ze.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var i=new Ze.SphereGeometry(e,4,2),r=new Ze.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),Ze.Mesh.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1};Ze.PointLightHelper.prototype=Object.create(Ze.Mesh.prototype),Ze.PointLightHelper.prototype.constructor=Ze.PointLightHelper,Ze.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ze.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Ze.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new Ze.Geometry,i=0;i<this.bones.length;i++){this.bones[i].parent instanceof Ze.Bone&&(e.vertices.push(new Ze.Vector3),e.vertices.push(new Ze.Vector3),e.colors.push(new Ze.Color(0,0,1)),e.colors.push(new Ze.Color(0,1,0)))}e.dynamic=!0;var r=new Ze.LineBasicMaterial({vertexColors:Ze.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});Ze.LineSegments.call(this,e,r),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},Ze.SkeletonHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.SkeletonHelper.prototype.constructor=Ze.SkeletonHelper,Ze.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof Ze.Bone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},Ze.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new Ze.Matrix4).getInverse(this.root.matrixWorld),i=new Ze.Matrix4,r=0,n=0;n<this.bones.length;n++){var o=this.bones[n];o.parent instanceof Ze.Bone&&(i.multiplyMatrices(e,o.matrixWorld),t.vertices[r].setFromMatrixPosition(i),i.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[r+1].setFromMatrixPosition(i),r+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},Ze.SpotLightHelper=function(t){Ze.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var e=new Ze.CylinderGeometry(0,1,1,8,1,!0);e.translate(0,-.5,0),e.rotateX(-Math.PI/2);var i=new Ze.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new Ze.Mesh(e,i),this.add(this.cone),this.update()},Ze.SpotLightHelper.prototype=Object.create(Ze.Object3D.prototype),Ze.SpotLightHelper.prototype.constructor=Ze.SpotLightHelper,Ze.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ze.SpotLightHelper.prototype.update=(We=new Ze.Vector3,Xe=new Ze.Vector3,function(){var t=this.light.distance?this.light.distance:1e4,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),We.setFromMatrixPosition(this.light.matrixWorld),Xe.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Xe.sub(We)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}),Ze.VertexNormalsHelper=function(t,e,i,r){this.object=t,this.size=void 0!==e?e:1;var n=void 0!==i?i:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s instanceof Ze.Geometry?a=3*s.faces.length:s instanceof Ze.BufferGeometry&&(a=s.attributes.normal.count);var h=new Ze.BufferGeometry,c=new Ze.Float32Attribute(2*a*3,3);h.addAttribute("position",c),Ze.LineSegments.call(this,h,new Ze.LineBasicMaterial({color:n,linewidth:o})),this.matrixAutoUpdate=!1,this.update()},Ze.VertexNormalsHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.VertexNormalsHelper.prototype.constructor=Ze.VertexNormalsHelper,Ze.VertexNormalsHelper.prototype.update=(qe=new Ze.Vector3,Ye=new Ze.Vector3,Ke=new Ze.Matrix3,function(){var t=["a","b","c"];this.object.updateMatrixWorld(!0),Ke.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,i=this.geometry.attributes.position,r=this.object.geometry;if(r instanceof Ze.Geometry)for(var n=r.vertices,o=r.faces,a=0,s=0,h=o.length;s<h;s++)for(var c=o[s],l=0,u=c.vertexNormals.length;l<u;l++){var p=n[c[t[l]]],d=c.vertexNormals[l];qe.copy(p).applyMatrix4(e),Ye.copy(d).applyMatrix3(Ke).normalize().multiplyScalar(this.size).add(qe),i.setXYZ(a,qe.x,qe.y,qe.z),a+=1,i.setXYZ(a,Ye.x,Ye.y,Ye.z),a+=1}else if(r instanceof Ze.BufferGeometry){var f=r.attributes.position,m=r.attributes.normal;for(l=a=0,u=f.count;l<u;l++)qe.set(f.getX(l),f.getY(l),f.getZ(l)).applyMatrix4(e),Ye.set(m.getX(l),m.getY(l),m.getZ(l)),Ye.applyMatrix3(Ke).normalize().multiplyScalar(this.size).add(qe),i.setXYZ(a,qe.x,qe.y,qe.z),a+=1,i.setXYZ(a,Ye.x,Ye.y,Ye.z),a+=1}return i.needsUpdate=!0,this}),Ze.WireframeHelper=function(t,e){var i=void 0!==e?e:16777215;Ze.LineSegments.call(this,new Ze.WireframeGeometry(t.geometry),new Ze.LineBasicMaterial({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},Ze.WireframeHelper.prototype=Object.create(Ze.LineSegments.prototype),Ze.WireframeHelper.prototype.constructor=Ze.WireframeHelper,Ze.ImmediateRenderObject=function(){Ze.Object3D.call(this),this.render=function(t){}},Ze.ImmediateRenderObject.prototype=Object.create(Ze.Object3D.prototype),Ze.ImmediateRenderObject.prototype.constructor=Ze.ImmediateRenderObject,Ze.MorphBlendMesh=function(t,e){Ze.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,r=i-1,n=i/1;this.createAnimation("__default",0,r,n),this.setAnimationWeight("__default",1)},Ze.MorphBlendMesh.prototype=Object.create(Ze.Mesh.prototype),Ze.MorphBlendMesh.prototype.constructor=Ze.MorphBlendMesh,Ze.MorphBlendMesh.prototype.createAnimation=function(t,e,i,r){var n={start:e,end:i,length:i-e+1,fps:r,duration:(i-e)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=n,this.animationsList.push(n)},Ze.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\\d+)/,r={},n=this.geometry,o=0,a=n.morphTargets.length;o<a;o++){var s=n.morphTargets[o].name.match(i);if(s&&1<s.length)r[h=s[1]]||(r[h]={start:1/0,end:-1/0}),o<(c=r[h]).start&&(c.start=o),o>c.end&&(c.end=o),e||(e=h)}for(var h in r){var c=r[h];this.createAnimation(h,c.start,c.end,t)}this.firstAnimation=e},Ze.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},Ze.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},Ze.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},Ze.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},Ze.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},Ze.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},Ze.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},Ze.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},Ze.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Ze.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},Ze.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;e<i;e++){var r=this.animationsList[e];if(r.active){var n=r.duration/r.length;r.time+=r.direction*t,r.mirroredLoop?(r.time>r.duration||r.time<0)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),r.time<0&&(r.time=0,r.directionBackwards=!1)):(r.time=r.time%r.duration,r.time<0&&(r.time+=r.duration));var o=r.start+Ze.Math.clamp(Math.floor(r.time/n),0,r.length-1),a=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o);var s=r.time%n/n;r.directionBackwards&&(s=1-s),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=s*a,this.morphTargetInfluences[r.lastFrame]=(1-s)*a):this.morphTargetInfluences[r.currentFrame]=a}}},void 0!==i?(void 0!==e&&e.exports&&(i=e.exports=Ze),i.THREE=Ze):this.THREE=Ze},{}]},{},[11]);' ]
